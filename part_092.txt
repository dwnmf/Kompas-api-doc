et3dError145 145 Операция потеряла опорные объекты
et3dError146 146 Не все сгибы согнуты/разогнуты
et3dError147 147 Масштабирование с заданным 

коэффициентом невозможно
et3dError148 148 Масштабирование с заданным соотношением 

коэффициентов невозможно
et3dError149 149 Массив объектов для копирования пуст
et3dError175 175 Слишком сложный набор элементов для 

обработки
et3dError176 176 Оси не пересекаются
et3dError177 177 Объекты слишком далеко
et3dError179 179 Контур невозможно использовать для 

заданного перемещения
et3dError180 180 Один из контуров невозможно использовать 

для заданного построения
et3dError181 181 Линии разъема созданы не на всех 

выбранных гранях
et3dError182 182 В некоторых точках образующая параллельна 

направляющей
et3dError183 183 Недостаточно памяти
et3dError184 184 Направление боковой границы параллельно 

касательной на конце образующей кривой
et3dError185 185 Объект не найден
et3dError186 186 В сплайновой поверхности часть точек из 

полюса передвинута, часть осталась 
совпадающей

et3dError187 187 Аппроксимация не выполнена
et3dError188 188 Не выполнены условия по точности 

построения
et3dError189 189 Ошибочное значение переменной
et3dError190 190 Невозможно построить фаску на указанных 

ребрах
et3dError191 191 Остановка скругления невозможна, 

скругление выполнено без остановки
et3dError192 192 Не согласованы сопряжения на смежных 

границах
et3dError193 193 Доступ к объекту запрещен
et3dError194 194 Количество сегментов слишком велико
et3dError195 195 Недопустимое положение зазора обечайки
et3dError196 196 Силуэтная грани линия не разрезает грань
et3dError197 197 Вырожденная проекция опорного объекта

const long  MAXERROR3d = 192;
4952



Intersection_Type  Типы пересечений

itTangentPoint 1 Пересечение точкой
itTangentCurve 2 Пересечение вдоль касательной линии
itTangentSurface 3 Пересечение касательной областью поверхности
itBody 4 Пересечение образует тело

ksMateType  Типы математических объектов, 
участвующих в сопряжении

ksMateUnknown 0 Неизвестный объект
ksMatePoint 1 Точка
ksMateLine 2 Линия
ksMatePlane 3 Плоскость
ksMateCylinder 4 Цилиндр
ksMateCone 5 Конус
ksMateSphere 6 Сфера
ksMateTorus 7 Тор

Представление математических объектов, участвующих в сопряжении...

ksPatternOrientationTypeEnum  Способ ориентации 
экземпляров массива

ksOrientationSave 0 Сохранять исходную ориентацию
ksOrientationByNormal 1 Доворачивать до нормали
ksOrientationByObject 2 Ориентировать по объекту

 

ksProductObjectTypeEnum  Тип объектов дерева СЧИ

ksPOTAllObjects "1 Не задан. Выдавать все объекты
ksPOTDocumentObject 1 Документ
ksPOTEmbodimentsOb 2 Исполнение
ject
ksPOTPartObject 4 Компонент.
ksPOTBodyObject 8 Тело
ksPOTProductObject 16 Изделие
ksPOTInformObject 32 Информационный объект
ksPOTSurfaceObject 64 Поверхность
4953



ksSaveDocumentVersionEnum  Версия сохранения файла
   
ksSDV_Prev "1 В предыдущую версию
ksSDV_Current 0 В текущую версию
ksSDV_Kompas_5_11_R03 1 В версию Компас 5.11.R03
ksSDV_Kompas_6_0 2 В версию Компас 6.0.
ksSDV_Kompas_6_Plus 3 В версию Компас 6 Plus
ksSDV_Kompas_7_0 4 В версию Компас 7.0.
ksSDV_Kompas_7_Plus 5 В версию Компас 7 Plus
ksSDV_Kompas_8_0 6 В версию Компас 8.0
ksSDV_Kompas_8_Plus 7 В версию Компас 8 Plus
ksSDV_Kompas_9_0 8 В версию Компас 9.0
ksSDV_Kompas_10_0 9 В версию Компас 10.0
ksSDV_Kompas_11_0  10 В версию Компас 11.0
ksSDV_Kompas_12_0 11 В версию Компас 12.0
ksSDV_Kompas_13_0 12 В версию Компас 13.0
ksSDV_Kompas_14_0 13 В версию Компас 14.0
ksSDV_Kompas_14_Sp1  14 В версию Компас 14 Sp1
ksSDV_Kompas_14_Sp2 15 В версию Компас 14 Sp2
ksSDV_Kompas_15_0 16 В версию Компас 15.0
ksSDV_Kompas_15_Sp1 17 В версию Компас 15 Sp1
ksSDV_Kompas_15_Sp2 18 В версию Компас 15 Sp2
ksSDV_Kompas_16 19 В версию Компас 16
ksSDV_Kompas_16_Sp1 20 В версию Компас 16 Sp1
ksSDV_Kompas_17 21 В версию Компас 17
ksSDV_Kompas_17_Sp1 22 В версию Компас 17_Sp1
ksSDV_Kompas_18 23 В версию Компас 18
ksSDV_Kompas_18_Sp1 24 В версию Компас 18_Sp1
ksSDV_Kompas_19 25 В версию Компас 19

UseColor  Типы используемого цвета

useColorUnknown "1 тип не определен
useColorOur 0 собственный цвет
useColorOwner 1 цвет хозяина
useColorSource 2 цвет источника
useColorLayer 3 Цвет слоя

ksTreeTypeEnum  Типы Дерева построения 3D 
документа

ksOperTree 0 Операционное дерево
ksMultiTree 1 Многотельное дерево
4954



ksVariantMarkingTypeEnum  Параметры формирования 
обозначения

ksVMFullMarking "1 Полное обозначение
ksVMBaseMarking 0x1 Базовая часть обозначения
ksVMEmbodimentNumber 0x2 Исполнение
ksVMAdditionalNumber 0x4 Дополнительный номер
ksVMCode 0x8 Код документа

ksPrinterTypeEnum  Параметры формирования 
обозначения

ksPTPrintPreviewPrinter 0 Принтер для печати через предварительный просмотр
ksPTSpecialPrinter 1 Принтер для специальной печати

ProjectionType  Типы проекций

vp_None "1 Не определена
vp_NormalTo 0 Нормально к текущему планару
vp_Front 1 Спереди " Фронтальная плоскость
vp_Rear 2 Сзади
vp_Up 3 Сверху " Горизонтальная плоскость
vp_Down 4 Снизу
vp_Left 5 Слева " Профильная плоскость
vp_Right 6 Справа
vp_IsoXYZ 7 Изометрия XYZ
vp_IsoYZX 8 Изометрия YZX
vp_IsoZXY 9 Изометрия ZXY
vp_Dio 10 Диметрия

EndType  Типы действий с библиотекой моделей или 
фрагментов

"1 " закрыть без сохранения
0 " закрыть с сохранением
1 " открыть
2 " редактировать модель или фрагмент
3 " удалить модель или фрагмент из библиотеки
4 " минимизировать окно библиотекаря

 (в КОМПАС V6 не поддерживается)
5 " создать файл библиотеки фрагментов
6 " создать файл библиотеки моделей
7 " создать фрагмент в библиотеке фрагментов
8 " создать деталь в библиотеке фрагментов
9 " создать сборку в библиотеке фрагментов
4955



2D
LtQualSystem  Система квалитета

lt_qsShaft 1 вала
lt_qsHole 2 отверстия

LtQualDir  Квалитеты

lt_qdPreferable 1 предпочтительные
lt_qdBasic 2 основные
lt_qdAdditional 3 дополнительные

LtRemoteElmSignType  Типы значка объекта "Выносной 
элемент"

re_Circle 0 окружность
re_Rectangle 1 прямоугольник
re_Ballon 2 скругленный прямоугольник

Типы операций копирования

Тип Значе Интерфейс Операция 
ние

o3d_meshCopy 35 ILinearPattern Операция копирования по 
сетке

o3d_circularCopy 36 ICircularPattern Операция копирования по 
концентрической сетке 

o3d_curveCopy 37 IPathPattern Операция копирования по 
кривой 

o3d_circPartArray 38 ICircularPattern Операция массив по 
концентрической сетке для 
сборки 

o3d_meshPartArray 39 ILinearPattern Операция массив по сетке для 
сборки 

o3d_curvePartArray 40 IPathPattern Операция массив по кривой 
для сборки 

o3d_derivPartArray 41 IDerivedPattern Операция массив по образцу 
для сборки 

o3d_mirrorOperation 48 IMirrorPattern Операция «зеркальный 
массив»
4956



o3d_mirrorAllOperation 49 IMirrorPattern Операция «зеркально отразить 
все» 
Дополнительно имеет 
интерфейс выбора тел 
IChooseBodies7

o3d_AuxMeshCopy 504 ILinearPattern Массив вспомогательной 
геометрии по сетке 

o3d_AuxCircularCopy 505 ICircularPattern Массив вспомогательной 
геометрии по 
концентрической сетке 

o3d_AuxCurveCopy 506 IPathPattern Массив вспомогательной 
геометрии вдоль кривой

o3d_PointDrivenPattern 507 IPointDrivenPattern Массив операций по точкам
o3d_PartsPointDrivenPattern 508 IPointDrivenPattern Массив компонентов по 

точкам
o3d_AuxMirrorOperation 509 IMirrorPattern Зеркальный массив 

вспомогательной геометрии
o3d_AuxPointDrivenPattern 520 IPointDrivenPattern Массив вспомогательной 

геометрии по точкам
o3d_BodiesPointDrivenPatter 521 IPointDrivenPattern Массив тел по точкам
n
o3d_TablePattern 522 ITablePattern Массив операций по таблице 

из файла
o3d_PartsTablePattern 523 ITablePattern Массив компонентов по 

таблице из файла
o3d_AuxTablePattern 524 ITablePattern Массив вспомогательной 

геометрии по таблице из 
файла

o3d_BodiesTablePattern 525 ITablePattern Массив тел по таблице из 
файла

o3d_BodiesMeshCopy 528 ILinearPattern Массив тел по сетке
o3d_BodiesCircularCopy 529 ICircularPattern Массив тел по 

концентрической сетке
o3d_BodiesCurveCopy 530 IPathPattern Массив тел по кривой

ChangeOrderType  Типы изменения порядка объектов

co_Top 1 Выше всех
co_Bottom 2 Ниже всех
co_BeforeObject 3 Перед объектом
co_AfterObject 4 За объектом
co_UpLevel 5 На уровень вперед
co_DownLevel 6 На уровень назад

DocType  Типы документов системы КОМПАС

lt_DocUnknown 0 " нет активного документа
lt_DocSheetStandart 1 " чертеж стандартного формата
lt_DocSheetUser 2 " чертеж нестандартного формата
4957



ат
lt_DocFragment 3 " фрагмент
lt_DocSpc 4 " спецификация
lt_DocPart3D 5 " деталь
lt_DocAssemble3D 6 " сборка
lt_DocTxtStandart 7 " текстовый документ стандартный
lt_DocTxtUser 8 " текстовый документ нестандартный
lt_DocSpcUser 9 " спецификация " нестандартный форм
lt_DocTechnologyAssemble3D 10 " 3d"документ технологическая сборка

LtNodeType  Типы узла дерева библиотеки документов

tn_root 0 " корень дерева
tn_dir 1 " папка
tn_file 2 " документ (файл)

LtVariantType  Типы данных для LtVariant

ltv_Char 1 символ
ltv_UChar 2 байт
ltv_Int 3 целое
ltv_UInt 4 беззнаковое целое
ltv_Long 5 длинное целое
ltv_Float 6 вещественное
ltv_Double 7 двойное вещественное
ltv_Str 8 строка 255 символов char[255]
ltv_NoUsed 9 пока не используется
ltv_Short 10 короткое целое
ltv_WStr 11 Строка 255 символов whar_t[255]

StructType2DEnum  Типы интерфейсов параметров 
объектов графического документа, получаемых 
методом KompasObject::GetParamStruct

ko_Type1 1 ksType1 
ko_Type2 2 ksType2
ko_Type3 3 ksType3
ko_Type5 4 ksType5
ko_Type6 5 ksType6
ko_Phantom 6 ksPhantom
ko_PlacementParam 7 ksPlacementParam 
ko_ViewParam 8 ksViewParam
ko_LayerParam 9 ksLayerParam
ko_RequestInfo 10 ksRequestInfo
ko_LineSegParam 11 ksLineSegParam
ko_ArcByAngleParam 12 ksArcByAngleParam
ko_ArcByPointParam 13 ksArcByPointParam
ko_MathPointParam 14 ksMathPointParam
ko_RectParam 15 ksRectParam
ko_PointParam 16 ksPointParam
ko_BezierPointParam 17 ksBezierPointParam
ko_NurbsPointParam 18 ksNurbsPointParam
4958



ko_BezierParam 19 ksBezierParam
ko_CircleParam 20 ksCircleParam
ko_LineParam 21 ksLineParam
ko_EllipseParam 22 ksEllipseParam
ko_EllipsArcParam 23 ksEllipseArcParam
ko_EllipsArcParam1 24 ksEllipseArcParam1
ko_EquidParam 25 ksEquidistantParam
ko_HatchParam 26 ksHatchParam
ko_ParagraphParam 27 ksParagraphParam
ko_TextParam 28 ksTextParam
ko_TextLineParam 29 ksTextLineParam
ko_TextItemFont 30 ksTextItemFont
ko_TextItemParam 31 ksTextItemParam
ko_StandartSheet 32 ksStandartSheet
ko_SheetSize 33 ksSheetSize
ko_SheetPar 34 ksSheetPar
ko_DocumentParam 35 ksDocumentParam
ko_ColumnInfoParam 36 ksColumnInfoParam
ko_AttributeType 37 ksAttributeTypeParam
ko_Attribute 38 ksAttributeParam
ko_LibraryAttrTypeParam 39 ksLibraryAttrTypeParam
ko_TAN 40 ksTAN
ko_CON 41 ksCON
ko_DimText 42 ksDimTextParam
ko_LDimSource 43 ksLDimSourceParam
ko_DimDrawing 44 ksDimDrawingParam
ko_LDimParam 45 ksLDimParam
ko_LBreakDimSource 46 ksLBreakDimSource
ko_BreakDimDrawing 47 ksBreakDimDrawing
ko_LBreakDimParam 48 ksLBreakDimParam
ko_ADimSourceParam 49 ksADimSourceParam
ko_ADimParam 50 ksADimParam
ko_ABreakDimParam 51 ksABreakDimParam
ko_RDimSource 52 ksRDimSourceParam
ko_RDimDrawing 53 ksRDimDrawingParam
ko_RDimParam 54 ksRDimParam
ko_RBreakDrawing 55 ksRBreakDrawingParam
ko_RBreakDimParam 56 ksRBreakDimParam
ko_RoughPar 57 ksRoughPar
ko_ShelfPar 58 ksShelfPar
ko_RoughParam 59 ksRoughParam
ko_LeaderParam 60 ksLeaderParam
ko_PosLeaderParam 61 ksPosLeaderParam
ko_BrandLeaderParam 62 ksBrandLeaderParam
ko_MarkerLeaderParam 63 ksMarkerLeaderParam
ko_BaseParam 64 ksBaseParam
ko_CutLineParam 65 ksCutLineParam
ko_ViewPointerParam 66 ksViewPointerParam
ko_ToleranceBranch 67 ksToleranceBranch
ko_ToleranceParam 68 ksToleranceParam
ko_CurvePattern 69 ksCurvePattern
ko_CurvePicture 70 ksCurvePicture
ko_CurvePatternEx 71 ksCurvePatternEx
ko_CurveStyleParam 72 ksCurveStyleParam
ko_DimensionPartsParam 73 ksDimensionPartsParam
ko_TextStyleParam 74 ksTextStyleParam
4959



ko_ConicArcParam 75 ksConicArcParam
ko_PolylineParam 76 ksPolylineParam
ko_LibStyle 77 ksLibStyle
ko_TechnicalDemandParam 78 ksTechnicalDemandParam
ko_SpecRoughParam 79 ksSpecRoughParam
ko_DimensionOptions 80 ksDimensionsOptions
ko_SpcColumnParam 81 ksSpcColumnParam
ko_LibraryStyleParam 82 ksLibraryStyleParam
ko_InertiaParam 83 ksInertiaParam
ko_MassInertiaParam 84 ksMassInertiaParam
ko_VariableParam 85 ksVariable
ko_SnapOptions 86 ksSnapOptions
ko_NurbsParam 87 ksNurbsParam
ko_InsertFragmentParam 88 ksInsertFragmentParam
ko_ConstraintParam 89 ksConstraintParam
ko_CornerParam 90 ksCornerParam
ko_RectangleParam 91 ksRectangleParam
ko_RegularPolygonParam 92 ksRegularPolygonParam
ko_CentreParam 93 ksCentreParam
ko_DocAttachSpcParam 94 ksDocAttachedSpcParam
ko_SpcObjParam 95 ksSpcObjParam
ko_RasterParam 96 ksRasterParam
ko_RecordTypeAttrParam 97 ksRecordTypeAttrParam
ko_NumberTypeAttrParam 98 ksNumberTypeAttrParam
ko_SpcStyleColumnParam 99 ksSpcStyleColumnParam
ko_SpcStyleSectionParam 100 ksSpcStyleSectionParam
ko_SpcSubSectionParam 101 ksSpcSubSectionParam
ko_SpcTuningSectionParam 102 ksSpcTuningSectionParam
ko_SpcTuningStyleParam 103 ksSpcTuningStyleParam
ko_SpcStyleParam 104 ksSpcStyleParam
ko_SpcDescrParam 105 ksSpcDescrParam
ko_QualityItemParam 106 ksQualityItemParam
ko_QualityContensParam 107 ksQualityContensParam
ko_LtVariant 108 ksLtVariant
ko_ContourParam 109 ksContourParam
ko_DoubleValue 110 ksDoubleValue
ko_Char255 111 ksChar255
ko_UserParam 112 ksUserParam
ko_HatchLineParam 113 ksHatchLineParam
ko_HatchStyleParam 114 ksHatchStyleParam
ko_OrdinatedSourceParam 115 ksOrdinatedSourceParam
ko_OrdinatedDrawingParam 116 ksOrdinatedDrawingParam
ko_OrdinatedDimParam 117 ksOrdinatedDimParam
ko_SheetOptions 118 ksSheetOptions
ko_InsertFragmentParamEx 119 ksInsertFragmentParamEx
ko_TreeNodeParam 120 ksTreeNodeParam
ko_AssociationViewParam 121 ksAssociationViewParam
ko_HatchLineParam 122 ksHatchLineParam
ko_AxisLineParam 123 ksAxisLineParam
ko_TextDocumentParam 124 ksTextDocumentParam
ko_CopyObjectParam 126 ksCopyObjectParam
ko_OverlapObjectOptions 127 ksOverlapObjectOptions
ko_ChangeLeaderParam 128 ksChangeLeaderParam
ko_ParametrizationParam 9000 ksParametrizationParam
4960



ErrorType  Ошибки API, кроме 3D

Фатальные ошибки " работа прекращается
etNoTXTDocument "8 Документ не активизирован или не является 

текстовым документом.
etNo3dDocument "7 Документ не активизирован или не является 

деталью/сборкой.
etNoAllDocument "6 Документ не активизирован.
etNoSPCDocument "5 Документ не активизирован или не является 

спецификацией.
etLibraryClose "4 Принудительное завершение выполнения 

библиотеки.
etNoPreView "3 В режиме Preview нельзя создавать или 

открывать видимые документы.
etNoDocument "2 Документ не активизирован или не является 

листом/фрагментом.
etAbort "1 Аварийное завершение.
etSuccess 0 Успешное завершение.
Нефатальные ошибки " выполнение продолжается
etError1 1 Попытка выполнить EndObj при неоткрытом 

составном элементе.
etError2 2 Попытка поставить в сплайн недопустимый 

объект.
etError3 3 Попытка поставить в штриховку 

недопустимый объект.
etError4 4 Попытка выполнить delete_mtr при 

невведенной локальной системе координат.
etError5 5 Ошибка при введении локальной системы 

координат.
etError6 6 Группа должна быть постоянной.
etError7 7 Объект не существует.
etError8 8 В текущем документе объект не найден.
etError9 9 Нет памяти!
etError10 10 Вырожденный объект.
etError11 11 Неверный указатель группы.
etError12 12 Объект не принадлежит группе.
etError13 13 Объект нельзя поставить в группу.
etError14 14 Группа должна быть временной.
etError15 15 Первый объект не существует или не 

является кривой.
etError16 16 Второй объект не существует или не 

является кривой.
etError17 17 Кривые расположены в разных видах.
etError18 18 Не совпадают СК определения кривых 

(геометрическая и аннотационная).
etError19 19 Первый объект не является кривой.
etError20 20 Второй объект не является кривой.
etError21 21 Объект уже в группе
4961



etError22 22 Временный объект не может быть в 
постоянной группе.

etError23 23 В документе не предусмотрена работа с 
видами.

etError24 24 Вид с заданным номером уже существует.
etError25 25 Недопустимое значение номера вида.
etError26 26 В текущем документе вид не найден.
etError27 27 Неверный указатель вида.
etError28 28 Вид не редактируется.
etError29 29 Состояние вида задано неверно.
etError30 30 Параметры текущего вида не меняются.
etError31 31 Неверный указатель макроэлемента.
etError32 32 Должен быть режим редактирования 

макроэлемента.
etError33 33 Неверный тип параметров редактирования 

макроэлемента.
etError34 34 В виде остались не закрытые составные 

элементы.
etError35 35 Неверный указатель слоя.
etError36 36 Недопустимое значение номера слоя.
etError37 37 В текущем виде слой не найден.
etError38 38 У объекта параметров нет.
etError39 39 Не соответствует размер структуры 

параметров.
etError40 40 Состояние слоя задано неверно.
etError41 41 Параметры текущего слоя не меняются.
etError42 42 В указанном виде редактирование 

запрещено.
etError43 43 В указанном слое редактирование 

запрещено.
etError44 44 Параметры системного вида не меняются.
etError45 45 Попытка поставить в текст недопустимый 

объект.
etError46 46 Неверный ввод текста.
etError47 47 Неверный тип массива.
etError48 48 Неверный указатель массива.
etError49 49 Указатель на структуру параметров должен 

быть не NULL.
etError50 50 Неверный индекс массива.
etError51 51 Неверное редактирование текста.
etError52 52 Bezier"точка используется неверно.
etError53 53 Неправильный индекс.
etError54 54 Режим работы документа задан неверно.
etError55 55 Режим обработки документов задан 

неверно.
etError56 56 Неверный указатель документа.
etError57 57 Попытка сохранить документ без имени.
etError58 58 Документ закрыт без сохранения.
etError59 59 Имя файла документа задано неверно.
etError60 60 Объект не соответствует типу поиска.
etError61 61 Не могу создать документ. Документ с 

таким именем уже открыт.
etError62 62 Поиск объектов задан неверно.
etError63 63 В текущем документе итератор не найден.
4962



etError64 64 Документ не найден или неверная структура 
файла.

etError65 65 Документ открыт в видимом режиме.
etError66 66 Документ открыт в невидимом режиме.
etError67 67 Нельзя менять тип документа.
etError68 68 Стиль спецификации не найден.
etError69 69 У фрагмента нет размеров листа.
etError70 70 Режим работы документа не меняется.
etError71 71 Вид должен быть активным или текущим.
etError72 72 Тип атрибута задан неверно.
etError73 73 Тип атрибута не найден.
etError74 74 Неверный пароль.
etError75 75 Не найдено определение локального 

фрагмента.
etError76 76 Атрибут в документе не найден.
etError77 77 Атрибут не принадлежит объекту.
etError78 78 Неправильный номер колонки атрибута.
etError79 79 Неправильный номер строки атрибута.
etError80 80 Родительское окно не найдено.
etError81 81 Библиотека атрибутов не найдена или 

ошибка в библиотеке.
etError82 82 Текст размера задан неверно.
etError83 83 Параметры привязки размера заданы 

неверно.
etError84 84 Текст шероховатости задан неверно.
etError85 85 Неверный указатель линейного размера.
etError86 86 Текст линии выноски задан неверно.
etError87 87 Параметры линии выноски заданы неверно.
etError88 88 Попытка поставить в контур недопустимый 

объект.
etError89 89 У звеньев контура не совпадают узлы.
etError90 90 В документе не предусмотрена работа с 

техническими требованиями.
etError91 91 В документе не предусмотрена работа с 

неуказанной шероховатостью.
etError92 92 Попытка поставить в таблицу недопустимый 

объект.
etError93 93 В составном объекте не предусмотрена 

работа с техническими требованиями.
etError94 94 В документе не предусмотрена работа с 

основной надписью.
etError95 95 В составном объекте не предусмотрена 

работа с основной надписью.
etError96 96 Попытка поставить в допуск формы 

недопустимый объект.
etError97 97 Nurbs"точка используется неверно.
etError98 98 Попытка поставить в полилинию 

недопустимый объект.
etError99 99 Объект должен быть геометрическим.
etError100 100 Эквидистанту в контур включать нельзя.
etError101 101 Неправильная работа с указателем на 

определение вставного фрагмента.
etError102 102 Рекурсивная вставка фрагмента.
4963



etError103 103 Ошибка чтения файла фрагмента.
etError104 104 Аналогичное определение вставки 

фрагмента уже есть. Новый комментарий не 
принимается.

etError105 105 Неправильная работа с указателем на 
основную надпись.

etError106 106 Неправильная работа с указателем на 
неуказанную шероховатость.

etError107 107 Неправильная работа с указателем на 
технические требования

etError108 108 Документ должен быть активным.
etError109 109 Стиль кривой не найден.
etError110 110 Объект должен быть кривой.
etError111 111 Стиль текста не найден.
etError112 112 Неверно заданы параметры для расчета 

длины текста.
etError113 113 Новый слой должен существовать и быть 

доступным для редактирования.
etError114 114 Номер раздела задан неверно.
etError115 115 Стиль спецификации не найден.
etError116 116 В текущем документе объект спецификации 

не найден.
etError117 117 Попытка подключить к объекту СП 

недопустимый объект.
etError118 118 Тип объекта задан неверно.
etError119 119 Объект заданного типа не редактируется.
etError120 120 Нужно завершить редактирование 

составного объекта.
etError121 121 Объект должен быть таблицей.
etError122 122 Объект должен быть допуском формы.
etError123 123 Не найден файл для отрисовки слайда.
etError124 124 Неверная структура файла.
etError125 125 Нужно завершить редактирование объекта 

спецификации.
etError126 126 Объект должен быть макроэлементом.
etError127 127 Попытка поставить в макро недопустимый 

объект.
etError128 128 Библиотека фрагментов уже закрыта или не 

открывалась.
etError129 129 Библиотека фрагментов уже открыта.
etError130 130 Файл библиотеки фрагментов не найден.
etError131 131 Ошибка в структуре файла библиотеки 

фрагментов.
etError132 132 Ошибка в имени файла библиотеки 

фрагментов.
etError133 133 Ошибка в имени фрагмента для библиотеки 

фрагментов.
etError134 134 Доступ к фрагменту в библиотеке 

фрагментов невозможен.
etError135 135 В документе не предусмотрена работа со 

спецификацией на листе.
etError136 136 Некорректный вид типа атрибута.
etError137 137 Номер листа спецификации задан неверно.
4964



etError138 138 Документ должен быть открыт в видимом 
режиме.

etError139 139 Ошибка при обработке картинки для стиля 
кривой.

etError140 140 Объект должен быть штриховкой.
etError141 141 Объект должен быть текстом.
etError142 142 В документе не предусмотрена работа со 

спецификацией на листе.
etError143 143 В документе не предусмотрена работа с 

зонами.
etError144 144 Объект спецификации не редактируется.
etError145 145 Файл c растровым объектом не найден.
etError146 146 Ошибка в определении параметров 

описания спецификации.
etError147 147 Описание спецификации не найдено.
etError148 148 Имя файла спецификации уже 

используется в листе.
etError149 149 Описание спецификации данного типа уже 

есть в листе.
etError150 150 Необходимо завершить текущую операцию.
etError151 151 Редактируемый макроэлемент удалять 

нельзя.
etError152 152 Служебный файл допусков graphic.tol не 

найден.
etError153 153 Попытка поставить в макро собственный 

объект.
etError154 154 Неправильно задано оформление первого 

листа спецификации: не указана таблица, 
предназначенная для спецификации.

etError155 155 Не найдено оформление первого листа 
спецификации.

etError156 156 Неправильно задано оформление первого 
листа спецификации: не найдены ячейки 
типа Для спецификации.

etError157 157 Неправильно задано оформление второго и 
последующих листов спецификации: не 
указана таблица, предназначенная для 
спецификации.

etError158 158 Не найдено оформление второго и 
последующих листов спецификации.

etError159 159 Неправильно задано оформление второго и 
последующих листов спецификации: не 
найдены ячейки типа Для спецификации.

etError160 160 Попытка изменить параметры объекта 
только для чтения.

etError161 161 Попытка изменить параметры объекта 
только для чтения.

etError162 162 Ошибка создания файла библиотеки.
etError163 163 Текущий документ пустой. Сохранение в 

выбранном формате производиться не 
будет.
4965



etError164 164 Не найдена библиотека стилей 
спецификаций.

etError165 165 Размер растра превышает допустимый 
максимальный размер (65536 x 65536).

etError166 166 Недостаточно памяти для создания растра 
указанного размера.

etError167 167 Выбранный диапазон страниц в документе 
не существует.

etError168 168 Неверный указатель линии"выноски.
etError169 169 Имя документа изменить нельзя. Документ 

с таким именем уже открыт.
etError170 170 Базовый вид должен быть ассоциативным.
etError171 171 Базовый объект должен быть стрелкой 

вида.
etError172 172 Базовый объект должен быть выносным 

элементом.
etError173 173 Неправильно задан цвет.
etError174 174 Неправильно заданы единицы измерения.
etError175 175 Нельзя создать пользовательскую панель 

свойств.
etError176 176 Метод не используется для данного 

интерфейса.
etError177 177 Документ, открытый только для чтения, не 

может быть сохранён
etError178 178 Нельзя отключить работающую библиотеку
etError179 179 Нельзя отключить AddIn"библиотеку
etError184 184 Значение выходит за границы диапазона.
etError185 185 Значение размера выходит за границы 

диапазона 30'' " 359°59'30''.
etError186 186 Значение размера выходит за границы 

диапазона 0.5'' " 359°59'59.5''.
etError187 187 Значение размера выходит за границы 

диапазона 30' " 359°30'.
etError188 188 Ограничение создать нельзя. Данный тип 

размера не параметризуется.
etError189 189 Ограничение создать нельзя. Нет 

информации о привязке.
etError190 190 Ограничение создать нельзя.
etError191 191 Ограничение такого типа уже существует.
etError192 192 Ограничение создать нельзя.Недопустимое 

имя переменной.
etError193 193 Ограничение создать нельзя.Недопустимое 

значение размера.
etError194 194 Ограничение создать нельзя.Размер может 

быть только информационным.
etError195 195 Аннотационный объект может быть создан 

только в составе макро.
etError201 201 Система не имеет решения
etError202 202 Переменная с таким именем уже существует
etError203 203 Недопустимое имя переменной
etError204 204 Невозможно добавить постоянный объект 

во временный макроэлемент
4966



etError205 205 Недопустимая команда в режиме 
редактирования макрообъекта

etError205 205 Недопустимая команда в режиме 
редактирования макрообъекта

etError206 206 Неправильно задан пароль
etError210 210 Некорректное имя
etError211 211 Хранилище с указанным именем уже 

зарегистрировано
etError212 212 Запрашиваемое хранилище не 

зарегистрировано
etError213 213 Запрашиваемого файла нет в хранилище
etError214 214 Ошибка при работе с файловой системой
etError215 215 Ошибка при перезаписи файла
etError216 216 Метод не может быть вызван: отсутствует 

лицензия
etError217 217 Документ создан более поздней версией
etError218 218 Файл защищен с помощью приложения 

КОМПАС"Защита
MAXERROR  216

TextAlign Типы привязки текста

txta_Left 0 " точка привязки слева
txta_Center 1 " точка привязки в центре
txta_Right 2 " точка привязки справа

LtViewType  Типы видов чертежа

vtUnknown "1 Неизвестный тип
vt_System 0 Системный вид с номером 0; создает"

ся автоматически, существует всегда
vt_Normal 1 Обычный вид
vt_Arbitrary 2 Произвольный вид
vt_Standart 3 Стандартный вид
vt_Projected 4 Проекционный вид
vt_Arrow 5 Вид по стрелке
vt_Remote 6 Выносной вид
vt_Section 7 Вид разрез\сечение
vt_Remote2D 100 Выносной вид не связанный с 3D мо"

делью

ErrorType  Коды ошибок графического документа

etNo3dDocument "7 Документ не активизирован или не является 
трехмерной моделью

etNoAllDocument "6 Документ не активизирован
4967



etNoSPCDocument "5 Документ не активизирован или не является 
спецификацией

etLibraryClose "4 Принудительное завершение выполнения библиотеки
etNoPreView "3 В режиме предварительного просмотра нельзя 

создавать или открывать выводимые документы
etNoDocument "2 Документ не активизирован или не является листом/

фрагментом
etAbort "1 Аварийное завершение
etSuccess 0 Успешное завершение
etError1 1 Попытка выполнить EndObj при неоткрытом 

составном элементе
etError2 2 Попытка поставить в сплайн недопустимый объект
etError3 3 Попытка поставить в штриховку недопустимый 

объект
etError4 4 Попытка выполнить delete_mtr при невведенной 

локальной системе координат
etError5 5 Ошибка при введении локальной системы координат
etError6 6 Группа должна быть постоянной
etError7 7 Объект не существует
etError8 8 В текущем документе объект не найден
etError9 9 Нет памяти
etError10 10 Вырожденный объект
etError11 11 Неверный указатель группы
etError12 12 Объект не принадлежит группе
etError13 13 Объект нельзя поставить в группу
etError14 14 Группа должна быть временной
etError15 15 Первый объект не существует или не является кривой
etError16 16 Второй объект не существует или не является кривой
etError17 17 Кривые расположены в разных видах
etError18 18 Один (или оба) из указанных объектов " не 

геометрический
etError19 19 Первый объект не является кривой
etError20 20 Второй объект не является кривой
etError21 21 Объект уже находится в группе
etError22 22 Временный объект не может быть в постоянной 

группе
etError23 23 В документе не предусмотрена работа с видами
etError24 24 Вид с заданным номером уже существует
etError25 25 Недопустимое значение номера вида
etError26 26 В текущем документе вид не найден
etError27 27 Неверный указатель вида
etError28 28 Вид не редактируется
etError29 29 Состояние вида задано неверно
etError30 30 Параметры текущего вида не меняются
etError31 31 Неверный указатель макроэлемента
etError32 32 Должен быть режим редактирования макроэлемента
etError33 33 Неверный тип параметров редактирования 

макроэлемента
etError34 34 В виде остались не закрытые составные элементы
etError35 35 Неверный указатель слоя
etError36 36 Недопустимое значение номера слоя
etError37 37 В текущем виде слой не найден
etError38 38 У объекта нет параметров
4968



etError39 39 Размер структуры параметров не соответствует 
указанному

etError40 40 Состояние слоя задано неверно
etError41 41 Параметры текущего слоя не меняются
etError42 42 В указанном виде редактирование запрещено
etError43 43 В указанном слое редактирование запрещено
etError44 44 Параметры системного вида не меняется
etError45 45 Попытка поставить в текст недопустимый объект
etError46 46 Неверный ввод текста
etError47 47 Неверный тип массива
etError48 48 Неверный указатель массива
etError49 49 Указатель на структуру параметров должен быть не 

NULL
etError50 50 Неверный индекс массива
etError51 51 Неверное редактирование текста
etError52 52 Точка кривой Безье используется неверно
etError53 53 Неправильный индекс
etError54 54 Режим работы документа задан неверно
etError55 55 Режим обработки документов задан неверно
etError56 56 Неверный указатель на документ
etError57 57 Попытка сохранить документ без имени
etError58 58 Документ закрыт без сохранения
etError59 59 Имя файла документа задано неверно
etError60 60 Объект не соответствует типу поиска
etError61 61 Невозможно создать документ. Документ с таким 

именем уже открыт
etError62 62 Поиск объектов задан неверно
etError63 63 В текущем документе итератор не найден
etError64 64 Документ не найден или неверная структура файла
etError65 65 Документ открыт в видимом режиме
etError66 66 Документ открыт в невидимом режиме
etError67 67 Нельзя менять тип документа
etError68 68 Стиль спецификации не найден
etError69 69 У фрагмента нет размеров  листа
etError70 70 Режим работы документа не меняется
etError71 71 Вид должен быть активным или текущим
etError72 72 Тип атрибута задан неверно
etError73 73 Тип атрибута не найден
etError74 74 Неверный пароль
etError75 75 Не найдено определение локального фрагмента
etError76 76 Атрибут в документе не найден
etError77 77 Атрибут не принадлежит объекту
etError78 78 Неправильный номер колонки атрибута
etError79 79 Неправильный номер строки атрибута
etError80 80 Родительское окно не найдено
etError81 81 Библиотека атрибутов не найдена или ошибка в 

библиотеке
etError82 82 Текст размера задан неверно
etError83 83 Параметры привязки размера заданы неверно
etError84 84 Текст шероховатости задан неверно
etError85 85 Неверный указатель линейного размера
etError86 86 Текст линии выноски задан неверно
etError87 87 Параметры линии выноски заданы неверно
etError88 88 Попытка поставить в контур недопустимый объект
etError89 89 У звеньев контура не совпадают  узлы
4969



etError90 90 В документе не предусмотрена работа с техническими 
требованиями

etError91 91 В документе не предусмотрена работа с неуказанной 
шероховатостью

etError92 92 Попытка поставить в таблицу недопустимый объект
etError93 93 В составном объекте не предусмотрена работа с 

техническими требованиями
etError94 94 В документе не предусмотрена работа с основной 

надписью
etError95 95 В составном объекте не предусмотрена  работа с 

основной надписью
etError96 96 Попытка поставить в допуск формы недопустимый 

объект
etError97 97 Точка кривой NURBS используется неверно
etError98 98 Попытка поставить в ломаную линию недопустимый 

объект
etError99 99 Объект должен быть геометрическим
etError100 100 Эквидистанту в контур включать нельзя
etError101 101 Неправильная работа с указателем на определение 

вставного фрагмента
etError102 102 Рекурсивная вставка фрагмента
etError103 103 Ошибка чтения файла фрагмента
etError104 104 Аналогичное определение вставки фрагмента уже 

есть. Новый комментарий не принимается
etError105 105 Неправильная работа с указателем на основную 

надпись
etError106 106 Неправильная работа с указателем на неуказанную 

шероховатость
etError107 107 Неправильная работа с указателем на технические 

требования
etError108 108 Документ должен быть активным
etError109 109 Стиль кривой не найден
etError110 110 Объект должен быть кривой
etError111 111 Стиль текста не найден
etError112 112 Неверно заданы параметры для расчета длины текста
etError113 113 Новый слой должен существовать и быть доступным 

для редактирования
etError114 114 Номер раздела задан неверно
etError115 115 Стиль спецификации не найден
etError116 116 В текущем документе объект спецификации не найден
etError117 117 Попытка подключить к объекту спецификации 

недопустимый объект
etError118 118 Тип объекта задан неверно
etError119 119 Объект заданного типа не редактируется
etError120 120 Нужно завершить редактирование составного объекта
etError121 121 Объект должен быть таблицей
etError122 122 Объект должен быть допуском формы
etError123 123 Не найден файл для отрисовки слайда
etError124 124 Неверная структура файла
etError125 125 Нужно завершить редактирование объекта 

спецификации
etError126 126 Объект должен быть макроэлементом
4970



etError127 127 Попытка поставить в макроэлемент недопустимый 
объект

etError128 128 Библиотека фрагментов уже закрыта или не 
открывалась

etError129 129 Библиотека фрагментов уже открыта
etError130 130 Файл библиотеки фрагментов не найден
etError131 131 Ошибка в структуре файла библиотеки фрагментов
etError132 132 Ошибка в имени файла библиотеки фрагментов
etError133 133 Ошибка в имени фрагмента для библиотеки 

фрагментов
etError134 134 Доступ к фрагменту в библиотеке фрагментов 

невозможен"
etError135 135 В документе не предусмотрена работа со 

спецификацией на листе
etError136 136 Некорректный вид типа атрибута
etError137 137 Номер листа спецификации задан неверно
etError138 138 Документ должен быть открыт в видимом режиме
etError139 139 Ошибка при обработке картинки для стиля кривой
etError140 140 Объект должен быть штриховкой
etError141 141 Объект должен быть текстом
etError142 142 В документе не предусмотрена работа со 

спецификацией на листе
etError143 143 В документе не предусмотрена работа с зонами
etError144 144 Объект спецификации не редактируется
etError145 145 Файл c растровым объектом не найден
etError146 146 Ошибка в определении параметров описания 

спецификации
etError147 147 Описание спецификации не найдено
etError148 148 Имя файла спецификации уже используется в листе
etError149 149 Описание спецификации данного типа уже есть в 

листе
etError150 150 Необходимо завершить текущую операцию
etError151 151 Редактируемый макроэлемент удалять нельзя
etError152 152 Служебный файл допусков graphic.tol не найден
etError153 153 Попытка поставить в макроэлемент собственный 

объект
etError154 154 Неправильно задано оформление первого листа 

спецификации: не указана таблица, предназначенная 
для спецификации

etError155 155 Не найдено оформление первого листа 
спецификации

etError156 156 Неправильно задано оформление первого листа 
спецификации: не найдены ячейки типа "Для 
спецификации".

etError157 157 Неправильно задано оформление второго и 
последующих листов спецификации: не указана 
таблица, предназначенная для спецификации

etError158 158 Не найдено оформление второго и последующих 
листов спецификации.

etError159 159 Неправильно задано оформление второго и 
последующих листов спецификации: не найдены 
ячейки типа "Для спецификации".
4971



etError160 160 Попытка изменить параметры объекта только для 
чтения.

etError161 161 Попытка изменить параметры объекта только для 
чтения.

etError162 162 Ошибка создания файла библиотекаря фрагментов.
etError163 163 Текущий документ пустой. Сохранение в выбранном 

формате производиться не будет.
etError164 164 Не найдена библиотека стилей спецификаций.
etError165 165 Размер растра превышает допустимый 

максимальный размер (65536 x 65536).
etError166 166 Не хватает памяти для создания растра указанного 

размера.
etError167 167 Выбранный диапазон страниц в документе не 

существует.
etError168 168 Неверный указатель линии выноски.
etError169 169 Имя документа изменить нельзя. Документ с таким 

именем уже открыт.
etError170 170 Базовый вид должен быть ассоциативным.
etError171 171 Базовый объект должен быть стрелкой вида.
etError172 172 Базовый объект должен быть выносным элементом.
etError173 173 Неправильно задан цвет.
etError174 174 Неправильно заданы единицы измерения.
4972



KGAX  ActiveX компонент
Константы
KGAX " ActiveX компонент предназначен для использования во внешнем приложении и
позволяет открывать и работать с документами системы КОМПАС в диалоге пользовате"
ля. При работе с документами, открытыми в ActiveX компоненте, доступно использова"
ние API интерфейсов системы КОМПАС. Кроме этого, для работы с KGAX разработаны
интерфейсы этого элемента управления.
Компонент KGAX.ocx регистрируется при установке системы КОМПАС.

KDocumentType  Предопределенные типы 
документов

vt_SheetStandart 1 Чертеж. Стандартный формат,
vt_SheetUser 2 Чертеж. Пользовательский формат,
vt_Fragment 3 Фрагмент,
vt_Spc 4 Спецификация,
vt_3DPart 5 Модель,
vt_3DAssembly 6 Сборка,
vt_TextStandart 7 Текстовый документ. Стандартный формат,
vt_TextUser 8 Текстовый документ. Пользовательский формат,
vt_SpcUser 9 Спецификация. Пользовательский формат.

KZoomType  Способы масштабирования окна 
документа

vt_ZoomWindow 1 Масштабировать окном.
(Запускается процесс мас"
штабирования окном).

vt_ZoomIn 2 Увеличить масштаб.
vt_ZoomOut 3 Уменьшить масштаб.
vt_ZoomSelected 4 Показать полностью выде"

ленные объекты.
vt_ZoomEntireDocument 5 Показать весь документ.
vt_Refresh 6 Обновить изображение.

KDocument3DDrawMode  Режимы отображения 
документамодели

vt_WireframeMode 0 Каркас.
vt_HiddenRemovedMode 1 Без невидимых линий.
vt_HiddenThinMode 2 Невидимые линии тонкие.
vt_ShadedMode 3 Полутоновое.
4973



LibManagerMode  Режимы установки текущего 
менеджера библиотек

vt_MainLibManager "1 Менеджер библиотек главного окна.
vt_Default 0 Отключить использование текущего менеджера библиотек.
vt_CurrentLibManager 1 Менеджер библиотек текущей OLE вставки.

Интерфейсы
Интерфейс _DKGAX
Dispatch интерфейс для элемента KGAX.

Интерфейс _DKGAX  свойства
Caption  Заголовок
Пример...
Интерфейс...
Тип данных:BSTR.
Синтаксис:
BSTR Caption;

Text  Текст
Пример..
Интерфейс...
Тип данных:BSTR.
Синтаксис:
BSTR Text;

DocumentType  Тип документа для отображения
Пример...
Интерфейс...
Тип данных:KDocumentType.
Синтаксис:
KDocumentType DocumentType;
Примечание:
Свойство доступно на этапе разработки диалога. Если оно установлено, то при открытии
диалога с KGAX в нем будет создан новый документ данного типа. Список возможных
значений определен в KDocumentType.
4974



DocumenFileName  Имя файла документа для 
отображения
Пример...
Интерфейс...
Тип данных:BSTR.
Синтаксис:
BSTR DocumenFileName;
Примечание:
Свойство доступно на этапе разработки диалога. Если оно установлено, то при открытии
диалога с KGAX в нем будет открыт документ с заданным именем.

Document3DDrawMode  Режим отображения 
документамодели
Пример...
Интерфейс...
Тип данных:KDocument3DDrawMode.
Синтаксис:
KDocument3DDrawMode Document3DDrawMode;
Примечание:

1.  Свойство изменяет тип отображения текущего документа"модели, загруженного в
KGAX.

2.  Список возможных значений определен в KDocument3DDrawMode.
3.  Свойство работает совместно с Document3DWireframeShadedMode.

Document3DWireframeShadedMode  Признак 
отображения 3D документа (Полутоновое с каркасом)
Пример...
Интерфейс...
Тип данных:VARIANT_BOOL.
Синтаксис:
VARIANT_BOOL Document3DWireframeShadedMode;
Примечание:

1.  Свойство изменяет тип отображения текущего документа"модели, загруженного в
KGAX.

2.  Свойство работает совместно с Document3DDrawMode.
3.  Если установлен режим Document3DDrawMode = vt_ShadedMode и

Document3DWireframeShadedMode = TRUE, то документ"модель будет отображаться в
режиме Полутоновое с каркасом.
4975



Интерфейс _DKGAX  методы
GetKompasObject  Получить интерфейс на API КОМПАС
3D
Интерфейс...
Синтаксис:
KompasObject* GetKompasObject();
Примечание:
Метод позволяет получит доступ к API КОМПАС"3D, что позволяет работать как с доку"
ментами, загруженными в KGAX, так и с документами, загруженными в КОМПАС.
Смотрите также: PaintObject.

ZoomEntireDocument  Показать весь документ
Интерфейс...
Синтаксис:
void ZoomEntireDocument();

MoveViewDocument  Сдвинуть изображение
Интерфейс...
Синтаксис:
void MoveViewDocument();
Примечание:
Метод запускает процесс сдвига изображения текущего документа, открытого в KGAX.

PanoramaViewDocument  Приблизить/отдалить 
изображение
Интерфейс...
Синтаксис:
void PanoramaViewDocument();
Примечание:
Метод запускает процесс " Приблизить/отдалить изображение.

RotateViewDocument  Повернуть изображение
Интерфейс...
Синтаксис:
void RotateViewDocument();
Примечание:
Метод запускает процесс " Повернуть изображение.
4976



OrientationDocument  Ориентация изображения
Интерфейс...
Синтаксис:
void OrientationDocument();
Примечание:
Метод вызывает диалог выбора ориентации текущего документа.

StopCurrentProcess  Завершить текущий процесс
Интерфейс...
Синтаксис:
void StopCurrentProcess ([in][defaultvalue(FALSE)] VARIANT_BOOL cancel);
Входные параметры:

cancel " отмена.

Значения параметра:

FALSE (по умолчанию) " принять изменения внесенные в про"
цессе,

TRUE " отменить изменения, внесенные в процессе.

Примечание:
Метод позволяет прервать текущий процесс.

AddNewDocument  Добавить новый документ 
Интерфейс...
Синтаксис:
long AddNewDocument ([in]BSTR fileName);
Входные параметры:

fileName " полное имя файла документа КОМПАС.

Примечание:
Метод позволяет открыть документ с заданным именем в KGAX. Возвращает индекс в
массиве документов, открытых в KGAX.

AddNewEmptyDocument  Добавить новый документ
Интерфейс...
Синтаксис:
long AddNewEmptyDocument ([in]KDocumentType docType);
Входные параметры:
4977



docType " тип нового документа из KDocumentType.

Примечание:
Метод создает новый документ заданного типа и открывает его в KGAX.

RemoveDocumentByIndex  Закрыть документ с 
указанным индексом
Интерфейс...
Синтаксис:
VARIANT_BOOL RemoveDocumentByIndex ([in]long index);
Входные параметры:

index " индекс документа.

Примечание:

1.  Перед закрытием документа должны быть освобождены все интерфейсы, захваченные
на данном документе.

2.  После применения метода индексы документов, открытых после данного документа,
уменьшаются на 1.

ActivateDocumentByIndex  Активизировать документ с 
указанным индексом
Интерфейс...
Синтаксис:
VARIANT_BOOL ActivateDocumentByIndex ([in]long index);
Входные параметры:

index " индекс документа.

GetActiveDocumentIndex  Получить индекс активного 
документа
Интерфейс...
Синтаксис:
long GetActiveDocumentIndex();
Возвращаемое значение:

" индекс активного документа.
4978



ь

InvalidateActiveDocument  Перерисовать окно 
активного документа
Интерфейс...
Синтаксис:
VARIANT_BOOL InvalidateActiveDocument ([in]VARIANT_BOOL erase);
Входные параметры:

erase " Очистка фона

Значения параметра:

TRUE " очищать фон,
FALSE " не очищать фон.

Смотрите также:CWnd::Invalidate.

DrawToDC  Отрисовать документ на заданном HDC
Интерфейс...
Синтаксис:
VARIANT_BOOL DrawToDC ([in]OLE_HANDLE dc, [in]long left, [in]long top, [in]long width,
[in]long height);
Входные параметры:

dc " OLE_HANDLE на котором необходимо отрисоват
документ, например HDC принтера или окна,

left, top, " задают квадрат участка документа.
width, height

ZoomWindow  Macштабировать окно документа
Интерфейс...
Синтаксис:
void ZoomWindow ([in] [defaultvalue(vt_ZoomWindow)] KZoomType type);
Входные параметры:

type " тип масштабирования из KZoomType.
По умолчанию используется
vt_ZoomWindow " Масштабировать окном.
4979



:
t,
GetDocumentByIndex  Получить указатель на документ 
по индексу
Интерфейс...
Синтаксис:
LPDISPATCH GetDocumentByIndex( [in]long index );
Входные параметры:

index " индекс документа.

Возвращаемое значение:

index " Интерфейс активного документа открытого в KGAX
ksDocument2D, ksDocument3D, ksSpcDocumen
ksDocumentTxt.

SetCurrentLibManager  Установить текущий менеджер 
библиотек
Интерфейс...
Синтаксис:
void SetCurrentLibManager ([in]KLibManagerMode mode);
Входные параметры:

mode " режим установки текущего менеджера библио"
тек из KLibManagerMode:

Интерфейс _DKGAX  События
OnKgMouseDown  Кнопка мыши нажата
Синтаксис Automation:
void OnKgMouseDown ([in]short nButton,
[in]short nShiftState,
[in]long x,
[in]long y,
[out]VARIANT_BOOL* proceed);
Входные параметры:

nButton " номер кнопки мыши,
nShiftState " признак нажатия кнопки Shift,
x, y " координаты мыши.

Выходные параметры:
4980



proceed " использовать ли стандартную обработку нажа"
тия кнопки мыши.

Примечание:
Приложение может запретить обработку события системой КОМПАС. Для этого пере"
менной proceed нужно присвоить значение FALSE.

OnKgMouseUp  Кнопка мыши отпущена
Синтаксис Automation:
void OnKgMouseUp ([in]short nButton,
[in]short nShiftState,
[in]long x, [in]long y,
[out]VARIANT_BOOL* proceed );
Входные параметры:

nButton " номер кнопки мыши,
nShiftState " признак нажатия кнопки Shift,
x, y " координаты мыши.

Выходные параметры:

proceed " использовать ли стандартную обработку нажатия кнопки мыши.

Примечание:
Приложение может запретить обработку события системой КОМПАС. Для этого пере"
менной proceed нужно присвоить значение FALSE.

OnKgMouseDblClick  Двойной щелчок мышью
Синтаксис Automation:
void OnKgMouseDblClick ([in]short nButton,
[in]short nShiftState,
[in]long x, [in]long y,
[out]VARIANT_BOOL* proceed );
Входные параметры:

nButton " номер кнопки мыши,
nShiftState " признак нажатия кнопки Shift,
x, y " координаты мыши.

Выходные параметры:

proceed " использовать ли стандартную обработку нажатия кнопки мыши.

Примечание:
4981



Приложение может запретить обработку события системой КОМПАС. Для этого пере"
менной proceed нужно присвоить значение FALSE.

OnKgStopCurrentProcess  Завершен процесс 
панорамирования, поворота, сдвига и т.д.
Синтаксис Automation:
void OnKgStopCurrentProcess();
Примечание:
Данное событие генерируется при завершении запущенного процесса.

OnKgCreate  Окончание создания окна
Синтаксис Automation:
void OnKgCreate ([in]long index);

OnKgPaint  Окончание отрисовки в окне
Синтаксис Automation:
void OnKgPaint ([in]PaintObject* paintObj);
Входные параметры:

paintObj " интерфейс для создания графических объектов.

Примечание:
После завершения отрисовки документа можно отрисовать свои объекты.
Смотрите также:
KompasObject.

OnKgCreateGLList  Окончание создания листа в 
контексте OpenGL
Синтаксис Automation:
void OnKgCreateGLList ([in]GL
Object* glObj,
[in]KDocument3DDrawMode drawMode);
Входные параметры:

glObj " интерфейс функций OpenGL системы КОМПАС GLObject,
drawMode " тип отображения в документе.

Примечание:
После завершения отрисовки документа можно отрисовать свои объекты.
_______________
Смотрите также:
4982



KompasObject.

OnKgAddGabarit  Габариты документа определены
Синтаксис Automation:
void OnKgAddGabarit ([in]GabaritObject* gabObj);
Входные параметры:

glObj " интерфейс функций OpenGL системы КОМПАС GLObject,

Примечание:
После завершения отрисовки документа можно отрисовать свои объекты.
_______________
Смотрите также:
KompasObject.

Интерфейс PaintObject
Интерфейс вспомогательных данных для события OnKgPaint.

PaintObject  методы
GetHWND  Получить дескриптор окна
Синтаксис:
OLE_HANDLE GetHWND();
Возвращаемое значение:

" дескриптор окна.

GetDC  Получить дескриптор контекста отображения
Синтаксис:
OLE_HANDLE GetDC();
Возвращаемое значение:

" Дескриптор контекста отображения.

ReleaseDC  Закрыть дескриптор контекста отображения
Синтаксис:
VARIANT_BOOL ReleaseDC ([in]OLE_HANDLE dc);
Входные параметры:
4983



dc DC " дескриптор закрываемого контекста отображения.

Возвращаемое значение:

TRUE " в случае успешного завершения,
FALSE " в случае ошибки.

GetTransformMatrix  Получить коэффициенты для 
матрицы преобразования координат
Синтаксис:
VARIANT_BOOL GetTransformMatrix ([out]double* a11,
[out]double* a12,
[out]double* a13,
[out]double* a14,
[out]double* a21,
[out]double* a22,
[out]double* a23,
[out]double* a24 );
Выходные параметры:

a11, a12, a13, a14 " первая строчка матрицы.

Интерфейс GabaritObject
Интерфейс вспомогательных данных для события OnKgAddGabatit.

Интерфейс GabaritObject  методы
AddGabarit  Добавить дополнительный габарит к 
габариту документа
Интерфейс...
Синтаксис:
VARIANT_BOOL AddGabarit ([in]double p1X,
[in]double p1Y,
[in]double p1Z,
[in]double p2X,
[in]double p2Y,
[in]double p2Z );
Входные параметры:

p1X, p1Y, p1Z " координаты первой точки габарита,
p2X, p2Y, p2Z " координаты второй точки габарита.
4984



Интерфейс GLObject
Интерфейс вспомогательных данных для события OnKgCreateGLList.
Примечание:
Данный интерфейс нужно использовать при отрисовке с помощью OpenGL. Более под"
робное описание методов смотри в описании библиотеки OpenGL.

Интерфейс GLObject  методы
VARIANT_BOOL glBegin ([in]long mode);
VARIANT_BOOL glEnd();
VARIANT_BOOL glEnable ([in]long cap);
VARIANT_BOOL glDisable ([in]long cap);
VARIANT_BOOL glColor3d ([in]double r, [in]double g, [in]double b);
VARIANT_BOOL glLineWidth ([in]double w);
VARIANT_BOOL glLineStipple ([in]long factor, [in]short pattern);
VARIANT_BOOL glPointSize ([in]double w);
VARIANT_BOOL glPolygonMode ([in]long face, [in]long mode);
VARIANT_BOOL glVertex2d ([in]double x, [in]double y);
VARIANT_BOOL glVertex2dv ([in]double* pData, [in]long countDouble);
VARIANT_BOOL glVertex3d ([in]double x, [in]double y, [in]double z);
VARIANT_BOOL glVertex3dv ([in]double* pData, [in]long countDouble);
VARIANT_BOOL glVertex4d ([in]double x, [in]double y, [in]double z, [in]double w);
VARIANT_BOOL glVertex4dv ([in]double* pData, [in]long countDouble);

События
Интерфейс событий ActiveX объекта
OnKgAddGabarit
OnKgCreate
OnKgCreateGLList
OnKgMouseDblClick
OnKgMouseDown
OnKgMouseUp
OnKgPaint
OnKgStopCurrentProcess
4985



4986



Event_common

Связь объектов системы с интерфейсами событий

Объекты системы Интерфейс событий объекта
Объект приложение Интерфейс событий приложенияИнтерфейс событий 
KompasObject документаИнтерфейс событий объектов документа"

моделиИнтерфейс событий менеджера выделенных 
объектовИнтерфейс событий основной надписи графического 
документаИнтерфейс событий объектов графического 
документаИнтерфейс событий документа"моделиИнтерфейс 
событий графического документаИнтерфейс событий объекта 
спецификацииИнтерфейс событий спецификацииИнтерфейс 
событий документа"спецификации

Графический документ Интерфейс событий документаИнтерфейс событий менеджера 
ksDocument2D выделенных объектовИнтерфейс событий основной надписи 

графического документа Интерфейс событий графического 
документаИнтерфейс событий объектов графического 
документаИнтерфейс событий объекта спецификацииИнтерфейс 
событий спецификации

Спецификация Интерфейс событий документаИнтерфейс событий основной 
ksSpcDocument надписи графического документаИнтерфейс событий объекта 

спецификацииИнтерфейс событий спецификации Интерфейс 
событий документа"спецификации

Текстовый документ Интерфейс событий документаИнтерфейс событий основной 
ksDocumentTxt надписи графического документа
Документ"модель Интерфейс событий документаИнтерфейс событий менеджера 
ksDocument3D выделенных объектовИнтерфейс событий объектов документа"

моделиИнтерфейс событий объекта спецификацииИнтерфейс 
событий спецификацииИнтерфейс событий документа"модели

События системы; перечисления
События приложения...
События документа...
События документа"модели...События графического документа...События менеджера
выделенных объектов...
События объектов графического документа...
События объектов документа"модели...
События основной надписи графического документа...
События объекта спецификации...События для спецификации...События документа"спе"
цификации...

IsNotIifyProcess  Ограничение обрабатываемых событий
Синтаксис Automation:
4987



Не используется.
Синтаксис COM:
BOOL IsNotifyProcess (int notifyType);
Входной параметр:

notifyType " номер события в 
перечислении событий.

Возвращаемое значение:

TRUE " событие будет 
обрабатываться,

FALSE " событие 
обрабатываться не будет.

Примечание:
В COM перед любым вызовом события система сделает запрос о возможности его обра"
ботки с использованием данного метода. Библиотека сама может ограничивать обраба"
тываемые события.

SpcObjectNotify
Источник событий объекта спецификации.
Указатель на источник событий SpcObjectNotify можно получить можно получить при по"
мощи метода ksSpecification::GetSpcObjectNotify.
В COM источником для подписки является документ"спецификация, графический доку"
мент, документ"модель.
Интерфейс событий объекта спецификации...

SpcDocumentNotify 
Источник событий для документаспецификации.
Указатель на источник событий SpcDocumentNotify можно получить при помощи метода
ksSpcDocument::GetSpcDocumentNotify.
В COM источником для подписки является документ"спецификация.
Интерфейс событий для документа"спецификации...

Document3DNotify
Интерфейс событий документа"модели...
Источник событий документамодели.
Интерфейс позволяет контролировать редактирование документа"модели.
4988



Указатель на источник событий Document3DNotify можно получить при помощи метода
ksDocument3D::GetDocument3DNotify.
В COM источником для подписки является документ"модель.

По координатам
Требуется задать следующие параметры:
координаты центра (XC; YC),
координаты начальной и конечной точек (X1; Y1), (X2; Y2),
радиус Radius,
направление Direction.

По трем точкам
Требуется задать следующие параметры:
координаты начальной (X1; Y1) и конечной (X2; Y2) точек, 
координаты точки, лежащей на дуге (X3; Y3),

По углам
Требуется задать следующие параметры:
координаты центра (XC; YC),
угол между осью X и направлением на первую точку Angle1,
угол между осью X и направлением на вторую точку Angle2,
радиус Radius,
направление Direction.

По точке и углу
Требуется задать следующие параметры:
координаты центра (XC; YC),
координаты начальной (X1; Y1) или конечной (X2; Y2) точек,
угол между осью X и направлением на первую точку Angle1, если заданы координаты
точки 2
угол между осью X и направлением на вторую точку Angle2, если заданы координаты
точки 1
направление Direction.
4989



По углу, точке и радиусу
Требуется задать следующие параметры:
координаты центра (XC; YC),
угол между осью X и направлением на первую Angle1, или вторую Angle2 точку, 
координаты начальной (X1; Y1), если задан угол на точку 2 или конечной (X2; Y2), если
задан угол на точку 1 точек,
радиус Radius,
направление Direction.

По конечным точкам и углу
Требуется задать следующие параметры:
координаты начальной (X1; Y1) и конечной (X2; Y2) точек,
угол между осью X и направлением на первую Angle1 или вторую точку Angle2, 
направление Direction.

Плавающий центр, вариант 1
Требуется задать следующие параметры:
угол между осью X и направлением на первую Angle1 и вторую точку Angle2, 
координаты начальной (X1; Y1) или конечной (X2; Y2)) точек,
направление Direction.

Плавающий центр, вариант 2
Требуется задать следующие параметры:
координаты начальной (X1; Y1) или конечной (X2; Y2) точек,
угол между осью X и направлением на первую точку Angle1, если заданы координаты
точки 2
угол между осью X и направлением на вторую точку Angle2,, если заданы координаты
точки 1
радиус Radius,
направление Direction.

NewConstraint  пример использования при создании ассоциативного 
размера
…
IParametriticConstraintPtr association = dimObj1">NewConstraint();
4990



if ( association ) 
{
 _variant_t partner = CreatePartner( obj1, obj2 ); // obj1, obj2 " объекты с которыми        ас"
социируем размер
// Создаем ограничение Ассоциативность 
       association">ConstraintType = ksCAssociation;
       association">Partner = partner; 
       association">Create();
}
...
//""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""" 
// Создать массив SafeArray типа LPDISPATCH 
// """ 
_variant_t CreatePartner( LPDISPATCH obj1, LPDISPATCH obj2 )
{
   _variant_t res;
   if ( obj2 ) 
   { 
     SAFEARRAY * pSANew = NULL;
     SAFEARRAYBOUND rgsabound;
      rgsabound.lLbound = 0;
      rgsabound.cElements = 2;  // количество элементов в массиве 
      pSANew = ::SafeArrayCreate(VT_DISPATCH, 1, &rgsabound);
      if ( pSANew )
      { 
      long i1 = 0;
      long i2 = 1;
      ::SafeArrayPutElement( pSANew, &i1, obj1 );  // положить первый объект 
      ::SafeArrayPutElement( pSANew, &i2, obj2 );  // положить второй объект 

       res.vt = VT_ARRAY | VT_DISPATCH;
       V_ARRAY(&res) = pSANew;
      }
  } 
 else 
  { 
     if ( obj1 )
       res = obj1;
4991



  }
 return res;
}

Главная центральная система координат
Ось OX называется главной осью инерции тела, если центробежные моменты инерции
Jxy и Jxz одновременно равны нулю. Через каждую точку тела можно провести три глав"
ные оси инерции. Эти оси взаимно перпендикулярны друг другу. Моменты инерции тела
относительно трёх главных осей инерции, проведённых в произвольной точке O тела, на"
зываются главными моментами инерции тела.
Главные оси инерции, проходящие через центр масс тела, называются главными цен"
тральными осями инерции тела, а моменты инерции относительно этих осей — его глав"
ными центральными моментами инерции.

Центральная система координат
Ортогональная система координат с началом в центре масс тела и осями, параллельны"
ми осям глобальной (исходной ) системы координат.

Пример
Для подсчета количества компонентов определенного типа на заданном уровне сборки
нужно у интерфейса компонентов IPart7 получить список уникальных компонентов с по"
мощью свойства PartsEx[ ( long)ksUniqueParts ]. В списке найденных следует найти нуж"
ный компонент и у IPart7 получить количество вставок InstanceCount найденного компо"
нента. 

Пример:
if (  newKompasAPI ) // newKompasAPI " интерфейс IApplicationPtr
{
IKompasDocument3DPtr doc3D(  newKompasAPI">ActiveDocument );
if (  doc3D )
{
IPart7Ptr topPart (  doc3D">TopPart );
if (  topPart )
{
            long count = topPart">GetInstanceCount(  NULL ); // Общее количество компонентов
Message(  _bstr_t( count) );
_variant_t uniqueParts(  topPart">PartsEx[( long)ksUniqueParts] );
            if (  uniqueParts.vt == (  VT_ARRAY | VT_DISPATCH ) )
{

4992



              int count = uniqueParts.parray">rgsabound[0].cElements " uniqueParts.parray"
>rgsabound[0].lLbound;
              if (  uniqueParts.parray">cDims == 1 ) 
{
                HRESULT hr;
                LPDISPATCH HUGEP *pvar;
                hr = ::SafeArrayAccessData( uniqueParts.parray, ( void HUGEP* FAR*)&pvar);
                if (  !FAILED( hr) && pvar ) 
{
                  for (  int i = 0; i < count; i++ )
{
                    IPart7Ptr obj(  pvar[i] );
                    if (  obj )
{
                      long count = topPart">GetInstanceCount(  obj ); // Количество вставок компонента
Obj
          Message(  _bstr_t( count) );
}
}
hr = ::SafeArrayUnaccessData( uniqueParts.parray);
}
}
}
}
}
}

4993



Вращение, прецессия и нутация
 

Прецессия
Прецессия — явление, при котором ось вращающегося объекта поворачивается, напри"
мер, под действием внешних моментов.
См. Рисунок... 

Нутация
Нутация (от лат. nutatio — колебание), происходящее одновременно с прецессией дви"
жение твёрдого тела, при котором изменяется угол между осью собственного вращения
тела и осью, вокруг которой происходит прецессия; этот угол называется углом нутации.
Cм.Рисунок... 

ksZoom  пример использования
//открыть документ "1.cdw"
reference d = OpenDocument ("1.cdw", 0);
//в текущем виде нарисовать отрезок
LineSeg(20, 20, 40, 40, 1);
//увеличить изображение окна, чтобы отрезок оказался в центре и в окне
if(!ksZoom (15, 15, 45, 45))
 Error ("Ошибка при задании окна ");

ksZoomScale  пример использования
//открыть документ "1.cdw"
reference d = OpenDocument ("1.cdw", 0);
//в текущем виде нарисовать отрезок
4994



LineSeg (20, 20, 40, 40, 1);
//увеличить изображение окна, чтобы отрезок оказался в центре и в окне
if(!ksZoomScale (30, 30, 2))
 Error("Ошибка при задании окна ");

ksZoomPrevNextOrAll  пример использования
//открыть документ "1.cdw"
reference d =OpenDocument ("1.cdw", 0);
//показать в окне весь документ
ksZoomPrevNextOrAll (2);

ksGetZoomScale  пример использования
double x, y, scale;
 if (ksGetZoomScale (&x, &y, &scale)) {
  ksZoomScale (100, 100, 2);
  Message("Изменен масштаб в окне");
  ksZoomScale (x, y, scale);
  Message("Предыдущий масштаб");
 }
 else
  MessageBoxResult();

ksRefreshActiveWindow  пример использования
{
ksRefreshActiveWindow ();
}

Пример использования тригонометрических функций 
void Trig_Example (void) {

double h, b, Ang =60; 

    /* Построение прямоугольного треугольника с гипотенузой L и углом Ang */

h = L * SinD (Ang); /* высота треугольника */
b = L * CosD (Ang); /* основание треугольника */
4995



LineSeg ( 0, 0, 0, h, 1); 
LineSeg ( 0, h, b, 0, 1); 
LineSeg ( b,  0, 0, 0, 1); 

    /* Связь катетов */
h = b * TanD (Ang);

    /* Обратное вычисление угла */
Ang = AtanD (h / b);

}; /* Trig_Example */

Symmetry  пример использования 
//"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
// Симметрия точки
// """
void SymmetryPoint()
{
  double px=10, py=10;
  double
    os_x1 = 50, os_y1 = 50,
    os_x2 = 60, os_y2 = 50;

  // Отрисовка точки
  Point( px, py, 0 );

  // Отрисовка отрезка
  LineSeg( os_x1, os_y1, os_x2, os_y2, 1 );

  double s_px, s_py; // Результат симметрии точки

  // Получить координаты точки, симметричной относительно заданной оси
  Symmetry( px, py,   // Координаты точки
            os_x1, os_y1,   // Начальная точка оси
            os_x2, os_y2,   // Конечная точка оси
            &s_px, &s_py ); // Результат симметрии
4996



  // Отрисовка результирующей точки
  Point( s_px, s_py, 1 );

  // Результат симметрии
  TCHAR buf[255];
  _stprintf_s( buf, _T("x = %4.2f, y = %4.2f"), s_px, s_py );
  MessageT( buf );

  //"""" работа с в режиме преобразования координат

  ksMtr(100,100,0,1,1);

  // Отрисовка точки
  Point( px, py, 0 );

  // Отрисовка отрезка
  LineSeg( os_x1, os_y1, os_x2, os_y2, 1 );

  double lcs_px, lcs_py;
  
  ksPointFromMtr( px, py, &lcs_px, &lcs_py );

  Symmetry( lcs_px, lcs_py,   // Координаты точки
    os_x1, os_y1,   // Начальная точка оси
    os_x2, os_y2,   // Конечная точка оси
    &s_px, &s_py ); // Результат симметрии

  // Отрисовка результирующей точки
  ksPointIntoMtr(s_px, s_py, &lcs_px, &lcs_py );
  Point( lcs_px, lcs_py, 1 );

  DeleteMtr();

  _stprintf_s( buf, _T("x = %4.2f, y = %4.2f"), lcs_px, lcs_py );
  MessageT( buf );
}

4997



Rotate  пример использования 

void Rotate_Example (void) {

double x[2], y[2]; 

LineSeg ( 10, 60, 60, 90, 1); 

Rotate (10, 60, 0, 0, 90, x[0], y[0]);
Rotate (60, 90, 0, 0, 90, x[1], y[1]);

LineSeg (x[0], y[0], x[1], y[1], 1); 

}; /* Rotate_Example */

MovePoint  пример использования 

void MovePointExample (void) {

double x1, y1, x2, y2 ; 

x1 = 10;
y1 = 60;
x2 = 60;
y2 = 90;

LineSeg ( x1, y1, x2, y2, 1); 

MovePoint (&x1, &y1, 90, 100);
MovePoint (&x2, &y2, 90, 100);

LineSeg ( x1, y1, x2, y2, 1); 

}; /* MovePointExample */
4998



ksPointIntoMtr  пример использования 
{
double x, y, xn, yn;

x = 10;
y = 20;
Point (x, y, 1);
Mtr(100, 100, 45, 2);

ksPointIntoMtr (x, y, &xn, &yn);
}

ksPointFromMtr  пример использования 
{
double x, y, xn, yn;

Mtr(100, 100, 45, 2);
x = 10;
y = 20;
Point (x, y, 1);
ksPointFromMtr (x, y, &xn, &yn);
}

ksLengthIntoMtr  пример использования 
{
double Len;

Len = 100;
Mtr(100, 100, 45, 2);
ksLenghtIntoMtr (&Len);
}

ksLengthFromMtr  пример использования 
{

4999



double Len;

Mtr(100, 100, 45, 2);
Len = 100;
ksLenghtFromMtr (&Len);
}

ksEqualPoints  пример использования 
double x1 = 10, y1= 10; 
 double x2 = 20, y2= 20; 

 if(ksEqualPoints(x1, y1, x2, y2))
  Message("Точки эквивалентны"); 
 else
  Message("Точки не эквивалентны");

ksGetCurvePerpendicular, ksPointsOnCurve  пример использования
//равномерное размещение точек и перпендикуляров к ним на кривой
reference pObj;
int count = 10;
RequestInfo info;
double x, y;
memset (&info, 0, sizeof (info));
info.prompt = "Укажите кривую";
int j = Cursor (&info, &x ,&y, 0);
if (j)
{
if (ExistObj(pObj = FindObj(x, y, 1e6)))
{
//узнаем тип объекта
int type = GetObjParam (pObj, 0, 0, 0);//указатель на графический объект
if (type == CIRCLE_OBJ||//окружность
type == ARC_OBJ||//дуга
type == NURBS_OBJ||//nurbs
type == LINESEG_OBJ||//отрезок
5000



type == BEZIER_OBJ||//bezier
type == CONTOUR_OBJ||//контур
type == POLYLINE_OBJ||//полилиния
type == ELLIPSE_OBJ||//эллипс
type == ELLIPSE_ARC_OBJ||//дуга эллипса
type == RECTANGLE_OBJ||//прямоугольник
type == REGULARPOLYGON_OBJ)//многоугольник
{
//получим массив точек
reference pointArr = ksPointsOnCurve (pObj,//указатель на кривую
count);//количество точек
if (pointArr)
{
for (uint i = 0; i < count; i)
{
//в цикле получим все точки на кривой
MathPointParam par;
if (GetArrayItem (pointArr,// указатель на массив
i,// индекс в массиве 
// (нумерация начинается с 0)
&par,// указатель на структуру элемента
sizeof (MathPointParam)))
// размер структуры элемента
{
//построим точку
Point (par.x, par.y, 0);
//найдем перпендикуляр к кривой в точке
double angl = ksGetCurvePerpendicular(pObj, par.x, par.y);
//построим перпендикуляр (отрезок длиной 10 мм)
double x1 = par.x, y1 = par.y, x2 = par.x, y2 = par.y;
MovePoint ( &x1, &y1, angl, 5);
MovePoint ( &x2, &y2, angl180, 5);
LineSeg (x1, y1, x2, y2, 2);
}
else
MessageBoxResult ();//ошибка доступа к объекту массива
}
}

5001



else
MessageBoxResult ();//ошибка
}
else
Error ("Выбранный объект " не кривая");
}
}

ksMakeEncloseContours, ksHatch  пример использования 
RequestInfo info;
 //обнулить структуру info;
 memset(&info, 0, sizeof(info));
 double x, y;
 info.prompt = "Укажите точку внутри области";
 int j = Cursor(&info, &x ,&y, 0);
 if (j) {
  HatchParam par;
  memset(&par, 0, sizeof(par));
  par.step = 2;
  par.ang = 45;
  //границы штриховки вычисляем
  par.pBoundaries = ksMakeEncloseContours(0, x, y);
  //штриховка
  reference h = ksHatch(&par);
  if (h) {
   LightObj(h, 1);
   Message("Создали штриховку в виде по точке внутри области");
   LightObj(h, 0);
  }
  else
   Error("Ошибка в задании штриховки");
 }

ksIsPointInsideContour, ksIsCurveClosed  пример использования 
reference pObj;
5002



 RequestInfo info;
 double x, y;
 memset(&info, 0, sizeof(info));
 info.prompt = "Укажите контур";
 int j = Cursor(&info, &x ,&y, 0);
 if (j) {
  //выбрать контур
  if(ExistObj(pObj = FindObj(x, y, 1e6)) && GetObjParam(pObj, 0,0,0) == CONTOUR_OBJ ){
   //проверим контур на замкнутость
   int close = ksIsCurveClosed(pObj);
   char buf[250];
   sprintf(buf, " контур %s", close ? "замкнут" : "разомкнут");
   Message(buf);
   info.prompt = "Укажите точку";
   do {
    //задать точку
    j = Cursor(&info, &x ,&y, 0);
    if (j) {
     //проверяем расположение точки
     int side = ksIsPointInsideContour(pObj, x, y, 0.001);
     sprintf(buf, " точка %s", side==1 ? "вне контура" : side==2 ? "на контуре" : "внутри конту"
ра");
     Message(buf);
    }
   } while(j);
