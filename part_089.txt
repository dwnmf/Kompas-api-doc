1 " треугольник,
2 " стрелка),

unsigned char tCorner число от 1 до 8, определяющее возможные 
положения точки выхода "опоры" из таблицы.,

reference pMathPoint динамический массив математических точек 
(POINT_oARR).

Примечания:
В динамический массив математических точек (POINT_ARR) не нужно помещать первый
узел "опоры" " точку на таблице (она определена параметром tCorner). Остальные узлы "
точки изломов "опоры" (они могут отсутствовать). Последний узел " конец опоры (указы"
вает на опорный объект).

ToleranceParam  Структура параметров 
обозначения допуска формы
Аналог данных параметров при использовании Automation " интерфейс
ksToleranceParam.
Замечание:
Структура устарела. Функции GetObjParam и SetObjParam с ней больше не работают.Ре"
комендуется использовать ksTolerancePar.

unsigned char tBase число от 1 до 8, определяющее 
возможные положения базовой 
точки,

unsigned short style стиль текста (0 " стиль по 
умолчанию),

double x, y координаты базовой точки,
unsigned char type ориентация таблицы допуска

(0 " горизонтально,
1" вертикально),

ToleranceBranch branch1 структура параметров первой "опоры",
ToleranceBranch branch2 структура параметров второй "опоры".

Структура параметров ToleranceBranch...
Примечания:
Чтобы вторая "опора" отсутствовала, ее параметр arrowType должен быть равен нулю.

ViewPointerParam  Структура параметров стрелки 
направления взгляда
Аналог данных параметров при использовании Automation " интерфейс
ksViewPointerParam.
4840



unsigned short style стиль текста
(0 " стиль по умолчанию),

double x1, y1 координаты вершины ("острия") 
стрелки,

double x2, y2 координаты конечной точки стрелки,
double xt, yt координаты точки привязки текста,
unsigned char type способ задания надписи на линии

(0 " текст в виде строки,
1 " динамический массив 
компонентов текста),

char str[50] текст на стрелке,
reference pTextItem динамический массив компонентов 

текста TEXT_ITEM_ARR.

Примечание.
При использовании Unicode следует использовать структуру параметров
ViewPointerParamW.

ViewPointerParamW  Структура параметров стрелки 
направления взгляда (Unicode)
Аналог данных параметров при использовании Automation " интерфейс
ksViewPointerParam.

unsigned short style стиль текста
(0 " стиль по умолчанию)

double x1, y1 координаты вершины ("острия") стрелки
double x2, y2 координаты конечной точки стрелки
double xt, yt координаты точки привязки текста
unsigned char type способ задания надписи на линии

(0 " текст в виде строки,
 1 " динамический массив компонентов текста)

wchar_t str[50] текст на стрелке
reference pTextItem динамический массив компонентов текста 

TEXT_ITEM_ARR

Примечание.
При использовании ANSI следует использовать структуру параметров ViewPointerParam.
4841



Структуры параметров спецификации
DocAttachedSpcParam  Структура параметров 
документа, подключенного к объекту спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksDocAttachedSpcParam.

char fileName [MAX_TEXT_LENGTH] имя файла подключенного 
документа,

char comment [MAX_TEXT_LENGTH] комментарий к подключенному 
документу,

unsigned char transmit признак передачи в документ 
изменений в объекте 
спецификации
(0 " не передавать в изменения в 
документ,
 1 " передавать в изменения в 
документ).

Примечание.
При использовании Unicode следует использовать структуру параметров
DocAttachedSpcParamW.

DocAttachedSpcParamW  Структура параметров 
документа, подключенного к объекту спецификации 
(Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksDocAttachedSpcParam.

wchar_t fileName [MAX_TEXT_LENGTH] имя файла подключенного 
документа,

wchar_t comment [MAX_TEXT_LENGTH] комментарий к подключенному 
документу,

unsigned char transmit признак передачи в документ 
изменений в объекте 
спецификации
(0 " не передавать в изменения в 
документ,
 1 " передавать в изменения в 
документ).

Примечание.
4842



При использовании ANSI следует использовать структуру параметров
DocAttachedSpcParam.

NumberTypeAttrParam  Структура числового 
значения в колонке спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksNumberTypeAttrParam.

double minValue минимальное значение в колонке спецификации,
double maxValue максимальное значение в колонке спецификации.

Примечание:
Данная структура заполняется для числовых типов значений в колонке спецификации
(SPC_DOUBLE и SPC_INT).

RecordTypeAttrParam  Структура записи в колонке 
спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksRecordTypeAttrParam.

char attrLibName [MAX_TEXT_LENGTH] имя файла библиотеки типов атрибутов,
int key1 значения ключей атрибутов, служащих 
int key2 шаблонами заполнения колонки 
int key3 спецификации в данном разделе.
int key4

Примечания:

1.  Данная структура заполняется, если тип значения в колонке спецификации " запись
(SPC_RECORD).

2.  Если значение какого"либо ключа 0, то этот ключ не учитывается.
3. При использовании Unicode следует использовать структуру параметров

RecordTypeAttrParamW.

RecordTypeAttrParamW  Структура записи в колонке 
спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksRecordTypeAttrParam.
4843



wchar_t attrLibName [MAX_TEXT_LENGTH] имя файла библиотеки 
типов атрибутов,

int key1 значения ключей атрибутов, 
int key2 служащих шаблонами 
int key3 заполнения колонки 
int key4

спецификации в данном 
разделе.

Примечания:

1.  Данная структура заполняется, если тип значения в колонке спецификации " запись
(SPC_RECORD).

2.  Если значение какого"либо ключа 0, то этот ключ не учитывается.
3. При использовании ANSI следует использовать структуру параметров

RecordTypeAttrParam. 

SpcColumnParam  Структура параметров колонки 
спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcColumnParam.

unsigned int columnType тип колонки,
unsigned int ispoln номер исполнения данного типа, 

начиная с 1,
unsigned int block номер блока,
unsigned int typeVal тип данных в колонке,
char name [TEXT_LENGTH] имя колонки.

Типы колонок спецификации...
Типы данных в колонках...
Примечание:

1.  Тип данных в колонках спецификации columnType может принимать значения:
SPC_CLM_FORMAT...SPC_CLM_USER.

2.  Тип колонки спецификации typeVal может принимать значения: INT_ATTR_TYPE,
DOUBLE_ATTR_TYPE, STRING_ATTR_TYPE и RECORD_ATTR_TYPE.

3.  При использовании Unicode следует использовать структуру параметров
SpcColumnParamW.
4844



SpcColumnParamW  Структура параметров колонки 
спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcColumnParam.

unsigned int columnType тип колонки,
unsigned int ispoln номер исполнения данного типа, начиная с 1,
unsigned int block номер блока,
unsigned int typeVal тип данных в колонке,
wchar_t name [TEXT_LENGTH] имя колонки.

Типы колонок спецификации...
Типы данных в колонках...
Примечание:

1.  Тип данных в колонках спецификации columnType может принимать значения:
SPC_CLM_FORMAT...SPC_CLM_USER.

2.  Тип колонки спецификации typeVal может принимать значения: LINT_ATTR_TYPE,
DOUBLE_ATTR_TYPE, STRING_ATTR_TYPE и RECORD_ATTR_TYPE.

3.  При использовании ANSI следует использовать структуру параметров SpcColumnParam.

SpcDescrParam  Структура параметров описания 
спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcDescrParam.

char layoutName [MAX_TEXT_LENGTH] имя файла библиотеки стилей,
unsigned int styleId номер стиля в библиотеке,
char spcName [MAX_TEXT_LENGTH] имя подключенного файла 

спецификации, имеющей 
данный стиль.

Примечание.
При использовании Unicode следует использовать структуру параметров
SpcDescrParamW.

SpcDescrParamW  Структура параметров описания 
спецификации (Unicode)
Аналог данных параметров при использовании Automation " интерфейс
ksSpcDescrParam.
4845



wchar_t layoutName [MAX_TEXT_LENGTH] имя файла библиотеки стилей,
unsigned int styleId номер стиля в библиотеке,
wchar_t spcName [MAX_TEXT_LENGTH] имя подключенного файла 

спецификации, имеющей 
данный стиль.

Примечание.
При использовании ANSI следует использовать структуру параметров SpcDescrParam.

SpcObjParam  Структура параметров объекта 
спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksSpcObjParam.

reference docArr документы, прикрепленные к объекту 
спецификации,

unsigned short typeObj тип строки спецификации,
unsigned short numbSection номер раздела, которому 

принадлежит объект,
unsigned short blockNumber номер блока исполнений (нумерация 

блоков начинается с нуля),
unsigned short numbSubSection номер подраздела, которому 

принадлежит объект,
char subSectionName имя подраздела, которому 

[MAX_TEXT_LENGTH] принадлежит объект,
unsigned char firstOnSheet признак принудительного разрыва 

страницы перед объектом (0 " 
разрыва нет,
 1 " объект располагается с начала 
страницы),

unsigned insFrgType признак объекта специфи"
char кации, пришедшего со

вставкой фрагмента
(0 " самостоятельный объ"
ект,
1 " объект из вставки фраг"
мента,
2 " объект из вставки фраг"
мента редактировался в
документ,
4846



unsigned char posInc признак возрастания позиции 
объекта
(0 " позиция совпадает с позицией 
предыдущего объекта,
1 " позиция возрастает),

unsigned char first признак уникальности текстовой 
части объекта
(1 " уникальный объект,
0 " объект имеет такую же текстовую 
часть, как ближайший 
расположенный над ним уникальный 
объект,

unsigned char draw признак отображения объекта в 
таблице
 (0 " объект не показывать,
 1 " объект показывать),

unsigned char posNotDraw признак отображения номера 
позиции объекта (0 " позицию 
показывать,
 1 " не показывать).

unsigned char ispoln признак объекта"исполнения
 (0 " объект не является исполнением
1 " объект является исполнением).

Структура параметров документов, прикрепленных к объекту DocAttachedSpcParamW...
Типы строк спецификации...
Примечания:

1.  В качестве параметра docArr используется динамический массив DOC_SPCOBJ_ARR, со"
держащий структуры параметров документов, прикрепленных к объекту спецификации
(DocAttachedSpcParam).

2.  Параметры numbSection, subSectionName, typeObj, insFrgType, first используются только
при чтении параметров функцией GetObjParam. Функцией SetObjParam установить зна"
чения этих параметров невозможно.

3.  Параметры first, draw, posNotDraw, ispoln используются только для базовых объектов
спецификации.

4.  Параметр blockNumber используется только для вспомогательных объектов специфика"
ции.

5.  Параметры docArr, numbSubSection, subSectionName, firstOnSheet, insFrgType и posInc
используются для базовых и вспомогательных объектов спецификации.

6.  При использовании Unicode следует использовать структуру параметров
SpcObjParamW.
4847



SpcObjParamW  Структура параметров объекта 
спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksSpcObjParam.

reference docArr документы, прикрепленные к 
объекту спецификации,

unsigned short typeObj тип строки спецификации,
unsigned short numbSection номер раздела, которому 

принадлежит объект,
unsigned short blockNumber номер блока исполнений 

(нумерация блоков начинается 
с нуля),

unsigned short numbSubSection номер подраздела, которому 
принадлежит объект,

wchar_t subSectionName имя подраздела, которому 
[MAX_TEXT_LENGTH] принадлежит объект,

unsigned char firstOnSheet признак принудительного 
разрыва страницы перед 
объектом (0 " разрыва нет,
1 " объект располагается с 
начала страницы),

unsigned char insFrgType признак объекта 
спецификации, пришедшего 
со вставкой фрагмента
(0 " самостоятельный объект,
1 " объект из вставки 
фрагмента,
2 " объект из вставки 
фрагмента редактировался в 
документ,

unsigned char posInc признак возрастания позиции 
объекта
(0 " позиция совпадает с 
позицией предыдущего 
объекта,
1 " позиция возрастает),

unsigned char first признак уникальности 
текстовой части объекта
 (1 " уникальный объект, 
0 " объект имеет такую же 
текстовую часть,  как 
ближайший расположенный 
над ним уникальный объект,
4848



unsigned char draw признак отображения объекта 
в таблице
(0 " объект не показывать,
1 " объект показывать),

unsigned char posNotDraw признак отображения номера 
позиции объекта (0 " позицию 
показывать,
1 " не показывать),

unsigned char ispoln признак объекта"исполнения
(0 " объект не является 
исполнением,
1 " объект является 
исполнением).

Структура параметров документов, прикрепленных к объекту DocAttachedSpcParamW...
Типы строк спецификации...
Примечания:

1.  В качестве параметра docArr используется динамический массив DOC_SPCOBJ_ARR, со"
держащий структуры параметров документов, прикрепленных к объекту спецификации
(DocAttachedSpcParam).

2.  Параметры numbSection, subSectionName, typeObj, insFrgType, first используются только
при чтении параметров функцией GetObjParam. Функцией SetObjParam установить зна"
чения этих параметров невозможно.

3.  Параметры first, draw, posNotDraw, ispoln используются только для базовых объектов
спецификации.

4.  Параметр blockNumber используется только для вспомогательных объектов специфика"
ции.

5.  Параметры docArr, numbSubSection, subSectionName, firstOnSheet, insFrgType и posInc
используются для базовых и вспомогательных объектов спецификации.

6.  При использовании ANSI следует использовать структуру параметров SpcObjParam.

SpcStyleParam  Структура параметров стиля 
спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksSpcStyleParam.

char layoutName1 имя файла библиотеки 
[MAX_TEXT_LENGTH] оформлений для первого листа 

спецификации,
char layoutName2 имя файла библиотеки 

[MAX_TEXT_LENGTH] оформлений для последующих 
листов спецификации,

unsigned int shtType1 номер оформления из библиотеки 
для первого листа спецификации,
4849



unsigned int shtType2 номер оформления из библиотеки 
для последующих листов 
спецификации,

unsigned char ispolnVariant вариант оформления 
спецификации
(0 " простая, 
1 " групповая, вариант А, 
 2 " групповая, вариант Б, 
 3 " групповая, вариант В,
 4 " групповая, вариант Г),

unsigned char sectionOn деление на разделы
(0 " выключено,
1" включено),

char rezerv[10] служебный параметр,
SpcTuningStyleParam tuning параметры умолчательных 

настроек спецификации,
reference arrColumn массив структур параметров 

колонок SpcStyleColumnParam,
reference arrAdditionalColumn массив структур параметров 

дополнительных колонок 
SpcStyleColumnParam,

reference arrSection массив структур параметров 
разделов спецификации 
SpcStyleSectionParam,

unsigned char type формат листа бумаги 
(0 " стандартный, 
 1 " пользовательский),

StandartSheet stPar параметры листа бумаги 
стандартного формата,

SheetSize usPar параметры листа бумаги 
пользовательского формата,

Примечания:

1.  Структура stPar заполняется, если параметр type равен 1, структура usPar заполняется,
если параметр type равен 0.

2.  В настоящее время параметр rezerv не используется.
3.  При использовании Unicode следует использовать структуру параметров

SpcStyleParamW.

SpcStyleParamW  Структура параметров стиля 
спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksSpcStyleParam.

wchar_t layoutName1 имя файла библиотеки оформлений 
[MAX_TEXT_LENGTH] для первого листа спецификации
4850



я 

я 

 

wchar_t layoutName2 имя файла библиотеки оформлений 
[MAX_TEXT_LENGTH] для последующих листов 

спецификации
unsigned int shtType1 номер оформления из библиотеки дл

первого листа спецификации
unsigned int shtType2 номер оформления из библиотеки дл

последующих листов спецификации
unsigned char ispolnVariant вариант оформления спецификации 

(0 " простая, 
 1 " групповая, вариант А, 
 2 " групповая, вариант Б, 
 3 " групповая, вариант В,
 4 " групповая, вариант Г)

unsigned char sectionOn деление на разделы
(0 " выключено,
 1" включено)

char rezerv[10] служебный параметр
SpcTuningStyleParamW tuning параметры умолчательных настроек 

спецификации
reference arrColumn массив структур 

параметров колонок 
SpcStyleColumnPara
m

reference arrAdditionalColumn массив структур 
параметров 
дополнительных 
колонок 
SpcStyleColumnPara
m

reference arrSection массив структур 
параметров 
разделов 
спецификации 
SpcStyleSectionPara
m

unsigned char type формат листа 
бумаги 
(0 " стандартный, 
 1 " 
пользовательский)

StandartSheet stPar параметры листа 
бумаги 
стандартного 
формата

SheetSize usPar параметры листа 
бумаги 
пользовательского 
формата

Примечания:
4851



1.  Структура stPar заполняется, если параметр type равен 1, структура usPar заполняется,
если параметр type равен 0.

2.  В настоящее время параметр rezerv не используется.
3.  При использовании ANSI следует использовать структуру параметров SpcStyleParam.

SpcStyleColumnParam  Структура параметров стиля 
колонки спецификаци
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcStyleColumnParam.

char nameColumn имя колонки,
[MAX_TEXT_LENGTH
]

unsigned int columnType тип колонки спецификации,
unsigned int ispoln номер колонки данного типа,
unsigned int typeVal тип значения в колонке,
unsigned char edit разрешение редактирования,

(1 " редактировать колонку в данном 
разделе, 
 0 " не редактировать колонку в данном 
разделе),

unsigned char createSum разрешение расчета суммы
(1 " рассчитывать сумму значений в 
колонке, 
0 " не рассчитывать сумму значений в 
колонке),

unsigned char multiplyToCount разрешение умножения при расчете 
суммы 
(1 " при расчете суммы умножать 
значения в колонке на количество, 
 0 " не умножать),

unsigned char useForSectionTitle признак размещения имен разделов
(1 " использовать колонку для показа 
имени раздела, 
0 " не использовать колонку для показа 
имени раздела)

unsigned char textDn признак размещения текста в колонке
(1 " выравнивать текст в колонке по 
нижней строке объекта специфИкации, 
 0 " выравнивать текст в колонке по 
верхней строке

char rezerv[10] служебный параметр
unsigned int linkId номер ячейки штампа для связи с данной 

колонкой
4852



RecordTypeAttrParam recordType параметры записи в колонке 
спецификации

NumberTypeAttrParam numberType параметры числового значения в колонке 
спецификации

Типы колонок спецификации...
Структура параметров записи в колонке спецификации RecordTypeAttrParam...
Структура параметров числового значения в колонке спецификации
NumberTypeAttrParam...
Типы данных в колонках...
Примечания:

1.  В качестве типа значения в колонке используются INT_ATTR_TYPE,
DOUBLE_ATTR_TYPE, STRING_ATTR_TYPE и RECORD_ATTR_TYPE.

2.  В настоящее время параметр rezerv не используется.
3.  Структура recordType заполняется, если тип значения в колонке " запись (SPC_RECORD).
4.  Структура numberType заполняется для числовых значений в колонке (SPC_DOUBLE и

SPC_INT).
5.  При использовании Unicode следует использовать структуру параметров

SpcStyleColumnParamW.

SpcStyleColumnParamW  Структура параметров 
стиля колонки спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcStyleColumnParam.

wchar_t nameColumn имя колонки
[MAX_TEXT_LENG
TH]

unsigned int columnType тип колонки спецификации
unsigned int ispoln номер колонки данного типа
unsigned int typeVal тип значения в колонке
unsigned char edit разрешение редактирования

(1 " редактировать колонку в данном 
разделе, 
 0 " не редактировать колонку в данном 
разделе)

unsigned char createSum разрешение расчета суммы
(1 " рассчитывать сумму значений в 
колонке, 
 0 " не рассчитывать сумму значений в 
колонке)
4853



unsigned char multiplyToCount разрешение умножения при расчете 
суммы 
(1 " при расчете суммы умножать 
значения в колонке на количество, 
 0 " не умножать)

unsigned char useForSectionTitle признак размещения имен разделов
(1 " использовать колонку для показа 
имени раздела, 
 0 " не использовать колонку для показа 
имени раздела)

unsigned char textDn признак размещения текста в колонке
(1 " выравнивать текст в колонке по 
нижней строке объекта спецификации, 
 0 " выравнивать текст в колонке по 
верхней строке

char rezerv[10] служебный параметр
unsigned int linkId номер ячейки штампа для связи с данной 

колонкой
RecordTypeAttrParam recordType параметры записи в колонке 

спецификации
NumberTypeAttrParam numberType параметры числового значения в колонке 

спецификации
Типы колонок спецификации...
Структура параметров записи в колонке спецификации RecordTypeAttrParamW...
Структура параметров числового значения в колонке спецификации
NumberTypeAttrParam...
Типы данных в колонках...
Примечания:

1.  В качестве типа значения в колонке используются INT_ATTR_TYPE,
DOUBLE_ATTR_TYPE, STRING_ATTR_TYPE и RECORD_ATTR_TYPE.

2.  В настоящее время параметр rezerv не используется.
3.  Структура recordType заполняется, если тип значения в колонке " запись (SPC_RECORD).
4.  Структура numberType заполняется для числовых значений в колонке (SPC_DOUBLE и

SPC_INT).
5.  При использовании ANSI следует использовать структуру параметров

SpcStyleColumnParam.

SpcStyleSectionParam  Структура параметров стиля 
раздела спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcStyleSectionParam.
4854



char sectionName [MAX_TEXT_LENGTH] имя раздела
unsigned short number номер раздела
unsigned int sortColumnType общий тип колонки, по данным в 

которой производится сортировка
unsigned int sortIspoln номер колонки, по данным в 

которой производится сортировка
unsigned char dataType способ ввода данных

(0 " ручное заполнение колонок,
 1 " ручное заполнение или чтение 
из основной надписи 
подключенного документа)

unsigned short sortType тип сортировки объектов в разделе
reference arrColumn массив структур параметров стиля 

колонок спецификации
reference arrAdditionalColumn массив структур параметров стиля  

дополнительных колонок 
спецификации

char rezerv[10] служебный параметр

Типы сортировки объектов в разделе спецификации...
Структура параметров стиля колонки спецификации SpcStyleColumnParam...
Примечание:

1.  В настоящее время параметр rezerv не используется.
2.  При использовании Unicode следует использовать структуру параметров

SpcStyleSectionParamW.

SpcStyleSectionParamW  Структура параметров 
стиля раздела спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcStyleSectionParam.

wchar_t sectionName имя раздела
[MAX_TEXT_LENGTH]

unsigned short number номер раздела
unsigned int sortColumnType общий тип колонки, по данным в которой 

производится сортировка
unsigned int sortIspoln номер колонки, по данным в которой 

производится сортировка
unsigned char dataType способ ввода данных

(0 " ручное заполнение колонок,
 1 " ручное заполнение или чтение из 
основной надписи подключенного 
документа)

unsigned short sortType тип сортировки объектов в разделе
4855



reference arrColumn массив структур параметров стиля колонок 
спецификации

reference arrAdditionalColumn массив структур параметров стиля  
дополнительных колонок спецификации

char rezerv[10] служебный параметр
Типы сортировки объектов в разделе спецификации...
Структура параметров стиля колонки спецификации SpcStyleColumnParamW...
Примечание:

1.  В настоящее время параметр rezerv не используется.
2.  При использовании ANSI следует использовать структуру параметров

SpcStyleSectionParam.

SpcSubSectionParam  Структура параметров 
подраздела спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcSubSectionParam.

char name [MAX_TEXT_LENGTH] имя подраздела,
unsigned short number номер подраздела.

Примечание.
При использовании Unicode следует использовать структуру параметров
SpcSubSectionParamW.

SpcSubSectionParamW  Структура параметров 
подраздела спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcSubSectionParam.

wchar_t name [MAX_TEXT_LENGTH] имя подраздела,
unsigned short number номер подраздела.

Примечание.
При использовании ANSI следует использовать структуру параметров
SpcSubSectionParam.
4856



SpcTuningSectionParam  Структура параметров 
настройки раздела спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcTuningSectionParam.

unsigned char subsectionOn признак деления на подразделы (1 " 
включено, 0 " выключено),

unsigned char geometryOn признак подключения геометрии к объектам 
раздела
(1 " разрешено подключение геометрии,
 0 " запрещено подключение геометрии),

unsigned char positionOn признак простановки позиций в разделе
(1 " позиции ставить,
0 " позиции не ставить),

unsigned char sortOn признак наличия сортировки объектов в 
разделе
(1 " сортировка включена,
 0 " сортировка выключена),

unsigned char firstOnSheet признак размещения раздела
(1 " начинать раздел с новой страницы, 
0 " начинать раздел после предыдущего 
раздела,

char rezerv[10] служебный параметр,
unsigned short rezervCount число резервных строк (и позиций) в 

разделе,
unsigned short number номер раздела,
reference arrSubSection массив структур параметров подразделов 

данного раздела.

Структура параметров подраздела SpcSubSectionParam...
Примечания:

1.  Параметр number предназначен только для чтения.
2.  В настоящее время параметр rezerv не используется.

SpcTuningStyleParam  Структура параметров 
настройки спецификации
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcTuningStyleParam.
4857



unsigned char grToSP связь сборочного чертежа со 
спецификацией 
(0 – нет связи,
 1 " только вставка объектов спецификации,
 2 " связь с расчетом позиций),

unsigned char zoneCalc расчет зон
(1 " рассчитывать зоны,
 0 " не рассчитывать зоны),

unsigned char showSectionName показ имен разделов
(1 " показывать имена разделов в таблице, 
0 " не показывать имена разделов),

unsigned char positionCalc расчет номеров позиций
(1 " позиции рассчитывать
 0 " позиции не рассчитывать),

unsigned char geometryDel признак удаления геометрии   удаленного 
объекта спецификации
(1 " удалять геометрию при удалении 
объекта спецификации,
 0 " не удалять геометрию),

unsigned char positionDel зарезервировано,
unsigned char massCalc зарезервировано,
unsigned char disableEmptyStr наличие пустых строк вокруг заголовка 

раздела
(1 " пустых строк нет,
 0 " пустые строки есть),

unsigned char insertNull префикс автоматически формируемого 
номера исполнения
(1 " вставлять нули перед числом,
0 " не вставлять нули перед числом),

unsigned char insertDash префикс автоматически формируемого 
номера исполнения
(1 " вставлять тире перед числом,
0 " не вставлять тире перед числом),

unsigned char disableEmptyBlockStr наличие пустых строк вокруг заголовка 
блока
(1 " пустых строк нет,
 0 " пустые строки есть),

unsigned char showInfoByDetBlock порядок представления информации
(0 " выдавать информацию блоками 
1" выдавать информацию по объектам),

unsigned char ispolnOn создание исполнений объектов в 
спецификации
(1 " разрешено,
 0 " запрещено),
4858



unsigned char ispolnMarkFull отображение номеров исполнений 
объектов
(1 " обозначение исполнения показывать 
полностью,
0 " показывать только номер исполнения),

unsigned char blocOnNewPage признак размещения блоков
(1 " начинать блоки с новой страницы,
 0 " начинать блоки после предыдущих),

unsigned char userTextStyle стиль текста объектов спецификации
(1 " пользовательский,
 0 " из стиля спецификации),

unsigned char countIspoln количество исполнений,
unsigned char countBlock количество блоков,
unsigned short countIspolnEx количество исполнений,
unsigned short countBlockEx количество блоков,
unsigned char delSpcObjOnDelGeometr удалять объекты спецификации при 

y удалении геометрии,
char rezerv[5] служебный параметр,
TextStyleParam sectionTextStyleFirst параметры стиля текста первой строки 

заголовков разделов,
TextStyleParam sectionTextStyleNext параметры стиля текста последующих 

строк заголовков разделов,
TextStyleParam objectTextStyle параметры стиля текста объектов 

спецификации,
char predefinedTextFileName имя файла предопределенных текстов, 

[MAX_TEXT_LENGTH] использующегося при заполнении 
спецификации,

reference arrSection массив структур параметров настроек 
разделов спецификации 
SpcTuningSectionParam,

copySpcObjOnCopyGeo копировать объекты спецификации при 
metry копировании геометрии

Примечания:

1.  Значение параметра showInfoByDetBlock учитывается, только если количество исполне"
ний больше, чем количество колонок, предназначенных для записи количества на ис"
полнение.

2.  В настоящее время параметр rezerv не используется.
3.  Параметры countIspoln и countBlock для совместимости заполняются для исполнений <=

255 и countIspolnEx == 0.
4.  При использовании Unicode следует использовать структуру параметров

SpcTuningStyleParamW.
4859



SpcTuningStyleParamW  Структура параметров 
настройки спецификации (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksSpcTuningStyleParam.

unsigned char grToSP связь сборочного чертежа со 
спецификацией 
(0 – нет связи,
 1 " только вставка объектов 
спецификации,
 2 " связь с расчетом позиций)

unsigned char zoneCalc расчет зон
(1 " рассчитывать зоны, 0 " не 
рассчитывать зоны)

unsigned char showSectionName показ имен разделов
(1 " показывать имена разделов в 
таблице, 
 0 " не показывать имена разделов)

unsigned char positionCalc расчет номеров позиций
(1 " позиции рассчитывать
 0 " позиции не рассчитывать)

unsigned char geometryDel признак удаления геометрии   
удаленного объекта спецификации
(1 " удалять геометрию при удалении 
 объекта спецификации, 0 " не 
удалять геометрию)

unsigned char positionDel зарезервировано
unsigned char massCalc зарезервировано
unsigned char disableEmptyStr наличие пустых строк вокруг 

заголовка раздела
(1 " пустых строк нет,
 0 " пустые строки есть)

unsigned char insertNull префикс автоматически 
формируемого номера исполнения
(1 " вставлять нули перед числом,
 0 " не вставлять нули перед числом)

unsigned char insertDash префикс автоматически 
формируемого номера исполнения
(1 " вставлять тире перед числом,
 0 " не вставлять тире перед числом)

unsigned char disableEmptyBlockStr наличие пустых строк вокруг 
заголовка блока
(1 " пустых строк нет,
 0 " пустые строки есть)
4860



unsigned char showInfoByDetBlock порядок представления информации
(0 " выдавать информацию блоками  
 1" выдавать информацию по 
объектам)

unsigned char ispolnOn создание исполнений объектов в 
спецификации
(1 " разрешено,
 0 " запрещено)

unsigned char ispolnMarkFull отображение номеров исполнений 
объектов
(1 " обозначение исполнения 
показывать полностью,
 0 " показывать только номер 
исполнения)

unsigned char blocOnNewPage признак размещения блоков
(1 " начинать блоки с новой 
страницы, 
 0 " начинать блоки после 
предыдущих)

unsigned char userTextStyle стиль текста объектов спецификации
(1 " пользовательский,
 0 " из стиля спецификации)

unsigned char countIspoln количество исполнений
unsigned char countBlock количество блоков
unsigned short countIspolnEx количество исполнений
unsigned short countBlockEx количество блоков
unsigned char delSpcObjOnDelGeometry удалять объекты спецификации при 

удалении геометрии
char rezerv[5] служебный параметр
TextStyleParamW sectionTextStyleFirst параметры стиля текста первой 

строки заголовков разделов
TextStyleParamW sectionTextStyleNext параметры стиля текста 

последующих строк заголовков 
разделов

TextStyleParamW objectTextStyle параметры стиля текста объектов 
спецификации

wchar_t predefinedTextFileName имя файла предопределенных 
[MAX_TEXT_LENGTH] текстов, использующегося при 

заполнении спецификации
reference arrSection массив структур параметров 

настроек разделов спецификации 
SpcTuningSectionParam

copySpcObjOnCopyGeometry копировать объекты спецификации 
при копировании геометрии

Примечания:
4861



1.  Значение параметра showInfoByDetBlock учитывается, только если количество исполне"
ний больше, чем количество колонок, предназначенных для записи количества на ис"
полнение.

2.  В настоящее время параметр rezerv не используется.
3.  Параметры countIspoln и countBlock для совместимости заполняются для исполнений <=

255 и countIspolnEx == 0.
4. . При использовании ANSI следует использовать структуру параметров

SpcTuningStyleParam.

Структуры параметров текста
ParagraphParam  Структура параметров параграфа
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksParagraphParam.

unsigned short style номер стиля текста (0 " стиль по умолчанию),
double x, y координаты точки привязки текста,
double ang угол наклона текста,
unsigned int hFormat признак горизонтального форматирования 

(0 " нет форматирования,
 1 " сужение текста,
 2 " перенос на другую строку),

unsigned int vFormat признак вертикального форматирования 
(0 " нет форматирования,
1"изменение шага строк),

double width ширина блока форматирования,
double height высота блока форматирования.

Системные стили текстов... 

TextDocumentParam  Структура параметров 
текстового документа
Справка системы КОМПАС...
1132_133_1_Obshchie_svedenija.htmАналог данных параметров при использова"
нии Automation " интерфейс ksTextDocumentParam.

unsigned char regim 0 " видимый режим,
1 " невидимый ре"
жим,

char fileName имя файла,
[MAX_TEXT_LENGT
H]
4862



char comment комментарий,
[TEXT_LENGTH

char author автор,
[TEXT_LENGTH]

LibraryStyleParam firstSheet оформление первого листа (имя 
библиотеки стилей, номер стиля 
в библиотеке),

LibraryStyleParam evenSheet оформление четных листов (имя 
библиотеки стилей, номер стиля 
в библиотеке),

LibraryStyleParam oddSheet оформление нечетных листов 
(имя библиотеки стилей, номер 
стиля в библиотеке),

reference arrTitleSheet динамический массив 
оформлений титульных листов 
LIBRARY_STYLE_ARR,

reference arrTailSheet динамический массив 
оформлений листов 
заключительной части 
LIBRARY_STYLE_ARR,

unsigned char type тип документа из DocType 
(lt_DocTxtStandart или 
lt_DocTxtUser),

struct StandartSheet stPar параметры стандартного 
формата, структура 
StandartSheet, не используется,

struct SheetSize usPar параметры нестандартного 
формата, структура SheetSize.

Примечание.
При использовании Unicode следует использовать структуру параметров
TextDocumentParamW.

TextDocumentParamW  Структура параметров 
текстового документа (Unicode)
Справка системы КОМПАС...
1132_133_1_Obshchie_svedenija.htmАналог данных параметров при использова"
нии Automation " интерфейс ksTextDocumentParam.

unsigned char regim 0 " видимый режим,
1 " невидимый режим,

wchar_t fileName имя файла,
[MAX_TEXT_LENGTH]

wchar_t comment комментарий,
[TEXT_LENGTH

wchar_t author автор,
[TEXT_LENGTH]
4863



LibraryStyleParamW firstSheet оформление первого листа (имя 
библиотеки стилей, номер стиля в 
библиотеке),

LibraryStyleParamW evenSheet оформление четных листов (имя 
библиотеки стилей, номер стиля в 
библиотеке),

LibraryStyleParamW oddSheet оформление нечетных листов (имя 
библиотеки стилей, номер стиля в 
библиотеке),

reference arrTitleSheet динамический массив оформлений 
титульных листов 
LIBRARY_STYLE_ARR,

reference arrTailSheet динамический массив оформлений 
листов заключительной части 
LIBRARY_STYLE_ARR,

unsigned char type тип документа из DocType 
(lt_DocTxtStandart или lt_DocTxtUser),

struct StandartSheet stPar параметры стандартного формата, 
структура StandartSheet, multiply не 
используется,

struct SheetSize usPar параметры нестандартного формата, 
структура SheetSize.

Примечание.
При использовании ANSI следует использовать структуру параметров
TextDocumentParam.

TextLineParam  Структура параметров строки текста
Аналог данных параметров при использовании Automation " интерфейс ksTextLineParam.

unsigned short style номер стиля строки текста
(0 " стиль по умолчанию),

reference pTextItem указатель на динамический массив 
компонент строки текста 
TEXT_ITEM_ARR.

Системные стили текстов... 

TextItemFont  Структура параметров шрифта 
компоненты строки текста
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksTextItemFont.
4864



char fontName имя шрифта,
[MAX_TEXT_LENGT
H]

double height высота шрифта (в миллиметрах),
double ksu коэффициент сужения символов,
unsigned long color цвет символов,
unsigned int bitVector битовый вектор, определяющий начертание 

символов (наклон, толщину, подчеркивание, 
тип составной части " дробь, отклонение и 
т.д.).

Примечание.
При использовании Unicode следует использовать структуру параметров TextItemFontW.

TextItemFontW  Структура параметров шрифта 
компоненты строки текста (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksTextItemFont.

wchar_t fontName имя шрифта,
[MAX_TEXT_LENGTH]

double height высота шрифта (в миллиметрах),
double ksu коэффициент сужения символов,
unsigned long color цвет символов,
unsigned int bitVector битовый вектор, определяющий начертание 

символов (наклон, толщину, подчеркивание, 
тип составной части " дробь, отклонение и 
т.д.).

Примечание.
При использовании ANSI следует использовать структуру параметров TextItemFont.

TextItemParam  Структура параметров компоненты 
строки текста
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksTextItemParam.

int tip SPECIAL_SYMBOL 
или FONT_SYMBOL 
или FRACTION_TYPE
или SUM_TYPE 
или 0,

TextItemFont font параметры шрифта компоненты строки текста,
char s [TEXT_LENGTH] массив символов компоненты строки текста,
4865



unsigned int iSNumb номер спецсимвола,
или символа из произвольного шрифта,
или тип отрисовки дроби,
или выражения типа суммы,
или 0.

Структура параметров TextItemFont...Примечание.

1.  Таблица спецсимволов размещена в файле SDK\NumbSymb.frw.
2.  При использовании Unicode следует использовать структуру параметров

TextItemParamW.

TextItemParamW  Структура параметров 
компоненты строки текста (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksTextItemParam.

int tip SPECIAL_SYMBOL 
или FONT_SYMBOL,
или FRACTION_TYPE,
или SUM_TYPE,
или 0.

TextItemFont font параметры шрифта компоненты строки текста,
wchar_t s [TEXT_LENGTH] массив символов компоненты строки текста,
unsigned int iSNumb номер спецсимвола 

или символа из произвольного шрифта 
или тип отрисовки дроби, 
или выражения типа суммы,
или 0.

Структура параметров TextItemFontW...Примечание.

1.  Таблица спецсимволов размещена в файле SDK\NumbSymb.frw.
2.  При использовании ANSI следует использовать структуру параметров TextItemParam.

TextParam  Структура параметров текста
Аналог данных параметров при использовании Automation " интерфейс ksTextParam.

ParagraphParam par параметры параграфа,
reference pTextLine указатель на динамический массив строк текста 

TEXT_LINE_ARR.

Структура параметров ParagraphParam...
4866



TextStyleParam  Структура параметров стиля текста
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksTextStyleParam.

char name [TEXT_LENGTH] имя стиля,
double height высота текста шрифта,
double ksu коэффициент сужения символов,
double step шаг строк,
char fontName [TEXT_LENGTH] имя шрифта,
unsigned long color цвет,
unsigned char align выравнивание (0 " влево, 1 " по центру, 2 " 

вправо, 3 " на всю ширину,
unsigned char bold начертание символов (0 " не утолщенные, 1 

" утолщенные),
unsigned char italic начертание символов (0 " без наклона, 1 " с 

наклоном),
unsigned char underline подчеркивание (0 " без подчеркивания, 1 " с 

подчеркиванием),
double posKS отступ красной строки (в миллиметрах)
double stepParPre интервал перед текстом,
double stepParPst интервал после текста,
double leftEdge отступ текста слева,
double rightEdge отступ текста справа.

Примечание.
При использовании Unicode следует использовать структуру параметров
TextStyleParamW.

TextStyleParamW  Структура параметров стиля 
текста (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksTextStyleParam.

wchar_t name [TEXT_LENGTH] имя стиля,
double height высота текста шрифта,
double ksu коэффициент сужения символов,
double step шаг строк,
wchar_t fontName [TEXT_LENGTH] имя шрифта,
unsigned long color цвет,
unsigned char align выравнивание (0 " влево, 1 " по центру, 2 " 

вправо, 3 " на всю ширину,
unsigned char bold начертание символов (0 " не утолщенные, 1 

" утолщенные),
unsigned char italic начертание символов (0 " без наклона, 1 " с 

наклоном),
4867



unsigned char underline подчеркивание (0 " без подчеркивания, 1 " с 
подчеркиванием),

double posKS отступ красной строки (в миллиметрах),
double stepParPre интервал перед текстом,
double stepParPst интервал после текста,
double leftEdge отступ текста слева,
double rightEdge отступ текста справа.

Примечание.
При использовании ANSI следует использовать структуру параметров TextStyleParam.

Структуры параметров событий
NotifyConnectionParam  Структура параметров для 
осуществления подписки, отписки событий в COM

reference pContainer " указатель на объект КОМПАС, 
контейнер событий. Для приложения 
0. Для документа указатель 
документа.

long objType Дополнительный параметр. Либо тип 
объекта, либо указатель на объект 
(для ksObject2DNotify).

int ifType Тип интерфейсов событий 
ksNotifyTypeEnum.

LPUNKNOWN iContainer Указатель на объект КОМПАС, 
контейнер сообщений.

LPUNKNOWN iObj Дополнительный параметр. Указатель 
на объект (для ksObject3DNotify).

Структуры параметров измерений
InertiaParam  Структура параметров для расчета 
МЦХ плоской фигуры
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksInertiaParam.

double xc, yc координаты центра тяжести фигуры
double f площадь
double ly, lx моменты инерции относительно исходных осей x и y
double lxy центробежный момент инерции относительно 

исходных осей x и y
double my, mx моменты инерции относительно осей, параллельных 

осям x и y и проходящих через центр тяжести
4868



, 
ы 

ы 
double mxy центробежный момент инерции относительно осей, 
параллельных осям x и y и проходящих через центр 
тяжести

double jy, jx главные центральные моменты инерции
double a угол между первой главной осью и осью x

MassInertiaParam  Структура параметров для 
расчета МЦХ тел вращения и выдавливания
Справка системы КОМПАС...
CM_MEASURE_MIX3D.htm
Аналог данных параметров при использовании Automation " интерфейс
ksMassInertiaParam.

double r плотность материала,
double m масса тела,
double v объем тела,
double xc, yc, zc координаты центра тяжести,
double lxy, lxz, lyz центробежные моменты инерции в глобальной 

(исходной) системе координат,
double lx, ly, lz осевые моменты инерции в глобальной (исходной) 

системе координат,
double jy0z, jx0z, jx0y плоскостные моменты инерции,
double jxy, jxz, jyz центробежные моменты инерции в центральной 

системе координат (с началом в центре масс и осями
параллельными осям глобальной (исходной) систем
координат),

double jx, jy, jz осевые моменты инерции в центральной системе 
координат (с началом в центре масс и осями, 
параллельными осям глобальной (исходной) систем
координат).

Структуры параметров библиотек
InsertFragmentParamEx  Структура параметров 
вставки фрагмента (расширенная)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksInsertFragmentParam.

PlacementPara place положение вставки фрагмента 
m (PlacementParam),
unsigned char insertType тип вставки фрагмента

(0 " взять в документ,
 1 " внешней ссылкой,
 3 " локальный фрагмент),
4869



unsigned char multiLayer признак размещения объектов фрагмента по 
слоям
(0 " объекты на одном слое,
 1 " объекты на разных слоях),

char fileName имя файла фрагмента или "\0" для локального 
[MAX_TEXT_LENGTH] фрагмента,

char comment имя вставки,
[MAX_TEXT_LENGTH]

unsigned char scaleProjLinesSize признак масштабирования длины выносных 
линий размеров:
(1 " выносные линии масштабируются,
0 " выносные линии не масштабируются).

Примечание.
При использовании Unicode следует использовать структуру параметров
InsertFragmentParamExW.

InsertFragmentParamExW  Структура параметров 
вставки фрагмента (расширенная), Unicode
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс 
".

PlacementParam place положение вставки фрагмента 
(PlacementParam)

unsigned char insertType тип вставки фрагмента
(0 " взять в документ,
 1 " внешней ссылкой,
 3 " локальный фрагмент)

unsigned char multiLayer признак размещения объектов фрагмента 
по слоям
(0 " объекты на одном слое,
 1 " объекты на разных слоях)

wchar_t fileName имя файла фрагмента или "\0" для 
[MAX_TEXT_LENGTH] локального фрагмента

wchar_t comment имя вставки
[MAX_TEXT_LENGTH]

unsigned char scaleProjLinesSize признак масштабирования длины 
выносных линий размеров:
(1 " выносные линии масштабируются,
 0 " выносные линии не масштабируются)

Примечание.
При использовании ANSI следует использовать структуру параметров
InsertFragmentParamEx.
4870



LibStyle  Структура параметров для подключения 
стиля из библиотеки
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksLibStyle.

char fileName [MAX_TEXT_LENGTH] имя файла библиотеки,
int styleNumber номер стиля в библиотеке,
unsigned char typeAllocation тип размещения стиля в 

документе 
(0 " телом;
1 " ссылкой на библиотеку).

Примечание.
При использовании Unicode следует использовать структуру параметров LibStyleW.

LibStyleW  Структура параметров для подключения 
стиля из библиотеки (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс ksLibStyle.

wchar_t fileName [MAX_TEXT_LENGTH] имя файла библиотеки,
int styleNumber номер стиля в библиотеке,
unsigned char typeAllocation тип размещения стиля в документе 

(0 " телом; 1 " ссылкой на библиотеку)

Примечание.
При использовании ANSI следует использовать структуру параметров LibStyle.

LibToolbarSettings  Структура параметров панели 
команд библиотеки

 unsigned char defaultVisible  0 погашена, по умолчанию,
VARIANT docsType константа из перечислений 

DocumentTypeEnum и 
ksSlaveDocumentTypeEnum.

LibraryStyleParam  Структура параметров стиля в 
библиотеке стилей
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksLibraryStyleParam.
4871



char styleName имя стиля,
[MAX_TEXT_LENGTH]

unsigned int styleId номер стиля в библиотеке.

Примечание.
При использовании Unicode следует использовать структуру параметров
LibraryStyleParamW.

LibraryStyleParamW  Структура параметров стиля в 
библиотеке стилей (Unicode)
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksLibraryStyleParam.

wchar_t styleName [MAX_TEXT_LENGTH] имя стиля,
unsigned int styleId номер стиля в библиотеке.

Примечание.
При использовании ANSI следует использовать структуру параметров LibraryStyleParam.

TreeNodeParam  Структура параметров узла дерева 
библиотеки документов, библиотеки атрибутов
Аналог данных параметров при использовании Automation " интерфейс
ksTreeNodeParam.

long type " тип узла: корень, папка, файл 
(из LtNodeType ),

char name [MAX_TEXT_LENGTH] " имя узла,
reference comment " комментарий " динамический 

массив CHAR_STR_ARR 
(динамический массив строк 
символов),

reference nodes " динамический массив узлов 
TreeNodeParam.

Примечание.
При использовании Unicode следует использовать структуру параметров
TreeNodeParamW.
4872



TreeNodeParamW  Структура параметров узла 
дерева библиотеки документов, библиотеки 
атрибутов (Unicode)
Аналог данных параметров при использовании Automation " интерфейс
ksTreeNodeParam.

long type " тип узла: корень, папка, файл 
(из LtNodeType),

wchar_t name [MAX_TEXT_LENGTH] " имя узла,
reference comment " комментарий " динамический 

массив CHAR_STR_ARR 
(динамический массив строк 
символов),

reference nodes " динамический массив узлов.
Примечание.
При использовании ANSI следует использовать структуру параметров TreeNodeParam.

Структуры параметров системы 
ConstraintParam  Структура параметрических 
связей и ограничений
Справка системы КОМПАС...
Аналог данных параметров при использовании Automation " интерфейс
ksConstraintParam.

unsigned short constrType тип параметрического ограничения,
int index индекс точки на объекте (нумерация 

начинается с 0, у дуги и окружности 0 " центр),
reference partner указатель на второй объект, участвующий в 

параметрической связи,
int partnerIndex индекс точки на втором объекте (нумерация 

начинается с 0, у дуги и окружности 0 " центр).

Типы параметрических ограничений... 

LtVariant  Структура параметров для хранения 
данных некоторого типа.
Аналог данных параметров при использовании Automation " интерфейс ksLtVariant.

LtVariantType vType тип хранимых данных,
short colVisible для спецификации:

1 " видимая колонка, 
0 " невидимая колонка,
4873



short sortKey ключ сортировки для колонки 
спецификации (0 " сортировки 
нет),

short wReserved3 параметр зарезервирован для 
дальнейшего использования,

char chVal символ, ltv_Char 1
unsigned char ucVal байт, ltv_Uchar 2
int iVal целое число, ltv_Int 3
unsigned int uiVal беззнаковое целое число, ltv_Uint 4
long lVal длинное целое число, ltv_Long 5
float fVal вещественное число, ltv_Float 6
double dVal двойное число, ltv_Double 7
char strVal строка, ltv_Str 8

[MAX_TEXT_LENGTH
]

short shVal короткое целое число. ltv_Short 10
Примечание.
При использовании Unicode следует использовать структуру параметров LtVariantEx.

LtVariantExСтруктура параметров для хранения 
данных некоторого типа (Unicode)
Аналог данных параметров при использовании Automation " интерфейс ksLtVariant.

LtVariantType vType тип хранимых данных,
short colVisible для спецификации:

1 " видимая колонка, 
0 " невидимая колонка,

short sortKey ключ сортировки для 
колонки спецификации (0 
" сортировки нет),

short wReserved3 параметр зарезервирован 
для дальнейшего 
использования,

union
char chVal символ, ltv_Char 1
unsigned char ucVal байт, ltv_Uchar 2
int iVal целое число, ltv_Int 3
unsigned int uiVal беззнаковое целое число, ltv_Uint 4
long lVal длинное целое число, ltv_Long 5
float fVal вещественное число, ltv_Float 6
double dVal двойное число, ltv_Double 7
wchar_t strVal строка, ltv_Str 8

[MAX_TEXT_LENGTH
]

short shVal короткое целое число. ltv_Short 10
wchar_t wstrVal[MAX_TEXT_L строка ltv_WStr 11

ENGTH]

Примечание.
4874



При использовании ANSI следует использовать структуру параметров LtVariant.

RequestInfo  Структура параметров запроса к 
системе
Аналог данных параметров при использовании Automation " интерфейс ksRequestInfo.

char *title строка или идентификатор строки заголовка 
окна,

char *commands строка или идентификатор меню состава 
команд,

char *prompt строка или идентификатор приглашения,
char *cursor строка с именем или идентификатор 

стандартного курсора,
void *callBack указатель на функцию обратной связи,
int dynamic признак динамического запроса (1 " 

динамический запрос, 0 " статический),
HINSTANCE commInstance идентификатор модуля, в котором размещен 

состав команд.
Примечание:

1. Эта структура используется в функциях Cursor, Placement, CommandWindow.
2. В случае динамического запроса функция обратной связи вызывается по перемещению

курсора. В случае статического запроса функция обратной связи вызывается по щелчку
мыши.

3. Кроме стандартных констант из WINUSER.H можно использовать стандартные курсоры
системы КОМПАС (ldefin2d.h):
OCR_SELECT
OCR_SNAP
OCR_DEFAULT
OCR_CATCH

RequestInfoW  Структура параметров запроса к 
системе (Unicode)
Аналог данных параметров при использовании Automation " интерфейс ksRequestInfo.

wchar_t *title строка или идентификатор строки заголовка 
окна,

wchar_t *commands строка или идентификатор меню состава 
команд,

wchar_t *prompt строка или идентификатор приглашения,
wchar_t *cursor строка с именем или идентификатор 

стандартного курсора,
void *callBack указатель на функцию обратной связи,
4875



int dynamic признак динамического запроса (1 " 
динамический запрос, 
0 " статический),

HINSTANCE commInstance идентификатор модуля, в котором размещен 
состав команд.

Примечание:

1. Эта структура используется в функциях Cursor, Placement, CommandWindow.
2. В случае динамического запроса функция обратной связи вызывается по перемещению

курсора. В случае статического запроса функция обратной связи вызывается по щелчку
мыши.

3. Кроме стандартных констант из WINUSER.H можно использовать стандартные курсоры
системы КОМПАС (ldefin2d.h):
OCR_SELECT
OCR_SNAP
OCR_DEFAULT
OCR_CATCH

VariableParam  Структура параметров 
параметрической переменной

char name [MAX_TEXT_LENGTH] имя переменной,
double value значение переменной,
char note [MAX_TEXT_LENGTH] комментарий.

Примечание.
При использовании Unicode следует использовать структуру параметров
VariableParamW.

VariableParamW  Структура параметров 
параметрической переменной (Unicode)

wchar_t name [MAX_TEXT_LENGTH] имя переменной,
double value значение переменной,
wchar_t note [MAX_TEXT_LENGTH] комментарий.

Примечание.
При использовании ANSI следует использовать структуру параметров VariableParam.
4876



Структуры параметров окна Свойства
PropertyParam  Структура параметров свойства 
отображаемого в окне свойств

 int propertyType Тип свойства из перечисления 
ksObjectPropertyControlTypeEnum,

int propertyId; Идентификатор свойства " используется для 
загрузки имени и параметров свойства из 
ресурсов,

HINSTANCE propertyInstance; Модуль ресурсов для загрузки параметров 
свойства (имя, список значений...),

LPOLESTR displayPropertyName; Отображаемое имя свойства 
(необязательное),

VARIANT propertyValue; Текущее значение,
double propertyMinValue; Минимальное значение,
double propertyMaxValue; Максимальное значение,
int isDefCpyProp; Будет отмечено для копирования,
int enable; Признак доступности для изменения,
int emptyValue; Значение не задано,
VARIANT additionalData; Дополнительные данные для свойства,
LPOLESTR additionalText; Дополнительный текст,
int summList; TRUE " объединять списки, FALSE " пересекать 

списки.

Примечание:
Поля propertyType, propertyId и propertyInstance являются обязательными для заполне"
ния. Остальные поля заполняются в зависимости от типа контрола.

Константы
Перечисления событий
ksDocument2DNotifyEnum  События графического 
документа

d2BeginRebuild 1 Начало перестроения модели
d2Rebuild 2 Модель перестроена
d2BeginChoiceMaterial 3 Начало выбора материала
d2СhoiceMaterial 4 Закончен выбор материала
d2BeginInsertFragment 5 Начало вставки фрагмента (до диалога 

выбора имени)
d2LocalFragmentEdit 6 Редактирование локального фрагмента
d2BeginChoiceProperty 7 Начало выбора свойства
d2ChoiceProperty 8 Закончен выбор свойства
4877



ksDocument3DNotifyEnum  События документа
модели

d3BeginRebuild 1 Начало перестроения модели
d3Rebuild 2 Модель перестроена
d3BeginChoiceMaterial 3 Начало выбора материала
d3СhoiceMaterial 4 Закончен выбор материала
d3BeginChoiceMarking 5 Начало выбора обозначения
d3ChoiceMarking 6 Закончен выбор обозначения
d3BeginSetPartFromFile 7 Начало установки компонента в 

сборку (до диалога выбора 
имени)

d3BeginCreatePartFromFile 8 Начало создания компонента в 
сборке (до диалога выбора 
имени)

d3BeginChoiceProperty 12 Начало выбора свойства
d3ChoiceProperty 13 Закончен выбор свойства
d3BeginRollbackFeatures 14 Начало отката дерева модели
d3RollbackFeatures 15 Завершение отката дерева 

модели
d3BedinLoadCombinationChange 16 Начало переключения типа 

загрузки
d3LoadCombinationChange 17 Завершение переключения типа 

загрузки

ksDocumentFileNotifyEnum  События для 
документов; работа с файлом

kdBeginCloseDocument 1 " начало закрытия документа
kdCloseDocument 2 " документ закрыт
kdBeginSaveDocument 3 " начало сохранения документа
kdSaveDocument 4 " документ сохранен
kdActiveDocument 5 " документ активизировался
kdDeactiveDocument 6 " документ деактивизировался
kdBeginSaveAsDocument 7 " начало сохранения документа c 

другим именем (до диалога 
выбора имени)

kdDocumentFrameOpen 8 " окно документа открылось
kdProcessActivate 9 " процесс активизирован
kdProcessDeactivate 10 " процесс деактивизирован
kdBeginProcess 11 " начало процесса
kdEndProcess 12 " завершение процесса
kdBeginAutoSaveDocument 13 " начало автосохранения 

документа
kdAutoSaveDocument 14 " Документ автосохранен
4878



ksKompasObjectNotifyEnum  События приложения

koCreateDocument 1 " документ создан
koBeginOpenDocumen 2 " начало открытия документа
koOpenDocumen 3 " документ открыт,
koChangeActiveDocument 4 " переключение на другой 

активный документ
koApplicatinDestroy 5 " закрытие приложения.
koBeginCreate 6 " начало создания документа (до 

диалога выбора типа)
koBeginOpenFile 7 " начало открытия документа (до 

диалога выбора имени)
koBeginCloseAllDocument 8 " начало закрытия всех открытых 

документов
koKeyDown 9 " событие нажатия клавиатуры. 

клавиша нажата.
koKeyUp 10 " событие нажатия клавиатуры. 

клавиша отпущена
koKeyPress 11 " событие нажатия клавиатуры. 

клавиша нажата
koIsNeedConvertToSavePrevious 15 Начало сохранения документа в 

предыдущую верcию
koBeginConvertToSavePrevious 16 Начало конвертации документа 

перед записью в предыдущую 
верию

koEndConvertToSavePrevious 17 Завершение конвертации 
документа перед записью в 
предыдущую верcию

koChangeTheme 18 Изменение темы

ksLayoutSheetsNotifyEnum  События для листов 
оформления

ksLayoutAdd 1 Добавлен лист
ksLayoutDelete 2 Удален лист оформления
ksLayoutUpdate 3 Изменены параметры ли"

ста оформления

ksLibraryManagerNotifyEnum  События для 
менеджера библиотек

ksLMBeginAttach 1 Подключить библиотеку
ksLMAttach 2 Библиотека подключена
ksLMBeginDetach 3 Отключить библиотеку
ksLMDetach 4 Библиотека отключена
ksLMBeginExecute 5 Запуск выполнения команды 

библиотеки
4879



ksLMEndExecute 6 Завершение выполнения команды 
библиотеки

ksLMSystemControlStop 7 Передача управления библиотеке
ksLMSystemControlStart 8 Передача управления системе
ksLMAddLibraryDescription 9 Добавлено описание библиотеки
ksLMDeleteLibraryDescription 10 Удалено описание библиотеки
ksLMAddInsert 11 Добавлен документ в библиотеку 

документов
ksLMDeleteInsert 12 Удален документ из библиотеки 

документов
ksLMEditInsert 13 Редактирование документа из 

библиотеки документов
ksLMTryExecute 14 Попытка вызвать команду 

библиотеки
ksLMBeginInsertDocument 15 Запуск вставки документа из 

библиотеки

ksNotifyTypeEnum  Перечень интерфейсов событий

ntKompasObjectNotify 1 События приложения
ntDocumentFileNotify 2 События документа, работа с файлом
ntStampNotify 3 События основной надписи
ntObject2DNotify 4 События объекта графического документа
ntSelectionMngNotify 5 События менеджера выделенных объектов
ntSpcObjectNotify 6 События объекта спецификации
ntSpcDocumentNotify 7 События документа"спецификации
ntSpecificationNotify 8 События спецификации
ntDocument3DNotify 9 События документа"модели
ntObject3DNotify 10 События объекта документа"модели
ntDocument2DNotify 11 События графического документа
ntPropertyManagerNotify 12 События для Панели свойств
ntPropertyUserControlNotifyEnum 13 События пользовательского элемента управления
ntDocumentFrameNotify 14 События для окна документа
ntViewsAndLayersManagerNotify 15 События для менеджера видов и слоев
ntLibraryManagerNotify 16 События для менеджера библиотек
ntProcess2DNotify 18 События процесса 2D
ntProcess3DNotify 19 События процесса 3D
ntContentDialogNotify 20 События диалога с внешним наполнением
ntFindObjectParametersNotify 21 События функции поиска объектов под курсором
ntProcess3DManipulatorsNotify 22 События манипуляторов процесса 3D
ntPLMObjectNotify 23 События объектов версионирования

ksObject2DNotifyEnum  События объектов 
графических документов

koChangeActive 1 переключение активности объекта( вид, 
слой)

koBeginDelete 2 начало удаления объекта
koDelete 3 объект удален
4880



koBeginMove 4 начало сдвига объекта
koMove 5 завершение сдвига объекта,
koBeginRotate 6 начало поворота объекта
koRotate 7 завершение поворота объекта
koBeginScale 8 начало масштабирования объекта
koScale 9 завершение масштабирования объекта
koBeginTransform 10 начало трансформации объекта
koTransform 11 завершение трансформации объекта
koBeginCopy 12 начало копирования объекта,
koCopy 13 завершение копирования объекта
koBeginSymmetry 14 начало симметричного преобразования 

объекта
koSymmetry 15 завершение симметричного 

преобразования объекта
koBeginProcess 16 начало редактирования\создания 

объекта
koEndProcess 17 завершение редактирования\создания 

объекта
koCreateObject 18 создание объекта
koUpdateObject 19 редактирование объекта
koBeginDestroyObj 20 начало разрушения объекта
ect
koDestroyObject 21 разрушение объекта
koBeginPropertyCh 22 начало изменения свойств объекта
anged
koPropertyChange 23 изменены свойства объекта
d

ksObject3DNotifyEnum  События объектов 
документамодели

o3BeginDelete 1 Начало удаления объектов
o3Delete 2 Oбъекты удалены
o3Excluded 3 Oбъект исключен/включен в 

расчет
o3Hidden 4 Oбъект скрыт/показан
o3BeginPropertyChanged 5 Начало изменения свойств 

объекта
o3PropertyChanged 6 Изменены свойства объекта
o3BeginPlacementChanged 7 Начало изменения положения 

объекта
o3PlacementChanged 8 Начало изменения положения 

объекта
o3BeginProcess 9 Начало
o3EndProcess 10 Конец редактирования\создания 

объекта
o3CreateObject 11 Создание объекта
o3UpdateObject 12 Редактирование объекта
o3BeginLoadStateChange 13 Начало изменения типа загрузки
o3LoadStateChange 14 Завершение изменения типа 

загрузки
4881



ksProcess2DTypeEnum  Типы процессов 2D

ksProcess2DCursor 1 " запрос на получение точки
ksProcess2DPlacement 2 " запрос на получение точки и угла

ksProcess3DTypeEnum  Типы процессов 3D

ksProcess3DPlacementAndEntity 1 " запрос на указание местоположения и 
объекта

ksProcess3DSelectEntity 2 " запрос на выбор объекта

ksProcess2DNotifyEnum  События процесса 2D

ksProcess2DPlacementChanged 1 " изменение положения 
 ksProcess2DExecuteCommand 2 " выполнить команду меню
ksProcess2DRun 3 " запуск процесса 
ksProcess2DStop 4 " остановка процесса 
ksProcess2DActivate 5 " активизация процесса 
ksProcess2DDeactivate 6 " деактивизация процесса 
ksProcess2DEndProcess 7 " окончание процесса 
ksProcess2DMouseEnterLeavePara 8 " запрос параметров точек для визуального 
m определения места применения параметра

ksProcess3DNotifyEnum  События процесса 3D

ksProcess3DPlacementChanged 1 " изменение положения
ksProcess3DExecuteCommand 2 " выполнить команду меню
ksProcess3DRun 3 " запуск процесса
ksProcess3DStop 4 " остановка процесса
ksProcess3DActivate 5 " активизация процесса
ksProcess3DDeactivate 6 " деактивизация процесса
ksProcess3DFilterObjects 7 " фильтрация объектов
ksProcess3DCreateTakeObject 8 " событие создания объекта в " " " 

подчиненном режиме
ksProcess3DEndProcess 9 " окончание процесса
ksProcess3DProcessingGroupObje 10 " обработать объекты, пришедшие при 
cts селектировании рамкой
4882



ksTwinSwitcherValueEnum  Значения 
переключателя

ksTwinSwitcherPos1 1 " положение 1
ksTwinSwitcherPos2 2 " положение 2

ksToleranceArrowType  Тип стрелки ответвления у 
допуска формы

ksTANone 0 " нет
ksTAArrow 1 " стрелка
ksksTATriangle 2 " треугольник

ksEnterButtonIconTypeEnum  Тип иконки для кнопки 
Cоздать

ksEnterCheckIcon 0 Обычная кнопка. Создать в виде галочки
ksEnterFloppyIcon 1 Дискета
ksEnterNewInputIcon 2 Новый ввод
ksEnterApplyIcon 3 Применить

ksShowHideTmpObjTypeEnum  Тип отображения 
временного объекта в документе

ksTmpObjHide 0 " объект скрыт
ksTmpObjShow 1 " объект отображается как обычный 

объект
ksTmpObjShowPhantom 2 " объект отображается как фантом

ksSelectionMngNotifyEnum  События менеджера 
выделенных объектов

ksmSelect 1 " объект выделен
ksmUnselect 2 " снято выделение с объекта
ksmUnselectAll 3 " снято выделение со всех объектов
4883



ksStampNotifyEnum  События основной надписи 
графических документов (штампа)

kdBeginEditStamp 1 Начало работы со штампом
kdEndEditStamp 2 Завершение работы со штампом
kdStampCellDblClick 3 Двойной щелчок мышью в ячейке штампа
kdStampCellBeginEdit 4 Начало редактирования в ячейке штампа
kdStampBeginClearCells 5 Начало очистки ячеек штампа

ksSpcDocumentNotifyEnum  События документа
спецификации

sdDocumentBeginAdd 1 Начало добавления документа сборочного 
чертежа

sdDocumentAdd 2 Добавлен документ сборочного чертежа
sdDocumentBeginRemove 3 Начало удаления документа сборочного 

чертежа
sdDocumentRemove 4 Удален документ сборочного чертеж
sdSpcStyleBeginChange 5 Начало изменения стиля спецификации
sdSpcStyleChange 6 Стиль спецификации изменился

ksSpcObjectNotifyEnum  События объекта 
спецификации

soBeginDelete 1 Начало удаления объекта
soDelete 2 Объект удален
soCellDblClick 3 Двойной щелчок в ячейке 
soCellBeginEdit 4 Начало редактирования в ячейке 
soChangeCurrent 5 Текущий объект изменен
soDocumentBeginAdd 6 Начало добавления документа
soDocumentAdd 7 Документ в объекте спецификации добавлен
soDocumentRemove 8 Документ из объекта спецификации удален
soBeginGeomChange 9 Начало изменения геометрии объекта 

спецификации
soGeomChange 10 Геометрия объекта спецификации изменилась
soBeginProcess 11 Начало редактирования\создания объекта
soEndProcess 12 Конец редактирования\создания объекта
soCreateObject 13 Объект создан
soUpdateObject 14 Объект изменен
soBeginCopy 15 Начало копирования объекта
soCopy 16 Копирование объекта
4884



ksSpecificationNotifyEnum  События для 
спецификации

ssTuningSpcStyleBeginChange 1 Начало изменения настроек 
спецификации

ssTuningSpcStyleChange 2 Настройки спецификации 
изменились

ssChangeCurrentSpcDescription 3 Изменилось текущее описание 
спецификации

ssSpcDescriptionAdd 4 Добавилось описание 
спецификации

ssSpcDescriptionRemove 5 Удалилось описание 
спецификации

ssSpcDescriptionBeginEdit 6 Начало редактирования описания 
спецификации

ssSpcDescriptionEdit 7 Отредактировали описание 
спецификации

ssSynchronizationBegin 8 Начало синхронизации
ssSynchronization 9 Синхронизация проведена
ssBeginCalcPositions 10 Начало расчета позиций
ssCalcPositions 11 Проведен расчет позиций
ssBeginCreateObject 12 Начало создания объекта 

спецификации (до диалога 
выбора раздела)

Константы спецификации 
Варианты оформления спецификации
Параметр variant может иметь следующие значения для выбора варианта оформления
спецификации:

0 " простая
1 " групповая, вариант А
2 " групповая, вариант Б
3 " групповая, вариант В " временно недоступен
4 " групповая, вариант Г " временно недоступен

Типы колонок спецификации

SPC_CLM_FORMAT 1 " формат
SPC_CLM_ZONE 2 " зона
SPC_CLM_POS 3 " позиция
SPC_CLM_MARK 4 " обозначение
SPC_CLM_NAME 5 " наименование
SPC_CLM_COUNT 6 " количество
SPC_CLM_NOTE 7 " примечание
SPC_CLM_MASSA 8 " масса
4885



SPC_CLM_MATERIAL 9 " материал
SPC_CLM_USER 10 " пользовательская
SPC_CLM_KOD 11 " код
