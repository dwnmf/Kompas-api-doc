KompasObject с помощью методов KompasObject::Document3D,
KompasObject::ActiveDocument3D; 

2. Данный интерфейс в СОМ может быть получен с помощью экспортных функций:
ksGet3dDocument, ksGetActive3dDocument.

ksDocument3D, IDocument3D  свойства
author  Имя автора документа
Интерфейс...

Справка системы КОМПАС
KOMPAS.chm::/DOCUMENT_INFO_DIALOG.htm
Тип данных: строка
Синтаксис Automation:

author = document.author Получить свойство (* )
document.author = author Установить свойство (* )
author = document.GetAuthor () Получить свойство (**)
document.SetAuthor(author) Установить свойство (**)

Синтаксис COM:

author = document">GetAuthor () Получить свойство
document">SetAuthor(author) Установить свойство

comment  Комментарий документа
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/DOCUMENT_INFO_DIALOG.htm
Тип данных: строка
2933



Синтаксис Automation:

comment = Получить свойство (* )
document.comment
document.comment = Установить свойство (* )
comment
comment = Получить свойство (**)
document.GetComment ()
document.SetComment Установить свойство (**)
(comment)

Синтаксис COM:

comment = document" Получить свойство
>GetComment ()
document">SetComment Установить свойство
(comment)

dis mantleMode  Разнесенный вид
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/CM_3D_REPLACE_COMPONENTS_PARAMETERS.htm
Тип данных: BOOL
Значения свойства:

TRUE " разнесенный
вид включен,

FALSE " разнесенный
вид выключен,

Синтаксис:

dismantleMode = iDocument3D.dismantleMode Получить свойство(* )
iDocument3D.dismantleMode = dismantleMode Установить свойство (* )
dismantleMode = Получить свойство (**)
iDocument3D.GetDismantleMode()
iDocument3D.SetDismantleMode Установить свойство (**)
(dismantleMode)

drawMode  Тип отображения модели
Интерфейс...
2934



Справка системы КОМПАС...
KOMPAS.chm::/679_82_5_Otobrazhenie_modeli.htm
Тип данных: long
Значения свойства:
Из перечисления ViewMode
Синтаксис Automation:

drawMode = Получить свойство (* )
iDocument3D.drawMode
iDocument3D.drawMode = Установить свойство (* )
drawMode
drawMode = Получить свойство(**)
iDocument3D.GetDrawMo
de()
iDocument3D.SetDrawMo Установить свойство (**)
de(drawMode)

enableRollBackFeaturesInCollections  Выдавать в 
коллекциях объекты, исключенные указателем в дереве
Интерфейс...

Справка системы КОМПАС...
kompas.chm::/667_81_3_6_Ukazatelq_okonchanij.htm
Тип данных: BOOL
Синтаксис Automation:

enable = Получить свойство (* )
iDocument3D.enableRollB
ackFeaturesInCollections
iDocument3D.enableRollB Установить свойство (* )
ackFeaturesInCollections = 
enable
enable = Получить свойство(**)
document.GetenableRollBa
ckFeaturesInCollections()
document.SetenableRollBa Установить свойство(**)
ckFeaturesInCollections(en
able)

Примечание:
По умолчанию объекты, исключенные с помощью указателя (зеленая полоска) дерева,
не выдаются. Свойство используется для получения исключенных объектов дерева, ко"
торые можно использовать для изменения положения указателя в дереве.
2935



См. функции ksDocument3D::GetRollBackFeature и ksDocument3D::SetRollBackFeature.

fileName  Имя файла документа (трехмерной модели)
Интерфейс...
Тип данных: строка
Синтаксис Automation:

fileName = document.fileName Получить свойство (* )
document.fileName = fileName Установить свойство (* )
fileName = Получить свойство (**)
document.GetFileName()
document.SetFileName(fileNam Установить свойство (**)
e)

Синтаксис COM:

fileName = document" Получить свойство
>GetFileName()
document" Установить свойство
>SetFileName(fileName)

invisibleMode  Режим редактирования документа
Интерфейс...
Тип данных: BOOL
Значения свойства:

TRUE " невидимый
режим,

FALSE " видимый ре"
жим.

Синтаксис Automation:

InvisibleMode = Получить свойство (* )
document.invis
ibleMode
InvisibleMode = Получить свойство (**)
document.GetI
nvisibleMode ()

Синтаксис COM:
2936



InvisibleMode = Получить
document" свойство
>GetInvisibleM
ode ()

Примечание:
Данное свойство предназначено только для чтения.

hideAllAuxiliaryGeom  Скрыть / показать все 
вспомогательные объекты
Интерфейс...
Тип данных: BOOL
Синтаксис:

hideAllAuxiliaryGeom = Получить свойство (* )
Object.hideAllAuxiliaryGeom
Object.hideAllAuxiliaryGeom = Установить свойство (* )
hideAllAuxiliaryGeom
hideAllAuxiliaryGeom = Получить свойство (**)
Object.GetHideAllAuxiliaryGeom(
)
Object.SetHideAllAuxiliaryGeom( Установить свойство (**)
hideAllAuxiliaryGeom )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideAllAxis  Скрыть\показать конструктивные оси
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.htm
Тип данных: BOOL
Значения свойства:

TRUE " скрыть конструктивные 
оси,

FALSE " показать 
конструктивные оси.

Синтаксис Automation:
2937



hideAllAxis = Получить свойство(* )
iDocument3D.h
ideAllAxis
iDocument3D.h Установить свойство(* )
ideAllAxis =
hideAllAxis
hideAllAxis = Получить свойство(**)
iDocument3D.G
etHideAllAxis()
iDocument3D.S Установить свойство (**)
etHideAllAxis(h
ideAllAxis)

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

HideAllControlPoints  Скрыть / показать контрольные 
точки
Интерфейс...

Справка системы КОМПАС
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.htm
Тип данных: BOOL
Значения свойства:

TRUE " контрольные точки 
скрыты,

FALSE " контрольные очки 
показаны.

Синтаксис COM:

BOOL HideAllControlPoints = iObject" Получить свойство
>GetHideAllControlPoints()
iObject">SetHideAllControlPoints Установить свойство
(HideAllControlPoints)

Примечание.
Свойство только для СОМ"интерфейса IDocument3D.
2938



HideAllCurves  Скрыть / показать пространственные 
кривые
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.htm
Тип данных: BOOL
Значения свойства:

TRUE " пространственные 
кривые скрыты,

FALSE " пространственные 
кривые показаны.

Синтаксис:

BOOL HideAllCurves = Получить свойство
iObject"
>GetHideAllCurves()
iObject">SetHideAllCurves Установить свойство
(HideAllCurves)

Примечание. 
Свойство только для СОМ"интерфейса IDocument3D.

hideAllDimensions  Скрыть / показать размеры
Интерфейс...
Тип данных: BOOL
Синтаксис:

hideAllDimensions = Получить свойство (* )
Object.hideAllDimensions
Object.hideAllDimensions Установить свойство (* )
= hideAllDimensions
hideAllDimensions = Получить свойство (**)
Object.GetHideAllDimensio
ns()
Object.SetHideAllDimensio Установить свойство (**)
ns( hideAllDimensions )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать размеры
в документе или, если документ является сборкой, во вставках.
2939



hideAllDesignations  Скрыть / показать условные 
обозначения
Интерфейс...
Тип данных: BOOL
Синтаксис:

hideAllDesignations = Получить свойство (* )
Object.hideAllDesignations
Object.hideAllDesignations Установить свойство(* )
= hideAllDesignations
hideAllDesignations = Получить свойство (**)
Object.GetHideAllDesignati
ons()
Object.SetHideAllDesignati Установить свойство (**)
ons(hideAllDesignations )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать услов"
ные обозначения в документе или, если документ является сборкой, во вставках.

hideAllPlaces  Скрыть\показать начала координат
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.htm
Тип данных: BOOL
Значения свойства:

TRUE " скрыть нача"
ла координат,

FALSE " показать на"
чала коорди"
нат.

Синтаксис Automation:

iDocument3D.hideAllPlace Получить свойство (* )
s
iDocument3D.hideAllPlace Установить свойство (* )
s = hideAllPlaces
hideAllPlaces = Получить свойство (**)
iDocument3D.GetHideAllPl
aces()
2940



iDocument3D.SetHideAllPl Установить свойство(**)
aces(hideAllPlaces)

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideAllPlanes  Скрыть\показать конструктивные 
плоскости
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.HTM
Тип данных: BOOL
Значения свойства:

TRUE " скрыть конструктивные 
плоскости,

FALSE " показать 
конструктивные 
плоскости.

Синтаксис Automation:

hideAllPlanes = Получить свойство (* )
iDocument3D.hideAllPlane
s
iDocument3D.hideAllPlane Установить свойство (* )
s = hideAllPlanes
hideAllPlanes = Получить свойство (**)
iDocument3D.GetHideAllPl
anes()
iDocument3D.SetHideAllPl Установить свойство (**)
anes( hideAllPlanes )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideAllSketches  Скрыть\показать эскизы
Интерфейс...
2941



Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.HTM
Тип данных: BOOL
Значения свойства:

TRUE " скрыть конструктивные 
эскизы,

FALSE " показать 
конструктивные эскизы.

Синтаксис Automation:

iDocument3D.hideAllSketches Получить свойство (* )
iDocument3D.hideAllSketches Установить свойство (* )
= hideAllSketches
hideAllSketches = Получить свойство (**)
iDocument3D.GetHideAllSketc
hes()
iDocument3D.SetHideAllSketc Установить свойство (**)
hes(hideAllSketches )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideAllSurfaces  Скрыть\показать поверхности
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.HTM
Тип данных: BOOL
Значения свойства:

TRUE " скрыть поверхности,
FALSE " показать поверхности.

Синтаксис Automation:

hideAllSurfaces = Получить свойство  (* )
iDocument3D.hideAllSurfa
ces
iDocument3D.hideAllSurfa Установить свойство  (* )
ces = hideAllSurfaces
2942



hideAllSurfaces = Получить свойство (**)
iDocument3D.GetHideAllS
urfaces()
iDocument3D.SetHideAllS Установить свойство(**)
urfaces(hideAllSurfaces)

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideAllThreads  Скрыть\показать обозначения резьбы
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/IDD_SETUP_LOD_OTHERS.HTM
Тип данных; BOOL
Значения свойства:

TRUE " скрыть поверхности,
FALSE " показать поверхности.

Синтаксис Automation:

hideAllThreads = Получить свойство (* )
iDocument3D.hideAllThrea
ds
iDocument3D.hideAllThrea Установить свойство (* )
ds = hideAllThreads
hideAllThreads = Получить свойство (**)
iDocument3D.GetHideAllT
hreads()
iDocument3D.SetHideAllT Установить свойство (**)
hreads(hideAllThreads)

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать все
вспомогательные объекты в документе или, если документ является сборкой, во встав"
ках.

hideInComponentsMode  Режим скрытия 
вспомогательной геометрии в компонентах
Интерфейс...
Тип данных: BOOL
Синтаксис:
2943



hideInComponentsMode = Получить свойство (* )
Object.hideInComponents
Mode
Object.hideInComponents Установить свойство (* )
Mode = 
hideInComponentsMode
hideInComponentsMode = Получить свойство(**)
Object.GetHideInCompone
ntsMode()
Object.SetHideInCompone Установить свойство(**)
ntsMode(hideInComponen
tsMode )

Примечание:
Флаг позволяет для сборки включить режим работы с флагами скрытия вспомогатель"
ной геометрии во вставках или в документе.
Если флаг включен, то свойства: hideAllPlanes, hideAllAxis, hideAllSketches, hideAllPlaces,
hideAllSurfaces, hideAllThreads, hideAllCurves, hideAllControlPoints, hideAllDimensions,
hideAllDesignations, hideAllAuxiliaryGeom управляют признаками скрытия вспомогатель"
ной геометрии во вставках.

hideLayoutGeometry  Скрыть / показать 
компоновочную геометрию
Интерфейс...
Тип данных: BOOL
Синтаксис:

hideLayoutGeometry = Получить свойство (* )
Object.hideLayoutGeometr
y
Object.hideLayoutGeometr Установить свойство (* )
y = hideLayoutGeometry
hideLayoutGeometry = Получить свойство (**)
Object.GetHideLayoutGeo
metry()
Object.SetHideLayoutGeo Установить свойство (**)
metry( 
hideLayoutGeometry )

Примечание:
В зависимости от флага hideInComponentsMode позволяет скрыть или показать компо"
новочную геометрию в документе или, если документ является сборкой, во вставке.
2944



perspective  Признак отображения модели в 
перспективной проекции
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/679_82_5_Otobrazhenie_modeli.htm
Тип данных: BOOL
Значения свойства:

TRUE " перспективная 
проекция включена,

FALSE " перспективная 
проекция выключена.

Синтаксис Automation:

perspective = Получить свойство (* )
iDocument3D.perspective
iDocument3D.perspective Установить свойство (* )
= perspective
perspective = Получить свойство (**)
iDocument3D.GetPerspecti
ve()
iDocument3D.SetPerspecti Установить свойство (**)
ve(perspective)

reference  Указатель документамодели (детали, 
сборки)
Интерфейс...
Тип данных: long
Синтаксис Automation:

ref = Получить свойство (* )
iDocument3D.reference
iDocument3D.reference = Установить свойство(* )
ref
ref = Получить свойство (**)
document.GetReference ()
document.SetReference Установить свойство (**)
(ref)

Примечание:
Свойство определяет указатель на трехмерную модель в стиле API графических доку"
ментов. Позволяет использовать функционал атрибутов и итераторов.
2945



shadedWireframe  Полутоновое изображение с 
каркасом объектов активного окна документамодели
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/679_82_5_Otobrazhenie_modeli.htm
Тип данных: BOOL
Значения свойства:

TRUE " полутоновое 
изображение с каркасом 
объектов включено,

FALSE " полутоновое 
изображение с каркасом 
объектов выключено.

Синтаксис:

shadedWireframe = Получить свойство (* )
iDocument3D.shadedWiref
rame
iDocument3D.shadedWiref Установить свойство(* )
rame = shadedWireframe
shadedWireframe = Получить свойство (**)
iDocument3D.GetShaded
Wireframe()
iDocument3D.SetShaded Установить свойство (**)
Wireframe(shadedWirefra
me)

treeNeedRebuild  Необходимость перестроения дерева 
при изменении его состава
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/964_117_12_Preduprezhdenija_o_n.htm
Тип данных: BOOL
Значения свойства:

TRUE " разрешить 
перестраивать дерево,
2946



FALSE " запретить 
перестраивать дерево.

Синтаксис:

treeNeedRebuild = Получить свойство(* )
iDocument3D.treeNeedRe
build
iDocument3D.treeNeedRe Установить свойство (* )
build = treeNeedRebuild
treeNeedRebuild = Получить свойство (**)
iDocument3D.GetTreeNee
dRebuild()
iDocument3D.SetTreeNee Установить свойство (**)
dRebuild 
(treeNeedRebuild)

Примечания:

1.  Так как после вызова ksEntity::Update у любого объекта модель будет перестраиваться,
то для ускорения при перестроении группы объектов, кроме закрытия самого перестро"
ения ksPart::needRebuild, можно также закрыть отрисовку дерева, если она не нужна.

2. При использовании данного свойства нужно запоминать его значение и после окончания
работы с ним возвращать его в первоначальное состояние.

windowNeedRebuild  Свойство необходимости 
перерисовки окна документа
Интерфейс...
Тип данных: BOOL
Значения свойства:

TRUE " надо перерисовывать,
FALSE " не надо перерисовывать.

Синтаксис:

windowNeedRebuild = Получить свойство (* )
object.windowNeedRebuild
object.windowNeedRebuild = Установить свойство (* )
windowNeedRebuild
windowNeedRebuild = Получить свойство (**)
object.GetWindowNeedRebuild()
object.SetWindowNeedRebuild(wi Установить свойство (**)
ndowNeedRebuild)

Примечание:
Свойство позволяет временно отключить перерисовку окна документа.
2947



Используется для ускорения создания, удаления или изменения группы объектов.

ksDocument3D, IDocument3D  методы
AdditionFormatParam  Получить указатель на интерфейс 
параметров сохранения модели в дополнительном 
формате
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/990_123_2_Ehksport.htm
Синтаксис Automation:
LPDISPATCH AdditionFormatParam();
Синтаксис COM:
LPADDITIONFORMATPARAM AdditionFormatParam();
Возвращаемое значение:

" указатель на интерфейс 
ksAdditionFormatParam или 
IAdditionFormatParam.

AddImportedSurfaces  Добавить импортированные 
поверхности
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/CM_IMPORTEDSURFACE.htm
Синтаксис Automation:
AddImportedSurfaces (BSTR fileName, BOOL together)
Синтаксис COM:
LPENTITYCOLLECTION AddImportedSurfaces (LPOLESTR fileName, BOOL together)
Входные параметры:

fileName " имя файла (*.igs, *.sat) 
импортированной поверхности,

together " Если параметр имеет значение 
TRUE, то импортированные 
поверхности будут сшиваться;
если параметр имеет значение FALSE, 
то будет импортирован массив 
импортированных поверхностей.
2948



Возвращаемое значение:

Указатель на интерфейс " в случае успеха,
ksEntityCollection или 
IEntityCollection,
NULL " в случае неудачи.

Примечания:
В документ можно вставить импортированную поверхность из файла, причем в общем
случае может импортироваться массив импортированных поверхностей, если together =
FALSE.

AddMateConstraint  Добавить сопряжение в сборку
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/1024_112_1_Obshchije_sved_sopr.htm
Синтаксис Automation:
BOOL AddMateConstraint (long constraintType, 
LPDISPATCH object1, 
LPDISPATCH object2, 
short direction, 
short fixed, 
double value);
Синтаксис COM:
BOOL AddMateConstraint (long constraintType, 
LPENTITY obj1, 
LPENTITY obj2,
short direction, 
short fixed,
double val);
Входные параметры:

constraintType " тип сопряжения из перечисления 
MateConstraintType,

object1 " указатель на интерфейс первого объекта, на 
который накладывается сопряжение (ksEntity или 
IEntity),

object2 " указатель на интерфейс второго объекта, на 
который накладывается сопряжение (ksEntity или 
iEntity),
2949



direction " ориентация 
(1 " объекты однонаправленные, 
0 " направление не учитывается, 
"1 " объекты разнонаправленные),

fixed " признак фиксации деталей перед выполнением 
(0 " детали не фиксируются, 
1 " фиксируется первая деталь,
2 " фиксируется вторая деталь),

val " параметр для ограничений (расстояние или угол 
между объектами).

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
Направление задаётся знаком параметра val.

AttributeCollection  Получить массив атрибутов
Интерфейс...

Справка системы КОМПАС: атрибуты объекта...
KOMPAS.chm::/502_Glava61_Obshchie_svedenija_.htm

Справка системы КОМПАС:атрибуты документа...
KOMPAS.chm::/514_63_1_3_Atribut_dokumenta.htm
Синтаксис Automation:
ksAttribute3DCollection* AttributeCollection (long key1,
long key2,
long key3,
long key4,
double numb,
LPDISPATCH pObj);
Синтаксис COM:
LPATTRIBUTE3DCOLLECTION AttributeCollection (long key1,
long key2,
long key3,
long key4,
double numb,
LPUNKNOWN pObj);
Входные параметры:

key1, key2, key3, key4 " ключи для поиска по ключам 
либо 0,
2950



numb " номер типа атрибута для поиска 
по номеру либо 0,

pObj " указатель на ksDocument3D " 
атрибуты документа, 
ksFeatureCollection " атрибуты 
для данной группы объектов, 
ksFeature " атрибуты 
определенного объекта.

Возвращаемое значение:

" указатель на массив атрибутов 
ksAttribute3DCollection.

Примечания:
Атрибут " это дополнительная неграфическая информация, связанная с объектом или
несколькими объектами чертежа. Такая информация может быть представлена в виде
числа, строки текста, а также таблицы с фиксированным или переменным числом строк.
В дальнейшем значения атрибутов могут использоваться для поиска объектов, а также
обрабатываться различными приложениями (например, системой проектирования спе"
цификаций, различными расчетными программами и т.п.).
Типы (описания структуры) атрибутов могут храниться как непосредственно в докумен"
те, так и в специальных файлах (библиотеках типов атрибутов). Эти файлы имеют рас"
ширение lat.

ChangeObjectInLibRequest  Изменить фантом или 
компоненты команд
Интерфейс...
Синтаксис Automation:
BOOL ChangeObjectInLibRequest();
Синтаксис COM:
BOOL ChangeObjectInLibRequest();
Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FALSE " в случае неудачи.

Примечание:
Вызов этого метода позволяет принудительно, не из CallBack"функции изменить пара"
метры текущего процесса. Предварительно, используя интерфейс ksRequestInfo3d, мож"
но изменить:

▼ состав команд командного окна,
▼ строку"приглашение,
2951



▼ идентификатор или имя курсора,
▼ заголовок командного окна.

Все сделанные изменения будут активизированы сразу после вызова данной функции.
Процесс должен быть предварительно запущен функцией UserGetPlacementAndEntity.

Close  Закрыть документмодель (деталь или сборку)
Интерфейс...
Синтаксис Automation:
BOOL Close();
Синтаксис COM:
BOOL Close();
Возвращаемое значение:

TRUE " в случае успешного 
завершения.

ComponentPositioner  Получить указатель на интерфейс 
управления положением компонентов в сборке
Интерфейс...
Синтаксис Automation:
ksComponentPositioner * ComponentPositioner();
Синтаксис COM:
LPCOMPONENTPOSITIONER ComponentPositioner();
Возвращаемое значение:

" указатель на интерфейс 
ksComponentPositioner.

CopyPart  Создать копию заданного компонента с 
заданным положением
Интерфейс...
Синтаксис Automation:
LPDISPATCH CopyPart (LPDISPATCH sourcePart, LPDISPATCH newPlacement);
Синтаксис COM:
LPPART CopyPart (LPPART sourcePart, LPPLACEMENT newPlacement);
Входные параметры:
2952



sourcePart " указатель на интерфейс 
исходного компонента ksPart  
или IPart, подлежащего 
копированию,

newPlacement " указатель на интерфейс 
положения создаваемой копии 
ksPlacement  или IPlacement.

Возвращаемое значение:

" указатель на интерфейс 
компонента ksPart или IPart.

Примечание:
Если не задано положение копии компонента, она создается в начале координат.

Create  Создать документмодель (деталь или сборку)
Интерфейс...
Синтаксис Automation:
BOOL Create (BOOL invisible, BOOL typeDoc);
Синтаксис COM:
BOOL Create (BOOL invisible, BOOL _typeDoc);
Входные параметры:

invisible " признак режима редактирования 
документа 
(TRUE " невидимый режим, 
FALSE " видимый режим),

typeDoc " тип документа 
(TRUE " деталь, 
FALSE " сборка).

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

CreatePartInAssembly  Получить указатель на интерфейс 
детали, создаваемой в сборке
Интерфейс...
2953



Справка системы КОМПАС...
KOMPAS.chm::/CM_3D_ADD_COMPONENT_PART.htm
Синтаксис Automation:
LPDISPATCH CreatePartInAssembly (BSTR fileName,
LPDISPATCH plane);
Синтаксис COM:
LPPART CreatePartInAssembly (LPOLESTR fileName,
LPENTITY plane);
Входные параметры:

fileName " имя файла детали создаваемой в сборке,
plane " указатель на интерфейс плоского 

объекта ksEntity или IEntity, к которому 
приклеивается деталь.

Возвращаемое значение:

" указатель на интерфейс 
детали, создаваемой в сборке 
ksPart или IPart.

DefaultPlacement  Получить указатель на интерфейс 
умолчательной системы координат
Интерфейс...
Синтаксис Automation:
ksPlacement * DefaultPlacement();
Синтаксис COM:
LPPLACEMENT DefaultPlacement();
Возвращаемое значение:

" указатель на интерфейс 
ksPlacement.

DeleteObject  Удалить объект: деталь, операцию, 
сопряжение
Интерфейс...
Синтаксис Automation:
BOOL DeleteObject (LPDISPATCH obj);
Синтаксис COM:
2954



BOOL DeleteObject (LPUNKNOWN obj);
Входной параметр:

obj " указатель на интерфейс 
IDispatch или IUnknown 
удаляемого объекта.

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечания:

1. Удалить можно любой трехмерный объект.
2. Если в качестве входного параметра переданы:

▼ поверхность ksFaceDefinition,
▼ ребро ksEdgeDefinition,
▼ вершина ksVertexDefinition,

то будет удален весь формообразующий элемент, которому принадлежит удаляемый
объект.

3. Если в качестве входного параметра передано описание объекта, полученное методом
ksEntity::GetDefinition, то после удаления недопустимо использование интерфейса опи"
сания удаленного объекта, породившего его интерфейса ksEntity и других интерфейсов
удаленного объекта.

EntityCollection  Получить указатель на интерфейс 
динамического массива объектов заданного типа, 
выбранных в документе
Интерфейс...
Синтаксис Automation:
LPDISPATCH EntityCollection (short objType, BOOL checkEntity);
Синтаксис COM:
LPENTITYCOLLECTION EntityCollection (short objType,BOOL checkEntity);
Входные параметры:

objType " тип объектов, содержащихся в массиве,
checkEntity " признак проверки для вновь 

добавляемых объектов на NULL 
(TRUE " проверка включена, 
FALSE " проверка выключена и в массив 
можно добавить NULL).
2955



Возвращаемое значение:

" указатель на интерфейс 
динамического массива объектов 
ksEntityCollection или 
IEntityCollection.

Примечание:
Массив создается пустым. Метод Refresh для полученного массива не работает.

ExcludeFeaturesAfter Исключить\включить объекты 
после заданного
Интерфейс...

Справка системы КОМПАС...
kompas.chm::/CM_EXCLUDE_AFTER_SEL_OBJECT.htm
Синтаксис Automation:
BOOL ExcludeFeaturesAfter( LPDISPATCH obj,
BOOL exclude );
Синтаксис COM:
BOOL ExcludeFeaturesAfter( LPFEATURE obj,
BOOL exclude );
Входные параметры:

obj " указатель на интерфейс объекта дерева 
ksFeature или IFeature после которого 
нужно исключить из расчета объекты,

exclude " TRUE " выключить объекты,
" FALSE " включить объекты.

Возвращаемое значение:

TRUE " в случае успеха,
FALSE " в случае неудачи.

GetChooseMng  Получить указатель на интерфейс 
менеджера выбора (подсветки) объектов
Интерфейс...
Синтаксис Automation:
LPDISPATCH  GetChooseMng();
Синтаксис COM:
2956



LPCHOOSEMNG GetChooseMng();
Возвращаемое значение:

" указатель на интерфейс 
ksChooseMng или IChooseMng.

GetDocument3DNotify  Получить указатель на 
интерфейс источника событий для документамодели
Интерфейс...
Синтаксис Automation:
Document3DNotify* GetDocument3DNotify();
Возвращаемое значение:

Указатель на источник событий " в случае успеха.
Document3DNotify

GetDocument3DNotifyResult  Дополнительные 
параметры для событий документа 3D
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetDocument3DNotifyResult();
Синтаксис COM:
IDocument3DNotifyResult * GetDocument3DNotifyResult();
Возвращаемое значение:

Указатель на интерфейс дополнительных параметров для 
события 3D документа IDocument3DNotifyResult, 
ksDocument3DNotifyResult

Примечание:
Интерфейс позволяет получить указатель на объект для которого посылается данное со"
бытие. Например, выбор материала и обозначения доступны для верхнего компонента,
вставки и тела.

GetEditMacroObject  Получить редактируемый 
макроэлемент 3D
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetEditMacroObject();
2957



Синтаксис COM:
LPENTITY GetEditMacroObject();
Возвращаемое значение:

" Указатель на интерфейс 
редактируемого 
макроэлемента ksEntity.

GetInterface  Получить интерфейс 3D объекта по типу
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetInterface (long o3dType);
Синтаксис COM:
LPUNKNOWN GetInterface (long o3dType);
Входные параметры:

o3dType " тип интерфейса.

Возвращаемое значение:

Указатель на заданный " в случае успеха,
интерфейс
NULL " в случае неудачи.

Список интерфейсов, возвращаемых функцией GetInterface и функцией
ksDocument3D::GetInterface.

GetLastFeature  Получить последний объект в дереве
Интерфейс...
Синтаксис Automation:
LPDISPATCH         GetLastFeature()
Синтаксис COM :
LPFEATURE          GetLastFeature()
Возвращаемое значение: 

Указатель на  объект " в случае успеха,
дерева ksFeature или 
IFeature
NULL " в случае неудачи.
2958



GetMateConstraint  Получить указатель на интерфейс 
нового временного сопряжения
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetMateConstraint();
Синтаксис COM:
LPMATECONSTRAINT GetMateConstraint();
Возвращаемое значение:

" указатель на интерфейс 
нового сопряжения 
ksMateConstraint или 
IMateConstraint.

Примечания:

1.  Сопряжения бывают постоянными и временными. Временные сопряжения, в отличие от
постоянных, существуют только в течении процесса указания местоположения или объ"
ектов. Процесс запускается методом ksDocument3D::UserGetPlacementAndEntity. Посто"
янные сопряжения создаются с помощью метода ksDocument3D::AddMateConstraint.

2. Для создания временного сопряжения в модели после получения указателя на его ин"
терфейс с помощью данного метода и изменения параметров создаваемого сопряжения
используется метод ksMateConstraint::Create .

3. Пример использования методов создания временных и постоянных сопряжений приве"
ден в демонстрационной библиотеке построения модели стандартного изделия (шпиль"
ки), которая сохранена в файле STUDS3D.rtw.

GetObjParam  Получить параметры объекта
Интерфейс...
Аналог данного метода при использовании API экспортных функций " GetObjParam.
Синтаксис Automation:
long ksGetObjParam (long reference, LPDISPATCH param, long paramType);
Входные параметры:

reference " указатель на объект,
paramType " тип параметров,
param " указатель на интерфейс 

параметров ksUserParam.

Возвращаемое значение:

тип объекта " в случае удачного 
завершения,
2959



0 " в случае неудачи.

GetObjectType  Получить тип объекта
Интерфейс...
Синтаксис Automation:
long GetObjectType (LPDISPATCH obj);
Синтаксис COM:
int GetObjectType (LPUNKNOWN obj);
Входной параметр:

obj " указатель на интерфейс 
IDispatch или IUnknown 
трехмерного объекта.

Возвращаемое значение:

" тип объекта Obj3dType.

Примечания:
Данный метод удобно использовать для приведения базового интерфейса (IUnknown в
COM и IDispatch в Automation) к конечному трехмерному интерфейсу. Зная тип объекта,
можно привести его к соответствующему интерфейсу.

GetPart  Получить указатель на интерфейс компонента 
в соответствии с заданным типом
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetPart (long type);
Синтаксис COM:
LPPART GetPart(int type);
Входной параметр:

type " тип компонента из 
перечисления Типы 
компонентов.

Возвращаемое значение:
2960



" указатель на интерфейс 
компонента ksPart или 
IPart.

Примечание:
Тип задается для нового, редактируемого или главного компонента либо тип равен но"
меру компонента в документе.
Функция используется, чтобы получить доступ к компоненту документа.
Деталь или сборка являются компонентами. Сборка, в свою очередь, состоит из компо"
нентов " деталей и подсборок.

GetRequestInfo  Получить указатель интерфейса 
параметров запроса к системе ksRequestInfo3D
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetRequestInfo (LPDISPATCH part);
Синтаксис COM:
LPREQUESTINFO GetRequestInfo (LPPART part);
Входной параметр:

part " указатель на интерфейс 
компонента (детали или 
подсборки) ksPart или 
IPart.

Возвращаемое значение:

" указатель на интерфейс 
параметров запроса к 
системе ksRequestInfo3D 
или IRequestInfo.

GetRollBackFeature  Получить положение указателя в 
дереве
Интерфейс...

Справка системы КОМПАС...
kompas.chm::/667_81_3_6_Ukazatelq_okonchanij.htm
Синтаксис Automation:
LPDISPATCH GetRollBackFeature( );
2961



Синтаксис COM:
LPFEATURE GetRollBackFeature();
Возвращаемое значение:

" указатель на объект " в случае успешного 
дерева ksFeature или завершения,
IFeature, после которого 
установлен указатель.
FALSE " в случае неудачи.

GetSelectionMng  Получить указатель на интерфейс 
менеджера выделенных объектов
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetSelectionMng();
Синтаксис COM:
LPSELECTIONMNG GetSelectionMng();
Возвращаемое значение:

указатель на интерфейс 
ksSelectionMng или 
ISelectionMng.

GetSpecification  Получить указатель на интерфейс для 
работы с объектами спецификации
Интерфейс...
Синтаксис Automation:
LPDISPATCH GetSpecification();
Возвращаемое значение:

" указатель на интерфейс 
для работы с объектами 
спецификации 
ksSpecification.
2962



GetViewProjectionCollection  Получить указатель на 
интерфейс массива проекций отображения модели в 
окне
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/674_82_4_Orientacija_modeli.htm
Синтаксис Automation:
LPDISPATCH GetViewProjectionCollection();
Синтаксис COM:
LPVIEWPROJECTIONCOLLECTION GetViewProjectionCollection();
Возвращаемое значение:

" указатель на интерфейс 
ksViewProjectionCollectio
n или 
IViewProjectionCollection.

IsActive  Получить состояние активности документа
Интерфейс...
Синтаксис Automation:
BOOL IsActive();
Синтаксис COM:
BOOL IsActive();
Возвращаемое значение:

TRUE " документ является 
активным.

IsDetail  Определить, является ли модель деталью
Интерфейс...
Синтаксис Automation:
BOOL IsDetail();
Синтаксис COM:
BOOL IsDetail();
Возвращаемое значение:
2963



TRUE " деталь, 
FALSE " сборка.

IsEditMode  Определить, запущен ли какойлибо из 
компонентов на редактирование через библиотеку
Интерфейс...
Синтаксис Automation:
BOOL IsEditMode();
Синтаксис COM:
BOOL IsEditMode();
Возвращаемое значение:

TRUE " редактирование 
компонента через 
библиотеку,

FALSE " редактируемых 
компонентов нет.

Примечание:
Редактируемый компонент можно получить методом GetPart (pEdit_Part).

ksDeleteObj  Удалить объект
Интерфейс...
Аналог данного метода при использовании API экспортных функций " DeleteObj.
Синтаксис Automation:
long ksDeleteObj (long ref);
Синтаксис COM:
long ksDeleteObj (long ref);
Входные параметры:

ref " указатель на удаляемый 
объект.

Возвращаемое значение:

1 " в случае успешного 
завершения.

ksGetObjParam  Получить параметры объекта 
Интерфейс...
2964



Аналог данного метода при использовании API экспортных функций " GetObjParam.
Синтаксис Automation:
long ksGetObjParam (long reference, LPDISPATCH param, long paramType);
Входные параметры:

reference " указатель на объект,
paramType " тип параметров объекта или индекс 

строки в массиве для объектов 
TECHNICALDEMAND_OBJ и TEXT_OBJ 
или номер страницы (габаритного 
прямоугольника) технических 
требований 
(TECHNICALDEMAND_OBJ),

Param " указатель на интерфейс параметров 
ksUserParam.

Возвращаемое значение:

Тип объекта " в случае успешного 
завершения,

0 " в случае неудачи.

Примечание:
Вызов метода с нулевыми значениями параметров param и parType позволяет получить
тип объекта по его reference.

ksIsSlaveSpcOpened  Открыто ли окно спецификации в 
Slave режиме
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/1155_132_3_Podchinennyj_rezhim.htm
Синтаксис Automation:
int ksIsSlaveSpcOpened();
Синтаксис COM:
int ksIsSlaveSpcOpened();
Возвращаемое значение:

0 " окно спецификации в Slave 
режиме не открыто,

1 " окно спецификации в Slave 
режиме открыто,

2 " окно спецификации в Slave 
режиме открыто и активно.
2965



ksSetObjParam  Установить параметры объекта
Интерфейс...
Аналог данного метода при использовании API экспортных функций " SetObjParam.
Синтаксис Automation:
long ksSetObjParam (long reference, LPDISPATCH param, long paramType);
Входные параметры:

reference " указатель на объект,
paramType " тип параметров объекта или индекс строки в 

массиве для объектов TECHNICALDEMAND_OBJ и 
TEXT_OBJ  или номер страницы (габаритного 
прямоугольника) технических требований 
(TECHNICALDEMAND_OBJ),

Param " указатель на интерфейс параметров ksUserParam.

Возвращаемое значение:

1 " в случае успешного 
завершения,

0 " в случае неудачи.

LoadFromAdditionFormat  Загрузить документ из 
дополнительных форматов jgs, sat, xt, x_b, step, stl, jt, 
C3D
Интерфейс...
Синтаксис Automation:
BOOL LoadFromAdditionFormat( BSTR fileName, LPDISPATCH additionPar );
Синтаксис COM:
BOOL LoadFromAdditionFormat( LPOLESTR fileName, LPADDITIONFORMATPARAM
additionPar );
Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FALSE " в случае неудачи.

Выходные параметры:
2966



fileName "имя файла,
additionPar " указатель на интерфейс

ksAdditionFormatParam или
IAdditionFormatParam, определяю"
щий параметры записи в дополни"
тельный формат,

MateConstraintCollection  Получить интерфейс 
параметров массива сопряжений компонента сборки
Интерфейс...
Синтаксис Automation:
LPDISPATCH MateConstraintCollection();
Синтаксис COM:
LPMATECONSTRAINTCOLLECTION MateConstraintCollection();
Возвращаемое значение:

Указатель на интерфейс коллекции сопряжений
текущей редактируемой сборки или подсборки
IMateConstraintCollection
ksMateConstraintCollection

Open  Открыть на редактирование документмодель 
(деталь или сборку)
Интерфейс...
Синтаксис Automation:
BOOL Open (BSTR fileName, BOOL invisible);
Синтаксис COM:
BOOL Open (LPOLESTR fileName, BOOL invisible);
Входные параметры:

fileName " имя файла открываемого 
документа,

invisible " признак режима редактирования 
документа 
(TRUE – невидимый режим, 
FALSE " видимый режим).

Возвращаемое значение:
2967



TRUE " в случае успешного 
завершения.

PartCollection  Получить указатель на интерфейс 
динамического массива компонентов, вставленных в 
сборку
Интерфейс...
Синтаксис Automation:
LPDISPATCH PartCollection (BOOL refresh)
Синтаксис COM:
LPPARTCOLLECTION PartCollection (BOOL refresh);
Входные параметры:

refresh " TRUE " полученный массив будет 
заполнен компонентами данной 
сборки или детали,
FALSE " полученный массив будет 
пустым.

Возвращаемое значение:

" указатель на интерфейс 
динамического массива 
компонентов, вставленных в 
сборку ksPartCollection или 
IPartCollection.

PlaceFeatureAfter  Поставить объект дерева после 
другого объекта дерева
Интерфейс...
Синтаксис Automation:
BOOL PlaceFeatureAfter( LPDISPATCH obj, LPDISPATCH afterObj );
Синтаксис COM:
BOOL PlaceFeatureAfter( LPFEATURE obj, LPFEATURE afterObj );
Входные параметры:

obj " указатель на перемещаемый 
объект дерева ksFeature или 
IFeature,
2968



afterObj " указатель на объект дерева, после 
которого нужно установить 
заданный объект ksFeature или 
IFeature,

Возвращаемое значение:

TRUE " в случае успешного завершения,
FALSE " в случае неудачи.

RasterFormatParam  Получить указатель на интерфейс 
параметров сохранения документа в растровом 
формате
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/645_79_3_Sokhranenie_v_rastrovy.htm
Синтаксис Automation:
LPDISPATCH RasterFormatParam();
Синтаксис COM:
LPRASTERFORMATPARAM RasterFormatParam();
Возвращаемое значение:

" указатель на интерфейс 
ksRasterFormatParam или 
IRasterFormatParam.

RebuildDocument  Перестроить документмодель
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/CM_3D_REBUILD_ALL.htm
Синтаксис Automation:
BOOL RebuildDocument();
Возвращаемое значение:

TRUE " в случае успешного завершения,
FALSE " в случае неудачи.

RemoveMateConstraint  Удалить сопряжение из сборки
Интерфейс...
2969



Справка системы КОМПАС...
KOMPAS.chm::/1024_112_1_Obshchije_sved_sopr.htm
Синтаксис Automation:
BOOL RemoveMateConstraint (long constraintType, 
LPDISPATCH object1, 
LPDISPATCH object2);
Синтаксис COM:
BOOL RemoveMateConstraint (unsigned int constraintType, 
LPENTITY obj1, 
LPENTITY obj2);
Входные параметры:

constraintType " тип сопряжения из перечисления 
MateConstraintType,

object1 " указатель на интерфейс первого 
объекта, на который наложено 
сопряжение (ksEntity или IEntity),

object2 " указатель на интерфейс второго 
объекта, на который наложено 
сопряжение (ksEntity или ksEntity).

Возвращаемое значение:

TRUE " в случае успешного завершения.

RunTakeCreateObjectProc  Запустить подчиненный 
режим создания объектов
Интерфейс...
Синтаксис Automation:
BOOL RunTakeCreateObjectProc( long processType, LPDISPATCH takeObject, BOOL
needCreateTakeObj, BOOL lostTakeObj )
Синтаксис COM:
BOOL RunTakeCreateObjectProc( long processType, LPUNKNOWN takeObject, BOOL
needCreateTakeObj, BOOL lostTakeObj );
Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FALSE " в случае неудачи.

Выходные параметры:
2970



ProcessType " тип подпроцесса,
TakeObject " указатель на интерфейс 

редактируемого в подпроцессе объекта.
NeedCreateTakeObj " необходимость создания объекта в 

подпроцессе
LostTakeObj" " TRUE " фиксировать параметры 

создаваемого объекта.

Функция позволяет запустить следующие подпроцессы

prPoint3D Точка 3D
prAxisByDirection Ось через вершину по объекту
prCAxis2Points Ось по двум точкам
prCAxis2Planes Ось по двум плоскостям
prCAxisConeface Ось конической грани
prCAxisEdge Ось, проходящая через ребро
prContour3D Контур 3D
prLocalCoordinateSystem Локальная система координат
prIsoparamCurve Изопараметрическая кривая
prEquidistant3D Эквидистанта 3D
prCPlaneOffset Смещённая плоскость
prCPlane3Points Плоскость по 3"м точкам
prCPlaneAngle Плоскость под углом
prCPlaneEdgePoint Плоскость через ребро и вершину
prCPlaneParallel Плоскость через вершину параллельно 

другой плоскости
prCPlanePerpendicular Плоскость через вершину перпендикулярно 

ребру
prCPlaneNormalToSurface Нормальная плоскость
prCPlaneTangentToSurface Касательная плоскость
prCPlaneLineToEdge Плоскость через ребро параллельно/

перпендикулярно другому ребру
prCPlaneLineToFlat Плоскость через ребро параллельно/

перпендикулярно грани
prCPlaneMiddle Средняя плоскость
prCPlaneTangentAtPoint Плоскость, касательная к грани в точке
prCPlaneAtCurve Плоскость через плоскую кривую
prMateParallel Сопряжения компонентов " Параллельность
prMatePerpendicular Сопряжения компонентов " 

Перпендикулярность
prMateOnDistance Сопряжения компонентов " На расстоянии
prMateOnAngle Сопряжения компонентов " Под углом
prMateTangent Сопряжения компонентов " Касание
prMateConcentric Сопряжения компонентов " Соосность
prMateCoincident Сопряжения компонентов " Совпадение
prMateSymmetry Сопряжения компонентов " Симметрия
prMateDependent Сопряжения компонентов " Зависимое 

положение
2971



Save  Cохранить документмодель (деталь или сборку) 
в файл с заданным ранее именем
Интерфейс...
Синтаксис Automation:
BOOL Save();
Синтаксис COM:
BOOL Save();
Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
Имя файла документа задается свойством fileName.

SaveAs  Cохранить документмодель (деталь или 
сборку) с новым именем
Интерфейс...
Синтаксис Automation:
BOOL SaveAs (BSTR fileName);
Синтаксис COM:
BOOL SaveAs (LPOLESTR fileName);
Входной параметр:

fileName " имя файла документа.

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

SaveAsEx  Сохранить документ с новым именем файла
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/Glava_12_Sozdanie_sohranenie_dok.htm
Синтаксис Automation:
BOOL SaveAsEx (BSTR fileName, long saveMode);
Синтаксис COM:
BOOL SaveAsEx (LPOLESTR fileName, long saveMode);
2972



Входные параметры:

fileName " новое имя файла 
документа,

saveMode " версия для сохранения:
"1 " в предыдущую 
версию,
0 " в текущую версию,
1 " в версию 5.11.

Возвращаемое значение:

TRUE " в случае успешного завершения,
FALSE " в случае неудачи.

Примечание:
Если fileName = NULL, то используется имя файла из документа. Если же и в документе
отсутствует имя файла, то взводится ошибка.

SaveAsToAdditionFormat  Сохранить модель в файле 
формата SAT, XT, STEP, IGES, VRML, STL
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/990_123_2_Ehksport.htm
Синтаксис Automation:
BOOL SaveAsToAdditionFormat (BSTR fileName,
LPDISPATCH additionPar);
Синтаксис COM:
BOOL SaveAsToAdditionFormat (LPOLESTR fileName,
LPADDITIONFORMATPARAM additionPar );
Входные параметры:

fileName " полное имя файла, в который сохраняется 
модель,

additionPar " указатель на интерфейс 
ksAdditionFormatParam или 
IAdditionFormatParam, определяющий 
параметры записи в дополнительный формат.

Возвращаемое значение:
2973



TRUE " в случае успешного 
завершения.

SaveAsToRasterFormat  Сохранить документ в 
растровом файле
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/645_79_3_Sokhranenie_v_rastrovy.htm
Синтаксис Automation:
BOOL SaveAsToRasterFormat (BSTR fileName,
LPDISPATCH rasterPar);
Синтаксис COM:
BOOL SaveAsToRasterFormat (LPOLESTR fileName,
LPRASTERFORMATPARAM rasterPar );
Входные параметры:

fileName " полное имя файла, в который 
сохраняется модель,

rasterPar " указатель на интерфейс 
ksRasterFormatParam или 
IRasterFormatParam, определяющий 
параметры записи в растровый формат.

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
Метод позволяет сохранить присланный документ в растровом формате (BMP, GIF, JPG,
PNG, TIF, TGA, PCX, EMF и WMF) с заданными свойствами. 
Сохранение в WMF формат не поддерживается. При сохранении в WMF формате файл
записывается в формате EMF.

SaveAsToUncompressedRasterFormat  Cохранить 
документ в растровый формат
Интерфейс...
2974



Справка системы КОМПАС...
KOMPAS.chm::/645_79_3_Sokhranenie_v_rastrovy.htm
Синтаксис Automation:
BOOL SaveAsToUncompressedRasterFormat (BSTR fileName, LPDISPATCH rasterPar);
Синтаксис COM:
BOOL SaveAsToUncompressedRasterFormat (LPOLESTR fileName,
LPRASTERFORMATPARAM rasterPar );
Выходные параметры:

fileName " Имя файла документа. 
Задается полное имя файла,

rasterPar " Указатель на интерфейс 
ksRasterFormatParam или 
IRasterFormatParam, 
определяющий параметры 
конвертации в растровый 
формат.

Возвращаемое значение:

TRUE " в случае успеха,
FALSE " в случае неудачи

Примечания:

1. Метод позволяет сохранить документ в растровый формат (BMP, GIF, JPG, PNG, TIF, TGA,
PCX, EMF и WMF) без сжатия, с заданными свойствами. 
Сохранение в WMF формат не поддерживается. При сохранении в WMF формате файл
записывается в формате EMF.
Подробнее см. описание интерфейса ksRasterFormatParam. Для API экспортных функций
" метод ksSaveAsToUncompressedRasterFormat.

SetActive  Сделать документ текущим
Интерфейс...
Синтаксис Automation:
BOOL SetActive();
Синтаксис COM:
BOOL SetActive();
Возвращаемое значение:

TRUE " в случае успешного завершения.
2975



SetPartFromFile  Вставить в модель компонент ссылкой 
на внешний файл или телом
Интерфейс...
Синтаксис Automation:
BOOL SetPartFromFile (BSTR fileName, 
LPDISPATCH part, 
BOOL externalFile);
Синтаксис COM:
BOOL SetPartFromFile (LPOLESTR fileName, 
LPPART part, 
BOOL externalFile);
Входные параметры:

fileName " имя файла, из которого будет 
вставлен компонент,

part " указатель на интерфейс 
компонента, который будет 
вставлен в документ (ksPart или 
IPart),

externalFile " признак сохранения связи с 
файлом"источником 
(TRUE " вставка со ссылкой на 
внешний файл, 
FALSE " вставка "телом", без 
сохранения ссылки на 
источник).

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
При вставке из файла указывается полный путь к файлу. При вставке из библиотеки мо"
делей указывается полный путь к файлу библиотеки и путь внутри библиотеки моделей
(например, "C:\\standard.l3d|Крепежные элементы|Болты|Болт_1").

SetPartFromFileEx  Вставить в модель компонент из 
файла или из библиотеки моделей
Интерфейс...
Синтаксис Automation:
BOOL SetPartFromFileEx (BSTR fileName, LPDISPATCH part, BOOL externalFile, BOOL re"
draw);
2976



Синтаксис COM:
BOOL SetPartFromFileEx (LPOLESTR fileName, LPPART part, BOOL externalFile, BOOL re"
draw);
Входные параметры:

fileName " имя файла, из которого будет 
вставлен компонент,

part " указатель на интерфейс 
компонента, который будет 
вставлен в документ (ksPart или 
IPart),

externalFile " признак сохранения связи с 
файлом"источником:
(TRUE " вставка со ссылкой на 
внешний файл, 
FALSE " вставка "телом", без 
сохранения ссылки на 
источник),

redraw  " признак перестроения 
документа после вставки 
компонента:
(TRUE " перестроить документ,
FALSE " не перестраивать).

Возвращаемое значение:

TRUE " в случае успеха,
FALSE " в случае неудачи.

Примечания:
При вставке из файла указывается полный путь к файлу. При вставке из библиотеки мо"
делей указывается полный путь к файлу библиотеки и путь внутри библиотеки моделей
(например, "C:\\standard.l3d|Крепежные элементы|Болты|Болт_1").

SetRollBackFeature  Установить положение указателя в 
дереве
Интерфейс...

Справка системы КОМПАС...
kompas.chm::/667_81_3_6_Ukazatelq_okonchanij.htm
Синтаксис Automation:
BOOL SetRollBackFeature( LPDISPATCH obj );
Синтаксис COM:
BOOL SetRollBackFeature( LPFEATURE obj );
Входные параметры:
2977



obj " указатель на объект дерева 
ksFeature или IFeature, после 
которого нужно установить 
указатель.

Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FALSE " в случае неудачи.

StopLibRequest  Остановить текущий процесс
Интерфейс...
Синтаксис Automation:
BOOL StopLibRequest();
Синтаксис COM:
BOOL StopLibRequest();
Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FALSE " в случае неудачи.

Примечание:
Процесс должен быть предварительно запущен функцией UserGetPlacementAndEntity.

UpdateDocumentParam  Активизировать измененные 
параметры документа
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/CM_3D_REBUILD_ALL.htm
Синтаксис Automation:
BOOL UpdateDocumentParam();
Синтаксис COM:
BOOL UpdateDocumentParam();
Возвращаемое значение:
2978



TRUE " в случае успешного 
завершения.

UserGetCursor  Запустить процесс указания 
местоположения точки
Интерфейс...
Синтаксис Automation:
BOOL UserGetCursor (BSTR prompt, double * x, double * y, double * z);
Синтаксис COM:
BOOL UserGetCursor (LPOLESTR prompt, double * x, double * y, double * z);
Входные параметры:

promt " строка подсказки для 
пользователя.

Выходные параметры:

x " координата x точки, указанной 
пользователем,

y " координата y точки, указанной 
пользователем,

z " координата z точки, указанной 
пользователем.

Возвращаемое значение:

TRUE " в случае успешного завершения 
(пользователь указал точку).

UserGetPlacementAndEntity  Запустить процесс 
указания местоположения или объектов
Интерфейс...
Синтаксис Automation:
BOOL UserGetPlacementAndEntity(long entityCount);
Синтаксис COM:
BOOL UserGetPlacementAndEntity(long entityCount);
Входной параметр:
2979



entityCount " максимальное количество 
объектов, которое может быть 
одновременно указано в 
процессе.

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
Параметры настройки процесса задаются с помощью интерфейса ksRequestInfo3D.
Массив объектов необходимо заполнить вручную в CallBack"функции.
В интерфейсе ksRequestInfo3D определен доступ к массиву объектов, который заполня"
ется в процессе.
Для процесса можно задать строку приглашения и функции обратной связи для филь"
трации объектов и выбора объекта.
Алгоритм работы процесса:
Разработчик определяет значение entityCount, текст строки приглашения, функции
обратной связи и запускает процесс. 
При захвате курсором объекта модели этот объект передается в функцию фильтрации,
где можно проверить его тип и сообщить процессу, подходит объект или нет.
Если объект подходит, то он подсвечивается на экране.
После указания объекта он передается в функцию выбора, где его можно добавить в
массив объектов и изменить строку приглашения. 
Объекты, попавшие в массив, выделяются на экране.
После выхода из процесса массив остается доступным до очередного вызова функции
GetRequestInfo.

UserSelectEntity  Запустить процесс выбора объекта
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/682_82_7_1_Vybor_obwektov_v_okn.htm
Синтаксис Automation:
LPDISPATCH UserSelectEntity (LPDISPATCH defObject,
LPCTSTR methodName,
LPCTSTR prompt,
long hInstance,
LPDISPATCH dispatchOCX);
Входные параметры:
2980



defObject " указатель на объект по умолчанию, 
который будет подсвечен при 
запуске процесса,

methodName " название функции фильтрации 
или NULL,

prompt " строка подсказки или NULL,
hInstance " hInstance модуля, в котором 

находится функция фильтрации,
dispatchOCX " интерфейс, в котором находится 

функция фильтрации, если 
hInstance не доступен.

Тип функции фильтрации:
bool WINAPI SELECTFILTERPROC (LPDISPATCH _entity)
Пользователь может указать процессу, подходит ему по каким"то соображениям при"
сланный объект или нет. Если функция фильтрации возвращает TRUE, значит, объект
подходит, и он будет подсвечен процессом.
Возвращаемое значение:

указатель на интерфейс ksEntity " в случае успешного завершения,
объекта, который выделили в 
процессе выбора
NULL " в случае отказа.

Синтаксис COM:
LPENTITY UserSelectEntity (LPENTITY defObject,
USERSELECTFILTERPROC methodName,
LPOLESTR prompt);
Входные параметры:

defObject " указатель на объект по 
умолчанию, который будет 
подсвечен при запуске процесса,

methodName " название функции фильтрации 
или NULL,

prompt " строка приглашения или NULL.

Тип функции фильтрации:
typedef BOOL (__stdcall * USERSELECTFILTERPROC)(LPENTITY);
Пользователь может указать процессу, подходит ему по каким"то соображениям при"
сланный объект или нет. Если функция фильтрации возвращает TRUE, значит, объект
подходит, и он будет подсвечен процессом.
Возвращаемое значение:
2981



указатель на интерфейс IEntity " в случае успешного завершения,
объекта, который выделили в 
процессе выбора
NULL " в случае отказа.

UserSelectEntityEx  Запустить процесс выбора объекта 
(позволяет использовать Панель свойств)
Интерфейс...

Справка системы КОМПАС...
KOMPAS.chm::/682_82_7_1_Vybor_obwektov_v_okn.htm
Синтаксис Automation:
LPDISPATCH UserSelectEntityEx( LPDISPATCH filterObject,
BSTR methodName,
BSTR prompt,
long hInst,
LPDISPATCH val,
LPUNKNOWN processParam );
Входные параметры:

filterObject " указатель на объект по 
умолчанию, который будет 
подсвечен при запуске процесса,

methodName " название функции фильтрации 
или NULL,

prompt " строка подсказки или NULL,
hInst " hInstance модуля, в котором 

находится функция фильтрации,
val " интерфейс, в котором находится 

функция фильтрации, если 
hInstance не доступен,

processParam " Параметры процесса 
IProcessParam.

Тип функции фильтрации:
bool WINAPI SELECTFILTERPROC (LPDISPATCH _entity)
Пользователь может указать процессу, подходит ему по каким"то соображениям при"
сланный объект или нет. Если функция фильтрации возвращает TRUE, значит, объект
подходит, и он будет подсвечен процессом.
Возвращаемое значение:

указатель на интерфейс ksEntity " в случае успешного завершения,
объекта, который выделили в 
процессе выбора
2982



NULL " в случае отказа.
Синтаксис COM:
LPENTITY   UserSelectEntityEx(LPENTITY defSelectObject,
void* fnFilter,
LPOLESTR prompt,
 LPUNKNOWN processParam );
Входные параметры:

defSelectObject " указатель на объект по умолчанию, 
который будет подсвечен при запуске 
процесса,

fnFilter " название функции фильтрации или 
NULL,

prompt " строка приглашения или NULL,
processParam " Параметры процесса IProcessParam.

Тип функции фильтрации:
typedef BOOL (__stdcall * USERSELECTFILTERPROC)(LPENTITY);
Пользователь может указать процессу, подходит ему по каким"то соображениям при"
сланный объект или нет. Если функция фильтрации возвращает TRUE, значит, объект
подходит, и он будет подсвечен процессом.
Возвращаемое значение:

указатель на интерфейс IEntity " в случае успешного 
объекта, который выделили в завершения,
процессе выбора
NULL " в случае отказа.

Примечание:
Функция устарела. Использование данной функции может привести к ошибке в библио"
теке, собранной с конфигурацией x64.
Рекомендуется использовать функцию ksDocument3D::UserSelectEntityEx2.

UserSelectEntityEx2  Запустить процесс выбора объекта 
(позволяет использовать Панель свойств)
Интерфейс...
Синтаксис Automation:
LPDISPATCH UserSelectEntityEx2(LPDISPATCH filterObject,
BSTR methodName, BSTR prompt,
VARIANT hInst, [defaultvalue(0)]LPDISPATCH val, [defaultvalue(0)]LPUNKNOWN
processParam );
Входные параметры:
2983



filterObject " указатель на объект по 
умолчанию, который будет 
подсвечен при запуске процесса,

methodName " название функции фильтрации 
или NULL,

prompt " строка подсказки или NULL,
hInst " hInstance модуля, в котором 

находится функция фильтрации,
val " интерфейс, в котором находится 

функция фильтрации, если 
hInstance не доступен,

processParam " параметры процесса 
IProcessParam.

Возвращаемое значение:

TRUE " в случае успешного 
завершения,

FАLSE " в случае неудачи.

Аналог функции в COM см. IRequestInfo3D::SetCallBack.
Тип функции фильтрации:
bool WINAPI SELECTFILTERPROC (LPDISPATCH _entity)
Пользователь может указать процессу, подходит ему по каким"то соображениям при"
сланный объект или нет. Если функция фильтрации возвращает TRUE, значит объект
подходит, и он будет подсвечен процессом.
Возвращаемое значение:

указатель на интерфейс IEntity " в случае успешного завершения,
объекта, который выделили в 
процессе выбора
NULL " в случае отказа.

Примечание:
HINSTANCE библиотеки нужно передать через VARIANT, как VT_I4 в Win32 и VT_I8 в x64.
Для правильного формирования _variant_t HINSTANCE нужно передавать через приведе"
ние к (LONG_PTR).
В библиотеках, использующих автоматизацию, рекомендуется использовать данную
функцию вместо ksDocument3D::UserSelectEntityEx.
2984



ZoomPrevNextOrAll  Показать модель в активном окне 
полностью или установить предыдущий или 
последующий масштаб изображения
Интерфейс...
Синтаксис Automation:
BOOL ZoomPrevNextOrAll (short type);
Синтаксис COM:
BOOL ZoomPrevNextOrAll (short type);
Входные параметры:

type " признак устанавливаемого 
масштаба
(0 " следующий масштаб 
изображения, 
1 " предыдущий масштаб 
изображения, 
2 " показать модель полностью).

Возвращаемое значение:

TRUE " в случае успешного 
завершения.

Примечание:
В настоящий момент метод работает только при type=2.
2985



2986



Массив компонентов сборки (Интерфейсы 
ksPartCollection и IPartCollection)
Интерфейс динамического массива компонентов сборки.

ksPartCollection " интерфейс
Automation

IPartCollection " интерфейс COM

Примечание:
Данный интерфейс можно получить от интерфейса ksDocument3D или IDocument3D.

ksPartCollection  методы

Add  Добавить компонент в массив
Интерфейс...
Синтаксис Automation:
BOOL Add (LPDISPATCH part);
Синтаксис COM:
BOOL Add (LPPART part);
Входной параметр:

part " указатель на интерфейс компонента ksPart или
IPart.

Возвращаемое значение:

TRUE " в случае успешного завершения.

AddAt  Добавить в массив компонент с заданным 
индексом
Интерфейс...
Синтаксис Automation:
BOOL AddAt (LPDISPATCH part, 
long index);
Синтаксис COM:
BOOL AddAt (LPPART part, 
unsigned long index);
Входные параметры:

part " указатель на интерфейс компонента ksPart или IPart,
2987



index " индекс в массиве.
Возвращаемое значение:

TRUE " в случае успешного завершения.

AddBefore  Добавить в массив компонент перед 
указанным компонентом
Интерфейс...
Синтаксис Automation:
BOOL AddBefore (LPDISPATCH entity, 
LPDISPATCH base);
Синтаксис COM:
BOOL AddBefore (LPPART entity, 
LPPART base);
Входные параметры:

part " указатель на интерфейс добавляемого компонента  ksPart 
илиIPart,

base " указатель на интерфейс компонента базового объекта 
ksPart или IPart.

Возвращаемое значение:

TRUE " в случае успешного завершения.

Clear  Очистить массив
Интерфейс...
Синтаксис Automation:
BOOL Clear();
Синтаксис COM:
